!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=t.apply(n,r);function c(t){e(a,o,i,c,s,"next",t)}function s(t){e(a,o,i,c,s,"throw",t)}c(void 0)}))}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s={},u={get exports(){return s},set exports(e){s=e}},l={},d={get exports(){return l},set exports(e){l=e}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(d),function(e){var t=l.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new I(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var h={};function y(){}function v(){}function m(){}var g={};d(g,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(x([])));w&&w!==o&&i.call(w,s)&&(g=w);var _=m.prototype=y.prototype=Object.create(g);function O(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,n){function r(o,a,c,s){var u=p(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==t(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,c,s)}),(function(e){r("throw",e,c,s)})):n.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return r("throw",e,c,s)}))}s(u.arg)}var o;a(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}})}function k(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=p(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return v.prototype=m,a(_,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:v,configurable:!0}),v.displayName=d(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,l,"GeneratorFunction")),e.prototype=Object.create(_),e},r.awrap=function(e){return{__await:e}},O(C.prototype),d(C.prototype,u,(function(){return this})),r.AsyncIterator=C,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new C(f(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(_),d(_,l,"Generator"),d(_,s,(function(){return this})),d(_,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=x,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),s=i.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(u);var f=s(),p=f;try{regeneratorRuntime=f}catch(e){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=f:Function("r","regeneratorRuntime = r")(f)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function v(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,c,"next",e)}function c(e){g(i,r,o,a,c,"throw",e)}a(void 0)}))}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e){return _="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},_(e)}function O(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_(t)?t:String(t)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function k(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e,t,n){return(t=O(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},P={exports:{}},I={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(I),function(e){var t=I.exports.default;function n(){e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new I(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var h={};function y(){}function v(){}function m(){}var g={};d(g,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(x([])));w&&w!==o&&i.call(w,s)&&(g=w);var _=m.prototype=y.prototype=Object.create(g);function O(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,n){function r(o,a,c,s){var u=p(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==t(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,c,s)}),(function(e){r("throw",e,c,s)})):n.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return r("throw",e,c,s)}))}s(u.arg)}var o;a(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}})}function k(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=p(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return v.prototype=m,a(_,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:v,configurable:!0}),v.displayName=d(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,l,"GeneratorFunction")),e.prototype=Object.create(_),e},r.awrap=function(e){return{__await:e}},O(C.prototype),d(C.prototype,u,(function(){return this})),r.AsyncIterator=C,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new C(f(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(_),d(_,l,"Generator"),d(_,s,(function(){return this})),d(_,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=x,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),s=i.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(P);var x,T,j,A,L=P.exports(),D=L;try{regeneratorRuntime=L}catch(Zu){"object"===("undefined"==typeof globalThis?"undefined":_(globalThis))?globalThis.regeneratorRuntime=L:Function("r","regeneratorRuntime = r")(L)}function N(e){return(N="function"==typeof Symbol&&"symbol"==_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)})(e)}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}function M(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t,n){return t&&H(e.prototype,t),n&&H(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function q(e){return q="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)},q(e)}function Y(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":q(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||R(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(e){e.P0="P0",e.P1="P1",e.P2="P2"}(x||(x={})),function(e){e.Start="Start",e.Success="Success",e.Failure="Failure"}(T||(T={})),function(e){e.Info="info",e.Log="log",e.Warn="warn",e.Error="error"}(j||(j={}));var z=new Uint8Array(16);function W(){if(!A&&!(A="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(z)}for(var K=[],X=0;X<256;++X)K.push((X+256).toString(16).slice(1));var J={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function $(e,t,n){if(J.randomUUID&&!t&&!e)return J.randomUUID();var r=(e=e||{}).random||(e.rng||W)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+"-"+K[e[t+4]]+K[e[t+5]]+"-"+K[e[t+6]]+K[e[t+7]]+"-"+K[e[t+8]]+K[e[t+9]]+"-"+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]).toLowerCase()}(r)}var Z=function(e){return function(t,n,r){var o=r.value;r.value=function(){try{for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return o.apply(this,r)}catch(t){return window[window.__sl_console__?"__sl_console__":"console"].error("logger: There is an error in the execution of method ".concat(n),t),e}}}},Q=function(e){return e.reduce((function(e,t){var n={};try{n=t()}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("There is an error in the calculation list results.",e)}return Object.assign(Object.assign({},e),n)}),{})},ee=function(e){var t=window.__SL_LOGGER__;if(t)return t[e]},te=function(e,t){window.__SL_LOGGER__||(window.__SL_LOGGER__={}),window.__SL_LOGGER__[e]=t},ne=function(e){return"string"==typeof e?e:"Request"in window&&e instanceof Request?e.url:String(e)},re=function(e){return e instanceof Request},oe=function(){var e,t=null,n={},r=arguments.length<=0?void 0:arguments[0];return e=ne(r),re(r)&&(t=r),(arguments.length<=1?void 0:arguments[1])&&(n=arguments.length<=1?void 0:arguments[1]),[e,t,n]},ie=function(){return $()},ae=["localhost",/^\/(?!\/).*$/],ce=function(){function e(){F(this,e),this.fnList=[],this.get()}return U(e,[{key:"get",value:function(){var e,t,n=sessionStorage.getItem("SL_LOGGER_SESSION_ID"),r=(e=document.cookie.split("; "),t={},e.forEach((function(e){var n=V(e.split("="),2),r=n[0],o=n[1];r&&(t[r]=o||"")})),t.log_session_id||"");if(n)return n!==r&&this.updateId(n),n;var o=$();return this.updateId(o),o}},{key:"set",value:function(e){return!!e&&(this.updateId(e),this.fnList.forEach((function(t){return t(e)})),!0)}},{key:"refresh",value:function(){var e=$();return this.updateId(e),this.fnList.forEach((function(t){return t(e)})),!0}},{key:"onChange",value:function(e){this.fnList.push(e)}},{key:"updateId",value:function(e){sessionStorage.setItem("SL_LOGGER_SESSION_ID",e),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r="".concat(e,"=").concat(t);n&&(r+="; path=".concat(n)),document.cookie=r}("log_session_id",e)}}]),e}();Y([Z("")],ce.prototype,"get",null),Y([Z(!1)],ce.prototype,"set",null),Y([Z(!1)],ce.prototype,"refresh",null),Y([Z()],ce.prototype,"onChange",null),Y([Z()],ce.prototype,"updateId",null);var se=new ce,ue=function(){function e(){F(this,e),this.fnList=[],this.get()}return U(e,[{key:"get",value:function(){var e=localStorage.getItem("SL_LOGGER_CLIENT_ID");if(e)return e;var t=$();return this.set(t),t}},{key:"set",value:function(e){return!!e&&(localStorage.setItem("SL_LOGGER_CLIENT_ID",e),this.fnList.forEach((function(t){return t(e)})),!0)}},{key:"refresh",value:function(){var e=$();return this.set(e),!0}},{key:"onChange",value:function(e){this.fnList.push(e)}}]),e}();Y([Z("")],ue.prototype,"get",null),Y([Z(!1)],ue.prototype,"set",null),Y([Z(!1)],ue.prototype,"refresh",null),Y([Z()],ue.prototype,"onChange",null);var le,de=new ue;!function(e){e.InstrumentFetch="instrumentFetch",e.InstrumentXHR="instrumentXHR"}(le||(le={}));var fe=function(){function e(t,n){F(this,e),this.idType="sessionId",this.sessionId=t,this.clientId=n,this.instrumentFetch(),this.instrumentXHR()}return U(e,[{key:"setIdType",value:function(e){this.idType=e}},{key:"getSessionId",value:function(){return"sessionId"===this.idType?this.sessionId.get():this.clientId.get()}},{key:"instrumentFetch",value:function(){if(window.fetch&&"function"==typeof window.fetch&&!0!==ee(le.InstrumentFetch)){te(le.InstrumentFetch,!0);var e=this,t=window.fetch;window.fetch=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];try{var i=V(oe.apply(void 0,r),3),a=i[0],c=i[1],s=i[2],u=e.getSessionId(),l=ie();if(e.needAddHeader(a)){var d,f=s.headers;if(c&&(f=c.headers),f)if("function"==typeof f.append)f.append("Log-Session-Id",u),f.append("X-Request-Id",l);else if(Array.isArray(f))f=[].concat(M(f),[["Log-Session-Id",u],["X-Request-Id",l]]);else{var p;f=Object.assign(Object.assign({},f),(G(p={},"Log-Session-Id",u),G(p,"X-Request-Id",l),p))}else G(d={},"Log-Session-Id",u),G(d,"X-Request-Id",l),f=d;s.headers=f}}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("instrumentFetch error",e)}return t.apply(window,r)}}}},{key:"instrumentXHR",value:function(){if(window.XMLHttpRequest&&"function"==typeof window.XMLHttpRequest&&!0!==ee(le.InstrumentXHR)){te(le.InstrumentXHR,!0);var e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];try{var o=n[1],i="string"==typeof o?o:o.toString();this.__logger_xhr_info__={url:i}}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("instrumentXHR open error",e)}return e.apply(this,n)};var t=this,n=window.XMLHttpRequest.prototype.send;window.XMLHttpRequest.prototype.send=function(){var e;try{var r=t.getSessionId(),o=ie();t.needAddHeader((null===(e=this.__logger_xhr_info__)||void 0===e?void 0:e.url)||"")&&(this.setRequestHeader("Log-Session-Id",r),this.setRequestHeader("X-Request-Id",o))}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("instrumentXHR send error",e)}for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return n.apply(this,a)}}}},{key:"needAddHeader",value:function(e){return ae.some((function(t){return t instanceof RegExp?t.test(e):"string"==typeof t&&-1!==e.indexOf(t)}))}}]),e}();new fe(se,de);var pe=function(){function e(t){F(this,e),this.options={owner:"",action:"",tags:{},getTagsFn:[],data:{},getDataFn:[],transports:[]},this.options=Object.assign(Object.assign({},this.options),t)}return U(e,[{key:"withOwner",value:function(e){return new this.constructor(Object.assign(Object.assign({},this.options),{owner:e}))}},{key:"pipeOwner",value:function(e){return e?(t=this.options.owner?"".concat(this.options.owner,".").concat(e):e,new this.constructor(Object.assign(Object.assign({},this.options),{owner:t}))):this;var t}},{key:"withAction",value:function(e){return new this.constructor(Object.assign(Object.assign({},this.options),{action:e}))}},{key:"pipeTags",value:function(e){return e?"function"==typeof e?new this.constructor(Object.assign(Object.assign({},this.options),{getTagsFn:[].concat(M(this.options.getTagsFn),[e])})):new this.constructor(Object.assign(Object.assign({},this.options),{tags:Object.assign(Object.assign({},this.options.tags),e)})):this}},{key:"pipeData",value:function(e){return e?"function"==typeof e?new this.constructor(Object.assign(Object.assign({},this.options),{getDataFn:[].concat(M(this.options.getDataFn),[e])})):new this.constructor(Object.assign(Object.assign({},this.options),{data:Object.assign(Object.assign({},this.options.data),e)})):this}},{key:"pipeTransport",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.options.transports.concat(t);return new this.constructor(Object.assign(Object.assign({},this.options),{transports:r}))}},{key:"report",value:function(e,t,n){var r=function(e){var t,n=e.level,r=e.message,o=e.context,i=e.options,a=Q(i.getTagsFn),c=Q(i.getDataFn),s=Object.assign(Object.assign({level:n,owner:i.owner,action:i.action},o),{tags:Object.assign(Object.assign({},i.tags),a),data:Object.assign(Object.assign({},i.data),c),message:r});return(null==o?void 0:o.data)&&(t=o.data,"[object Object]"===Object.prototype.toString.call(t))?s.data=Object.assign(Object.assign({},s.data),o.data):void 0!==(null==o?void 0:o.data)&&(s.data=Object.assign(Object.assign({},s.data),{custom_data:o.data})),o&&"tags"in o&&o.tags&&(s.tags=Object.assign(Object.assign({},s.tags),o.tags)),o&&"errorLevel"in o&&o.errorLevel&&(s.tags=Object.assign(Object.assign({},s.tags),{errorLevel:o.errorLevel})),s}({level:e,message:t,context:n,options:this.options});!function(e,t){var n=e;t.forEach((function(e){var t=e(n);t&&(n=t)}))}(r,this.options.transports)}},{key:"info",value:function(e,t){this.report(j.Info,e,t)}},{key:"log",value:function(e,t){this.report(j.Log,e,t)}},{key:"warn",value:function(e,t){this.report(j.Warn,e,t)}},{key:"error",value:function(e,t){this.report(j.Error,e,t)}}]),e}();Y([Z(new pe)],pe.prototype,"withOwner",null),Y([Z(new pe)],pe.prototype,"pipeOwner",null),Y([Z(new pe)],pe.prototype,"withAction",null),Y([Z(new pe)],pe.prototype,"pipeTags",null),Y([Z(new pe)],pe.prototype,"pipeData",null),Y([Z(new pe)],pe.prototype,"pipeTransport",null),Y([Z(new pe)],pe.prototype,"info",null),Y([Z(new pe)],pe.prototype,"log",null),Y([Z(new pe)],pe.prototype,"warn",null),Y([Z(new pe)],pe.prototype,"error",null);var he=new pe;Object.defineProperty(he,"options",{writable:!1,configurable:!1});var ye=new pe,ve={get:function(){return ye},set:function(e){e&&(ye=e)}};function me(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function ge(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){me(i,r,o,a,c,"next",e)}function c(e){me(i,r,o,a,c,"throw",e)}a(void 0)}))}}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function we(e){var t=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===N(t)?t:String(t)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,we(r.key),r)}}function Oe(e,t,n){return t&&_e(e.prototype,t),n&&_e(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e,t){return ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ke(e,t)}function Se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}function Ee(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ce(e)}function Pe(e){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pe(e)}function Ie(e,t,n){return(t=we(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Te={exports:{}},je={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(je),function(e){var t=je.exports.default;function n(){e.exports=n=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var r={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),c=new I(r||[]);return a(i,"_invoke",{value:k(e,n,c)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var h={};function y(){}function v(){}function m(){}var g={};d(g,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(x([])));w&&w!==o&&i.call(w,s)&&(g=w);var _=m.prototype=y.prototype=Object.create(g);function O(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,n){function r(o,a,c,s){var u=p(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==t(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,c,s)}),(function(e){r("throw",e,c,s)})):n.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return r("throw",e,c,s)}))}s(u.arg)}var o;a(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(i,i):i()}})}function k(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=p(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return v.prototype=m,a(_,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:v,configurable:!0}),v.displayName=d(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,l,"GeneratorFunction")),e.prototype=Object.create(_),e},r.awrap=function(e){return{__await:e}},O(C.prototype),d(C.prototype,u,(function(){return this})),r.AsyncIterator=C,r.async=function(e,t,n,o,i){void 0===i&&(i=Promise);var a=new C(f(e,t,n,o),i);return r.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(_),d(_,l,"Generator"),d(_,s,(function(){return this})),d(_,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=x,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),s=i.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},r}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(Te);var Ae=Te.exports(),Le=Ae;try{regeneratorRuntime=Ae}catch(Nu){"object"===("undefined"==typeof globalThis?"undefined":N(globalThis))?globalThis.regeneratorRuntime=Ae:Function("r","regeneratorRuntime = r")(Ae)}var De={exports:{}};De.exports=function(){var e=function(){},t={},n={},r={};function o(e,t){if(e){var o=r[e];if(n[e]=t,o)for(;o.length;)o[0](e,t),o.splice(0,1)}}function i(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function a(t,n,r,o){var i,c,s=document,u=r.async,l=(r.numRetries||0)+1,d=r.before||e,f=t.replace(/[\?|#].*$/,""),p=t.replace(/^(css|img)!/,"");o=o||0,/(^css!|\.css$)/.test(f)?((c=s.createElement("link")).rel="stylesheet",c.href=p,(i="hideFocus"in c)&&c.relList&&(i=0,c.rel="preload",c.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(f)?(c=s.createElement("img")).src=p:((c=s.createElement("script")).src=t,c.async=void 0===u||u),c.onload=c.onerror=c.onbeforeload=function(e){var s=e.type[0];if(i)try{c.sheet.cssText.length||(s="e")}catch(e){18!=e.code&&(s="e")}if("e"==s){if((o+=1)<l)return a(t,n,r,o)}else if("preload"==c.rel&&"style"==c.as)return c.rel="stylesheet";n(t,s,e.defaultPrevented)},!1!==d(t,c)&&s.head.appendChild(c)}function c(e,t,n){var r,o,i=(e=e.push?e:[e]).length,c=i,s=[];for(r=function(e,n,r){if("e"==n&&s.push(e),"b"==n){if(!r)return;s.push(e)}--i||t(s)},o=0;o<c;o++)a(e[o],r,n)}function s(e,n,r){var a,s;if(n&&n.trim&&(a=n),s=(a?r:n)||{},a){if(a in t)throw"LoadJS";t[a]=!0}function u(t,n){c(e,(function(e){i(s,e),t&&i({success:t,error:n},e),o(a,e)}),s)}if(s.returnPromise)return new Promise(u);u()}return s.ready=function(e,t){return function(e,t){e=e.push?e:[e];var o,i,a,c=[],s=e.length,u=s;for(o=function(e,n){n.length&&c.push(e),--u||t(c)};s--;)i=e[s],(a=n[i])?o(i,a):(r[i]=r[i]||[]).push(o)}(e,(function(e){i(t,e)})),s},s.done=function(e){o(e,[])},s.reset=function(){t={},n={},r={}},s.isDefined=function(e){return e in t},s}();var Ne,Be,Re,Me,Fe,He,Ue,qe,Ye,Ge,Ve,ze,We,Ke,Xe,Je,$e,Ze=De.exports;!function(e){e.Init="init",e.PullUpChannel="pullUpChannel",e.CreateOrder="createOrder",e.Pay="pay",e.Hooks="Hooks",e.CreateExpected="createExpected",e.ReRender="rerender"}(Ne||(Ne={})),function(e){e.Continue="continue",e.PayNow="pay_now",e.All="all"}(Be||(Be={})),function(e){e.AdyenExpress="AdyenExpress",e.Paypal="Paypal",e.SLpayments="SLpayments",e.StripeOther="StripeOther",e.Tyro="TyroWindows",e.CybsOther="CybsOther"}(Re||(Re={})),function(e){e.Paypal="Paypal",e.GooglePay="GooglePay",e.ApplePay="ApplePay"}(Me||(Me={})),(Fe||(Fe={})).StandardEC="standard_ec",(He||(He={})).Prod="prod",function(e){e.Done="done",e.Pending="pending",e.Await="await",e.Fail="fail"}(Ue||(Ue={})),function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(qe||(qe={})),function(e){e.Ordinary="ordinary",e.ChangeAddress="change_address",e.ChangeDeliveryMethod="change_delivery_method",e.UseDiscountCode="use_discount_code"}(Ye||(Ye={})),(Ge||(Ge={})).PAYMENT_OPEN="PAYMENT_OPEN",function(e){e.NetworkUnstable="networkUnstable",e.RateLimited="rateLimited",e.Other="other"}(Ve||(Ve={})),function(e){e.Init="init",e.RedirectOrPopup="RedirectOrPopup",e.Redirect="Redirect",e.ChannelInfoUpdate="ChannelInfoUpdate",e.ChannelConfirm="ChannelConfirm",e.OpenIframe="OpenIframe",e.Confirm="Confirm",e.Challenge="Challenge",e.Gather="Gather"}(ze||(ze={})),function(e){e.GET="GET",e.POST="POST"}(We||(We={})),function(e){e.PAY_AND_BIND="PAY_AND_BIND",e.PAY_NORMAL="PAY_NORMAL"}(Ke||(Ke={})),function(e){e.Hidden="Hidden",e.Visible="Visible"}(Xe||(Xe={})),function(e){e.Form="Form",e.Direct="Direct",e.Both="Both"}(Je||(Je={})),function(e){e.Confirm="Confirm",e.Init="Init",e.I18n="I18n",e.SaveAbandonOrder="SaveAbandonOrder",e.ExpressFirstLoad="ExpressFirstLoad",e.ExpressUpdateDetail="ExpressUpdateDetail"}($e||($e={}));var Qe="paypal",et="rememberedCb",tt={props:{payMode:Be.Continue,buttonTimeoutConfig:{enable:!1,timeoutMillis:5e3},styleOptions:{layout:"horizontal",color:"gold",shape:"rect",label:"paypal",tagline:!1,height:55},timing:!1,currency:"USD"}};function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ot,it=function(){function e(t){var n;be(this,e),Ie(this,"initialData",void 0),Ie(this,"paypalInstanceName",void 0),this.initialData=t,this.paypalInstanceName=(null==t||null===(n=t.scriptParams)||void 0===n?void 0:n["data-namespace"])||Qe,window.__PAYPALSPB_LOADJS||(window.__PAYPALSPB_LOADJS=Ze,window.__PAYPALSPB_LOADJS.ids={})}var t;return Oe(e,[{key:"render",value:(t=ge(Le.mark((function e(){var t,n,r,o,i,a,c,s=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://www.paypal.com/sdk/js",null!==(t=this.initialData)&&void 0!==t&&t.queryParams&&(r+="".concat(this.initialData.queryParams)),o=r,i={},null!==(n=this.initialData)&&void 0!==n&&n.scriptParams&&(c=(null===(a=this.initialData)||void 0===a?void 0:a.scriptParams)||{},i.before=function(e,t){Object.keys(c).forEach((function(e){var n=c[e];n&&t.setAttribute(e,n)}))},null!=c&&c["data-namespace"]&&(this.paypalInstanceName=c["data-namespace"]),Object.keys(c).forEach((function(e){var t=c[e];o+="".concat(e,"&").concat(t)}))),window.__PAYPALSPB_LOADJS.ids[o]||(window.__PAYPALSPB_LOADJS.ids[o]=window.__PAYPALSPB_LOADJS([r],rt(rt({},i),{},{returnPromise:!0}))),e.abrupt("return",window.__PAYPALSPB_LOADJS.ids[o].then((function(){s.initPaypal()})).catch((function(e){throw window.__PAYPALSPB_LOADJS.ids[o]=!1,e})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),at=function(e){Se(n,it);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(e){return be(this,n),t.call(this,e)}return Oe(n,[{key:"initPaypal",value:function(){var e,t=null===(e=this.initialData.style)||void 0===e?void 0:e["border-radius"],n=rt({},this.initialData);n.style||(n.style={}),n.style.shape=t>=10?"pill":"rect";var r=document.querySelector("#".concat(this.initialData.domId," .").concat("paypal-buttons"));r&&r.remove(),window[this.paypalInstanceName].Buttons(this.initialData).render("#".concat(this.initialData.domId))}}]),n}(),ct=function(){function e(){be(this,e),Ie(this,"handlers",[])}return Oe(e,[{key:"use",value:function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){this.handlers.forEach((function(t){null!==t&&e(t)}))}}]),e}();function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lt={maxCount:3,interval:1e3},dt={};function ft(e,t){if(!e)return null;var n=dt[e]||{};return n=ut(ut(ut(ut({},n),lt),t),{},{retryCount:n.retryCount||0}),dt[e]=n,n}var pt=function(e){return e.useRetry&&e.action},ht=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"xhr";return JSON.parse(JSON.stringify(e,(function(e,n){if(e!==t)return n})))};function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mt=function(){function e(t){be(this,e),Ie(this,"options",{}),Ie(this,"interceptors",{}),Ie(this,"getLogData",(function(e){return{readyState:e.readyState,status:e.status,statusText:e.statusText,timeout:e.timeout,withCredentials:e.withCredentials}})),Ie(this,"serialize",(function(e){var t=Object.prototype.toString.call(e);return e&&"[object Object]"===t?Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&"):""})),this.options=t||{},this.interceptors={request:new ct,response:new ct}}return Oe(e,[{key:"logger",get:function(){return ve.get().pipeOwner("payment-common.request")}},{key:"setOptions",value:function(e){this.options=e}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=this.buildUrl(e,null==t?void 0:t.params),this.http(e,vt(vt(vt({method:"GET"},this.options),t),{},{headers:vt(vt({},{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}),t.headers)}))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={Accept:"application/json"},o=t||n.data||null;return"form"===n.requestType?(r["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",o=this.serialize(o)):(r["Content-Type"]="application/json;charset=UTF-8",o=o?JSON.stringify(o):null),this.http(e,vt(vt(vt({method:"POST",body:o},this.options),n),{},{headers:vt(vt({},r),n.headers)}))}},{key:"dispatchRequest",value:function(e,t){var n=this;return new Promise((function(r,o){var i=new window.XMLHttpRequest,a=!1,c=t.body,s=n.options.baseUrl&&!/^(https?:)?(\/\/)/.test(e)?"".concat(n.options.baseUrl).concat(e):e;i.open(t.method||"",s),t.headers&&Object.keys(t.headers).forEach((function(e){var n;i.setRequestHeader(e,(null===(n=t.headers)||void 0===n?void 0:n[e])||"")}));var u={options:t,url:s};if(i.onreadystatechange=function(){if(4===i.readyState){u.statusCode=i.status;var e="";try{e=JSON.parse(i.responseText)}catch(t){e=i.responseText}if(/^(2|3)\d{2}$/.test(i.status.toString())){try{r(vt({data:e},u))}catch(t){r(vt({data:e},u))}return}o(vt({data:e},u))}},i.send(c),i.onabort=function(t){a=!0,n.logger.error("xhr_onabort",{data:vt(vt({},n.getLogData(i)),{},{url:e})}),u.statusCode=i.status,t=ht(t),o(vt({error:t},u))},i.onerror=function(t){n.logger.error("xhr_onerror",{data:vt(vt({},n.getLogData(i)),{},{url:e})}),u.statusCode=i.status,t=ht(t),o(vt({error:t},u))},i.ontimeout=function(){n.logger.error("xhr_ontimeout",{data:vt(vt({},n.getLogData(i)),{},{url:e,withCredentials:i.withCredentials})})},t.timeout){if(a)return;setTimeout((function(){i.abort();var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",n.logger.error("xhr_timeout",{data:{url:e}}),u.statusCode=i.status,o(vt({error:t},u))}),t.timeout)}}))}},{key:"http",value:function(e,t){var n,r,o,i,a=[];null===(n=this.interceptors)||void 0===n||null===(r=n.request)||void 0===r||r.forEach((function(e){a.unshift(e.fulfilled,e.rejected)}));var c,s=[];null===(o=this.interceptors)||void 0===o||null===(i=o.response)||void 0===i||i.forEach((function(e){s.push(e.fulfilled,e.rejected)}));for(var u=t;a.length;){var l=a.shift(),d=a.shift();try{l&&(u=l(u))}catch(e){d&&d(e);break}}try{c=this.dispatchRequest(e,u)}catch(e){return Promise.reject(e)}for(;s.length;){var f=s.shift(),p=s.shift();c=c.then(f,p)}return c}},{key:"buildUrl",value:function(e,t){var n=Object.prototype.toString.call(t);if(!t||"[object Object]"!==n)return e;var r=Object.keys(t);return(e=decodeURIComponent(e).indexOf("?")>-1?"".concat(e,"&"):"".concat(e,"?"))+r.map((function(e){return"".concat(e,"=").concat(t[e])})).join("&")}}]),e}(),gt=new mt;function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}!function(e){var t,n,r,o;null==e||null===(t=e.interceptors)||void 0===t||null===(n=t.request)||void 0===n||n.use((function(e){ot||(ot=ve.get().pipeOwner("payment-common.retry"));var t=ft(e.action);return pt(e)&&t?(t.lastRequestTime=Date.now(),e):e})),null==e||null===(r=e.interceptors)||void 0===r||null===(o=r.response)||void 0===o||o.use(null,(function(t){var n=t.options,r=t.url;if(!n)return Promise.reject(t);var o=ft(n.action,n.retryOptions);if(!pt(n)||!o)return Promise.reject(t);var i=function(e,t,n){if(!e)return!1;if(!function(e,t){switch(e){case $e.Init:case $e.SaveAbandonOrder:case $e.ExpressFirstLoad:case $e.ExpressUpdateDetail:return function(e){return!!e&&400!==e.statusCode}(t);case $e.I18n:return!0;default:return!1}}(e,n))return!1;var r,o,i=t.retryCount<(null==t?void 0:t.maxCount),a=n.statusCode,c={action:e,statusCode:a,url:n.url};return i?null===(r=ot)||void 0===r||r.log("start_retry",{data:ut(ut({},c),{},{retryCount:t.retryCount})}):(null===(o=ot)||void 0===o||o.error("retry_max_times",{data:c,errorLevel:0===a?x.P2:x.P1}),t.retryCount=0),i}(n.action,o,t);if(i){if(o.retryCount+=1,n.timeout&&o.lastRequestTime){var a=Date.now()-o.lastRequestTime;n.timeout=Math.max(n.timeout-a-o.interval,1)}return new Promise((function(t){return setTimeout((function(){t(e.http(r,n))}),o.interval)}))}return Promise.reject(t)}))}(gt);var wt=function(e){return gt.post("/leproxy/api/trade/center/pay/fast-checkout/prepare-pay",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))};function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_t(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ct=function(e){return"function"==typeof e};function kt(e){return"[object Object]"===Object.prototype.toString.call(e)}function St(e){return!e||e.nodeType||"object"!==N(e)?e:JSON.parse(JSON.stringify(e))}function Et(e,t){if(function(e){return function(e){return void 0===e}(e)||function(e){return null===e}(e)}(t))return St(e);if(!kt(t)||!kt(e))return St(t);var n={};return Object.keys(e).map((function(r){n[r]=Et(e[r],t[r])})),Object.keys(t).map((function(e){n[e]||(n[e]=St(t[e]))})),n}var Pt=window.performance&&"function"==typeof window.performance.now?window.performance:Date,It=function e(t){t instanceof Array?t.forEach((function(t){return e(t)})):"object"===N(t)&&null!==t&&Object.entries(t).forEach((function(n){var r=Ot(n,2),o=r[0],i=r[1];null===i?delete t[o]:i instanceof Array?i.forEach((function(t){return e(t)})):"object"===N(i)&&e(i)}))},xt=function(){var e=ge(Le.mark((function e(t){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{retries:5,interval:1e3},n=function(){var r=ge(Le.mark((function r(){var o,i=arguments;return Le.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.apply(void 0,i);case 3:return o=r.sent,r.abrupt("return",o);case 7:if(r.prev=7,r.t0=r.catch(0),0!==t.retries){r.next=11;break}throw r.t0;case 11:return t.retries--,r.next=14,xt(t.interval);case 14:return r.abrupt("return",n.apply(void 0,i));case 15:case"end":return r.stop()}}),r,null,[[0,7]])})));return function(){return r.apply(this,arguments)}}();return n},jt=ve.get();function At(e){var t=e.prototype,n={validate:t.validate,handleError:t.handleError,handleDynamicNotify:t.handleDynamicNotify,dynamicJsonpCallback:t.dynamicJsonpCallback,handleDynamic:t.handleDynamic,handleRenderTimeout:t.handleRenderTimeout,beforeInit:t.beforeInit,beforeCreateOrder:t.beforeCreateOrder,afterCreateOrder:t.afterCreateOrder,removeSkeleton:t.removeSkeleton};Object.keys(n).forEach((function(t){e.prototype[t]=function(e){return ge(Le.mark((function t(){var r,o,i,a,c=arguments;return Le.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r="".concat(e,""),t.prev=1,jt.info("".concat(r,"[execution started]")),o=c.length,i=new Array(o),a=0;a<o;a++)i[a]=c[a];return t.abrupt("return",n[e].apply(this,i));case 7:throw t.prev=7,t.t0=t.catch(1),jt.error("".concat(r,"[execution failed]"),{error:t.t0}),t.t0;case 11:case"end":return t.stop()}}),t,this,[[1,7]])})))}(t)}))}var Lt,Dt="smart-payment-hide",Nt="smart-payment-button-disabled",Bt="smart-payment-button-loading",Rt="express_common_style_id",Mt=Oe((function e(t){var n=this;be(this,e),Ie(this,"config",void 0),Ie(this,"isVisible",!0),Ie(this,"showButton",(function(){var e=document.getElementById(n.config.paymentInfo.currentDomId);null==e||e.classList.remove(Dt),n.isVisible=!0})),Ie(this,"hideButton",(function(){var e=document.getElementById(n.config.paymentInfo.currentDomId);null==e||e.classList.add(Dt),n.isVisible=!1})),this.config=t})),Ft=function(e,t){var n=Object.entries(t).filter((function(e){var t=Ot(e,2),n=t[0],r=t[1];return n&&null!=r&&""!==r})).map((function(e){var t=Ot(e,2),n=t[0],r=t[1];return"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(String(r)))}));if(!n.length)return e;var r=-1===e.search(/\?/)?"?":"&";return e+r+n.join("&")},Ht=function(e){return/^https:\/\/([^.]+)?\.myshopline([^.]+)?\.com$/.test(e)},Ut=function(e){return new URL(e).origin},qt=function(){function e(t,n){var r=this;be(this,e),Ie(this,"type",void 0),Ie(this,"domId",void 0),Ie(this,"payOptions",void 0),Ie(this,"timer",null),Ie(this,"resolveFn",void 0),Ie(this,"rejectFn",void 0),Ie(this,"logger",ve.get().pipeOwner("payment-common.3DS")),Ie(this,"handlePostmessage",(function(e){var t=e.data,n=e.origin;if(!1!==Ht(n)){r.logger.log("3DS_handlePostmessage",{data:{data:t,origin:n,domId:r.domId}});var o=t.success,i=t.nextAction||{},a=t.nextAction||{},c=a.url,s=a.type;if(o){if(s===ze.Redirect&&c){if(window.removeEventListener("message",r.handlePostmessage,!1),r.domId){var u=document.getElementById(r.domId);u&&u.parentElement&&u.parentElement.removeChild(u)}return vn(i),void(r.resolveFn&&r.resolveFn())}if(s===ze.OpenIframe)return r.openIframe(t.nextAction),void(r.resolveFn&&r.resolveFn());r.logger.error("do not match nextAction type",{data:{nextAction:i},error:new Error("")}),r.rejectFn&&r.rejectFn(new Error("do not match nextAction type"))}}})),this.type=t,this.payOptions=n}return Oe(e,[{key:"handleIframe",value:function(e){var t,n=e.type,r=e.iframeType,o=e.url,i=void 0===o?"":o,a=e.size,c="".concat(n,"Iframe-").concat(Date.now());return this.domId=c,r===Xe.Hidden?t=function(e,t){var n=document.createElement("iframe");return n.src=e,n.name=t,n.style.width="1px",n.style.height="1px",n.style.display="none",n.style.border="none",document.body.appendChild(n),n}(i,c):r===Xe.Visible&&(t=function(e,t,n){var r,o,i=document.createElement("iframe");i.src=e,i.name=t,i.style.width=(null==n||null===(r=n.size)||void 0===r?void 0:r.width)||"100%",i.style.height=(null==n||null===(o=n.size)||void 0===o?void 0:o.height)||"100%",i.style.display="block",i.style.border="none",i.style.zIndex="1000",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.bottom="0",i.style.right="0",i.style.margin="auto",i.style.background="#fff";var a=document.createElement("div");return a.style.position="fixed",a.style.zIndex="999",a.style.width="100%",a.style.height="100%",a.style.top="0",a.style.left="0",a.style.background="rgba(0, 0, 0, 0.5)",document.body.appendChild(a),document.body.appendChild(i),i}(i,c,{size:a})),t}},{key:"handleForm",value:function(e){var t=this,n=e.urlAccessType,r=e.url,o=e.method,i=e.channelData,a=e.iframeName,c=e.formField;return(n===Je.Form||n===Je.Both&&o===We.POST)&&function(){var e=function(e){var t=e.action,n=e.method,r=void 0===n?"POST":n,o=e.channelData,i=e.formField,a=e.iframeName,c=document.createElement("form");for(var s in c.action=t,c.method=r,a&&(c.target=a),o){var u=document.createElement("input");u.name=s,u.value=o[s],u.type="hidden",c.appendChild(u)}return i&&i.forEach((function(e){var t=document.createElement(e.element);Object.keys(e.attribute).forEach((function(n){var r=e.attribute[n];r&&t.setAttribute(n,r)})),c.appendChild(t)})),document.body.appendChild(c),c}({action:r,method:o,channelData:i,iframeName:a,formField:c});t.logger.log("3DS_handleForm_about_to_trigger_form_submission"),e.submit()}(),new Promise((function(e){e()}))}},{key:"gather",value:function(e){var t=this;return new Promise((function(n,r){t.resolveFn=n,t.rejectFn=r,t.logger.log("3DS_gather_start",{data:{nextAction:e}});var o=e.data,i=e.method,a=void 0===i?We.GET:i,c=e.url,s=e.type,u=JSON.parse((null==o?void 0:o.additionalData)||"")[s]||{},l=u.urlAccessType,d=u.iframeType,f=u.formField,p=u.closePolling,h=void 0!==p&&p,y=u.listenMessageFromChannel,v=void 0!==y&&y,m=u.channelMessageTimeout,g=t.handleIframe({type:s,iframeType:d,url:c,method:a}),b=null==g?void 0:g.getAttribute("name");if(!h){var w=e.nextAction;!0===v&&w?t.gatherFromChannel(w,{timeout:m,origin:Ut(c)}):(window.removeEventListener("message",t.handlePostmessage,!1),window.addEventListener("message",t.handlePostmessage,!1))}t.handleForm({urlAccessType:l,url:c,method:a,channelData:null==o?void 0:o.channelData,iframeName:b,formField:f})}))}},{key:"gatherFromChannel",value:function(e,t){var n=this,r=function(){var r=ge(Le.mark((function r(o){var i,a;return Le.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=o.data,(a=o.origin)===t.origin){r.next=3;break}return r.abrupt("return");case 3:if(n.logger.log("3DS_handleChannelMessage",{data:{data:i,origin:a}}),n.timer&&(clearTimeout(n.timer),n.timer=null),!n.resolveFn){r.next=9;break}return r.next=8,kn(e,{channelInfoData:i});case 8:n.resolveFn();case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();t.timeout>0&&(this.timer=window.setTimeout(ge(Le.mark((function t(){return Le.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.removeEventListener("message",r,!1),!n.resolveFn){t.next=5;break}return t.next=4,kn(e,{channelInfoData:{}});case 4:n.resolveFn();case 5:case"end":return t.stop()}}),t)}))),t.timeout)),window.removeEventListener("message",r,!1),window.addEventListener("message",r,!1)}},{key:"challenge",value:function(e){var t=this;return new Promise((function(n,r){t.resolveFn=n,t.rejectFn=r,t.logger.log("3DS_challenge_start",{data:{nextAction:e}});var o=e.data,i=e.method,a=void 0===i?We.GET:i,c=e.url,s=e.type,u=JSON.parse((null==o?void 0:o.additionalData)||"")[s]||{},l=u.urlAccessType,d=u.iframeType,f=u.formField,p=u.closePolling,h=void 0!==p&&p,y=t.handleIframe({type:s,iframeType:d,url:c,method:a,size:null==o?void 0:o.size}),v=null==y?void 0:y.getAttribute("name");h||(window.removeEventListener("message",t.handlePostmessage,!1),window.addEventListener("message",t.handlePostmessage,!1)),t.handleForm({urlAccessType:l,url:c,method:a,channelData:null==o?void 0:o.channelData,iframeName:v,formField:f})}))}},{key:"openIframe",value:function(e){var t;this.logger.log("3DS_openIframe_start",{data:{nextAction:e,domId:this.domId}});var n=e.url,r=e.type,o=e.header,i=null!=o&&null!==(t=o.openIframeOptions)&&void 0!==t&&t.hidden?Xe.Hidden:Xe.Visible;this.handleIframe({type:r,iframeType:i,url:n}),window.removeEventListener("message",this.handlePostmessage,!1),window.addEventListener("message",this.handlePostmessage,!1)}}]),e}(),Yt={exports:{}},Gt={exports:{}},Vt=function(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}(Object.freeze({__proto__:null,default:{}}));Gt.exports=(Lt=Lt||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==xe&&xe.crypto&&(n=xe.crypto),!n)try{n=Vt}catch(e){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},a=i.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(var c=0;c<o;c+=4)t[r+c>>>2]=n[c>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new s.init(t,e)}}),u=i.enc={},l=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},d=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},p=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,i=r.sigBytes,a=this.blockSize,c=i/(4*a),u=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*a,l=e.min(4*u,i);if(u){for(var d=0;d<u;d+=a)this._doProcessBlock(o,d);n=o.splice(0,u),r.sigBytes-=l}return new s.init(n,l)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});a.Hasher=p.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=i.algo={};return i}(Math),Lt),function(e){(function(){var t=e,n=t.lib.WordArray;function r(e,t,r){for(var o=[],i=0,a=0;a<t;a++)if(a%4){var c=r[e.charCodeAt(a-1)]<<a%4*2|r[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=c<<24-i%4*8,i++}return n.create(o,i)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,c=0;c<4&&i+.75*c<n;c++)o.push(r.charAt(a>>>6*(3-c)&63));var s=r.charAt(64);if(s)for(;o.length%4;)o.push(s);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(t=c)}return r(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),e.enc.Base64}(Gt.exports),function(e){(function(t){var n=e,r=n.lib,o=r.WordArray,i=r.Hasher,a=n.algo,c=[];!function(){for(var e=0;e<64;e++)c[e]=4294967296*t.abs(t.sin(e+1))|0}();var s=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],s=e[t+1],p=e[t+2],h=e[t+3],y=e[t+4],v=e[t+5],m=e[t+6],g=e[t+7],b=e[t+8],w=e[t+9],_=e[t+10],O=e[t+11],C=e[t+12],k=e[t+13],S=e[t+14],E=e[t+15],P=i[0],I=i[1],x=i[2],T=i[3];P=u(P,I,x,T,a,7,c[0]),T=u(T,P,I,x,s,12,c[1]),x=u(x,T,P,I,p,17,c[2]),I=u(I,x,T,P,h,22,c[3]),P=u(P,I,x,T,y,7,c[4]),T=u(T,P,I,x,v,12,c[5]),x=u(x,T,P,I,m,17,c[6]),I=u(I,x,T,P,g,22,c[7]),P=u(P,I,x,T,b,7,c[8]),T=u(T,P,I,x,w,12,c[9]),x=u(x,T,P,I,_,17,c[10]),I=u(I,x,T,P,O,22,c[11]),P=u(P,I,x,T,C,7,c[12]),T=u(T,P,I,x,k,12,c[13]),x=u(x,T,P,I,S,17,c[14]),P=l(P,I=u(I,x,T,P,E,22,c[15]),x,T,s,5,c[16]),T=l(T,P,I,x,m,9,c[17]),x=l(x,T,P,I,O,14,c[18]),I=l(I,x,T,P,a,20,c[19]),P=l(P,I,x,T,v,5,c[20]),T=l(T,P,I,x,_,9,c[21]),x=l(x,T,P,I,E,14,c[22]),I=l(I,x,T,P,y,20,c[23]),P=l(P,I,x,T,w,5,c[24]),T=l(T,P,I,x,S,9,c[25]),x=l(x,T,P,I,h,14,c[26]),I=l(I,x,T,P,b,20,c[27]),P=l(P,I,x,T,k,5,c[28]),T=l(T,P,I,x,p,9,c[29]),x=l(x,T,P,I,g,14,c[30]),P=d(P,I=l(I,x,T,P,C,20,c[31]),x,T,v,4,c[32]),T=d(T,P,I,x,b,11,c[33]),x=d(x,T,P,I,O,16,c[34]),I=d(I,x,T,P,S,23,c[35]),P=d(P,I,x,T,s,4,c[36]),T=d(T,P,I,x,y,11,c[37]),x=d(x,T,P,I,g,16,c[38]),I=d(I,x,T,P,_,23,c[39]),P=d(P,I,x,T,k,4,c[40]),T=d(T,P,I,x,a,11,c[41]),x=d(x,T,P,I,h,16,c[42]),I=d(I,x,T,P,m,23,c[43]),P=d(P,I,x,T,w,4,c[44]),T=d(T,P,I,x,C,11,c[45]),x=d(x,T,P,I,E,16,c[46]),P=f(P,I=d(I,x,T,P,p,23,c[47]),x,T,a,6,c[48]),T=f(T,P,I,x,g,10,c[49]),x=f(x,T,P,I,S,15,c[50]),I=f(I,x,T,P,v,21,c[51]),P=f(P,I,x,T,C,6,c[52]),T=f(T,P,I,x,h,10,c[53]),x=f(x,T,P,I,_,15,c[54]),I=f(I,x,T,P,s,21,c[55]),P=f(P,I,x,T,b,6,c[56]),T=f(T,P,I,x,E,10,c[57]),x=f(x,T,P,I,m,15,c[58]),I=f(I,x,T,P,k,21,c[59]),P=f(P,I,x,T,y,6,c[60]),T=f(T,P,I,x,O,10,c[61]),x=f(x,T,P,I,p,15,c[62]),I=f(I,x,T,P,w,21,c[63]),i[0]=i[0]+P|0,i[1]=i[1]+I|0,i[2]=i[2]+x|0,i[3]=i[3]+T|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;n[o>>>5]|=128<<24-o%32;var i=t.floor(r/4294967296),a=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(n.length+1),this._process();for(var c=this._hash,s=c.words,u=0;u<4;u++){var l=s[u];s[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return c},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,r,o,i,a){var c=e+(t&n|~t&r)+o+a;return(c<<i|c>>>32-i)+t}function l(e,t,n,r,o,i,a){var c=e+(t&r|n&~r)+o+a;return(c<<i|c>>>32-i)+t}function d(e,t,n,r,o,i,a){var c=e+(t^n^r)+o+a;return(c<<i|c>>>32-i)+t}function f(e,t,n,r,o,i,a){var c=e+(n^(t|~r))+o+a;return(c<<i|c>>>32-i)+t}n.MD5=i._createHelper(s),n.HmacMD5=i._createHmacHelper(s)})(Math),e.MD5}(Gt.exports),function(e){(function(){var t=e,n=t.lib,r=n.WordArray,o=n.Hasher,i=t.algo,a=[],c=i.SHA1=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],c=n[3],s=n[4],u=0;u<80;u++){if(u<16)a[u]=0|e[t+u];else{var l=a[u-3]^a[u-8]^a[u-14]^a[u-16];a[u]=l<<1|l>>>31}var d=(r<<5|r>>>27)+s+a[u];d+=u<20?1518500249+(o&i|~o&c):u<40?1859775393+(o^i^c):u<60?(o&i|o&c|i&c)-1894007588:(o^i^c)-899497514,s=c,c=i,i=o<<30|o>>>2,o=r,r=d}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+c|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=o._createHelper(c),t.HmacSHA1=o._createHmacHelper(c)})(),e.SHA1}(Gt.exports),function(e){!function(){var t=e,n=t.lib.Base,r=t.enc.Utf8;t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,o=4*n;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),c=i.words,s=a.words,u=0;u<n;u++)c[u]^=1549556828,s[u]^=909522486;i.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}()}(Gt.exports),function(e){(function(){var t=e,n=t.lib,r=n.Base,o=n.WordArray,i=t.algo,a=i.MD5,c=i.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,i=r.hasher.create(),a=o.create(),c=a.words,s=r.keySize,u=r.iterations;c.length<s;){n&&i.update(n),n=i.update(e).finalize(t),i.reset();for(var l=1;l<u;l++)n=i.finalize(n),i.reset();a.concat(n)}return a.sigBytes=4*s,a}});t.EvpKDF=function(e,t,n){return c.create(n).compute(e,t)}})(),e.EvpKDF}(Gt.exports),function(e){e.lib.Cipher||function(t){var n=e,r=n.lib,o=r.Base,i=r.WordArray,a=r.BufferedBlockAlgorithm,c=n.enc;c.Utf8;var s=c.Base64,u=n.algo.EvpKDF,l=r.Cipher=a.extend({cfg:o.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?b:m}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()});r.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=n.mode={},f=r.BlockCipherMode=o.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),p=d.CBC=function(){var e=f.extend();function n(e,n,r){var o,i=this._iv;i?(o=i,this._iv=t):o=this._prevBlock;for(var a=0;a<r;a++)e[n+a]^=o[a]}return e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize;n.call(this,e,t,o),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+o)}}),e.Decryptor=e.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize,i=e.slice(t,t+o);r.decryptBlock(e,t),n.call(this,e,t,o),this._prevBlock=i}}),e}(),h=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,a=[],c=0;c<r;c+=4)a.push(o);var s=i.create(a,r);e.concat(s)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};r.BlockCipher=l.extend({cfg:l.cfg.extend({mode:p,padding:h}),reset:function(){var e;l.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var y=r.CipherParams=o.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?i.create([1398893684,1701076831]).concat(n).concat(t):t).toString(s)},parse:function(e){var t,n=s.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=i.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),y.create({ciphertext:n,salt:t})}},m=r.SerializableCipher=o.extend({cfg:o.extend({format:v}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),a=o.cfg;return y.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),g=(n.kdf={}).OpenSSL={execute:function(e,t,n,r,o){if(r||(r=i.random(8)),o)a=u.create({keySize:t+n,hasher:o}).compute(e,r);else var a=u.create({keySize:t+n}).compute(e,r);var c=i.create(a.words.slice(t),4*n);return a.sigBytes=4*t,y.create({key:a,iv:c,salt:r})}},b=r.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:g}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize,r.salt,r.hasher);r.iv=o.iv;var i=m.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt,r.hasher);return r.iv=o.iv,m.decrypt.call(this,e,t,o.key,r)}})}()}(Gt.exports),Yt.exports=function(e){return function(){var t=e,n=t.lib.BlockCipher,r=t.algo,o=[],i=[],a=[],c=[],s=[],u=[],l=[],d=[],f=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var h=r^r<<1^r<<2^r<<3^r<<4;h=h>>>8^255&h^99,o[n]=h,i[h]=n;var y=e[n],v=e[y],m=e[v],g=257*e[h]^16843008*h;a[n]=g<<24|g>>>8,c[n]=g<<16|g>>>16,s[n]=g<<8|g>>>24,u[n]=g,g=16843009*m^65537*v^257*y^16843008*n,l[h]=g<<24|g>>>8,d[h]=g<<16|g>>>16,f[h]=g<<8|g>>>24,p[h]=g,n?(n=y^e[e[e[m^y]]],r^=e[e[r]]):n=r=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],y=r.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<r;a++)a<n?i[a]=t[a]:(u=i[a-1],a%n?n>6&&a%n==4&&(u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u]):(u=o[(u=u<<8|u>>>24)>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u],u^=h[a/n|0]<<24),i[a]=i[a-n]^u);for(var c=this._invKeySchedule=[],s=0;s<r;s++){if(a=r-s,s%4)var u=i[a];else u=i[a-4];c[s]=s<4||a<=4?u:l[o[u>>>24]]^d[o[u>>>16&255]]^f[o[u>>>8&255]]^p[o[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,c,s,u,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,f,p,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,c){for(var s=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],f=e[t+3]^n[3],p=4,h=1;h<s;h++){var y=r[u>>>24]^o[l>>>16&255]^i[d>>>8&255]^a[255&f]^n[p++],v=r[l>>>24]^o[d>>>16&255]^i[f>>>8&255]^a[255&u]^n[p++],m=r[d>>>24]^o[f>>>16&255]^i[u>>>8&255]^a[255&l]^n[p++],g=r[f>>>24]^o[u>>>16&255]^i[l>>>8&255]^a[255&d]^n[p++];u=y,l=v,d=m,f=g}y=(c[u>>>24]<<24|c[l>>>16&255]<<16|c[d>>>8&255]<<8|c[255&f])^n[p++],v=(c[l>>>24]<<24|c[d>>>16&255]<<16|c[f>>>8&255]<<8|c[255&u])^n[p++],m=(c[d>>>24]<<24|c[f>>>16&255]<<16|c[u>>>8&255]<<8|c[255&l])^n[p++],g=(c[f>>>24]<<24|c[u>>>16&255]<<16|c[l>>>8&255]<<8|c[255&d])^n[p++],e[t]=y,e[t+1]=v,e[t+2]=m,e[t+3]=g},keySize:8});t.AES=n._createHelper(y)}(),e.AES}(Gt.exports);var zt=Yt.exports,Wt={exports:{}};Wt.exports=function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t}(),e.mode.ECB}(Gt.exports);var Kt=Wt.exports,Xt={exports:{}};Xt.exports=Gt.exports.pad.Pkcs7;var Jt=Xt.exports,$t={exports:{}};$t.exports=Gt.exports.enc.Utf8;var Zt,Qt,en=$t.exports;!function(e){e.Channel="channel",e.Custom="custom"}(Zt||(Zt={})),function(e){e.RequestComplete="payment.request.complete",e.PayResult="payment.request.result",e.RefundResult="refund.request.result"}(Qt||(Qt={}));var tn,nn=function(){var e=ge(Le.mark((function e(t,n){var r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Tt(gt.post.bind(gt),{retries:10,interval:1e3}),e.next=3,r(t,n,{timeout:1e4});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),rn={Android:["(?:(?:Orca-)?Android|Adr)[ /](?:[a-z]+ )?(\\d+[\\.\\d]*)","Android|Silk-Accelerated=[a-z]{4,5}","(?:TwitterAndroid).*[ /](?:[a-z]+ )?(\\d+[\\.\\d]*)","FB4A.*FBSV/(\\d+[\\.\\d]*);","BeyondPod|AntennaPod|Podkicker|DoggCatcher|Player FM|okhttp|Podcatcher Deluxe"],Linux:["Arch ?Linux(?:[ /\\-](\\d+[\\.\\d]+))?","VectorLinux(?: package)?(?:[ /\\-](\\d+[\\.\\d]+))?","Linux(?:OS)?[^a-z]"],iOS:["CFNetwork/889","CFNetwork/887","CFNetwork/811","CFNetwork/808\\.3","CFNetwork/808\\.2","CFNetwork/808\\.1","CFNetwork/808\\.0","CFNetwork/808","CFNetwork/758\\.4\\.3","CFNetwork/758\\.3\\.15","CFNetwork/758\\.2\\.[78]","CFNetwork/758\\.1\\.6","CFNetwork/758\\.0\\.2","CFNetwork/711\\.5\\.6","CFNetwork/711\\.4\\.6","CFNetwork/711\\.3\\.18","CFNetwork/711\\.2\\.23","CFNetwork/711\\.1\\.1[26]","CFNetwork/711\\.0\\.6","CFNetwork/672\\.1","CFNetwork/672\\.0","CFNetwork/609\\.1","CFNetwork/60[29]","CFNetwork/548\\.1","CFNetwork/548\\.0","CFNetwork/485\\.13","CFNetwork/485\\.12","CFNetwork/485\\.10","CFNetwork/485\\.2","CFNetwork/467\\.12","CFNetwork/459","(?:CPU OS|iPh(?:one)?[ _]OS|iOS)[ _/](\\d+(?:[_\\.]\\d+)*)","FBIOS.*FBSV/(\\d+[\\.\\d]*);","(?:Apple-)?(?:iPhone|iPad|iPod)(?:.*Mac OS X.*Version/(\\d+\\.\\d+)|; Opera)?","Podcasts/(?:[\\d\\.]+)|Instacast(?:HD)?/(?:\\d\\.[\\d\\.abc]+)|Pocket Casts, iOS|Overcast|Castro|Podcat|i[cC]atcher|RSSRadio/","iTunes-(iPod|iPad|iPhone)/(?:[\\d\\.]+)"],MacOS:["CFNetwork/887.*(x86_64)","CFNetwork/811.*(x86_64)","CFNetwork/807","CFNetwork/760","CFNetwork/720","CFNetwork/673","CFNetwork/596","CFNetwork/520","CFNetwork/454","CFNetwork/(?:438|422|339|330|221|220|217)","CFNetwork/12[89]","CFNetwork/1\\.2","CFNetwork/1\\.1","Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?","Mac (\\d+(?:[_\\.]\\d+)+)","Darwin|Macintosh|Mac_PowerPC|PPC|Mac PowerPC|iMac|MacBook"],Windows:["CYGWIN_NT-10.0|Windows NT 10.0|Windows 10","CYGWIN_NT-6.4|Windows NT 6.4|Windows 10","CYGWIN_NT-6.3|Windows NT 6.3|Windows 8.1","CYGWIN_NT-6.2|Windows NT 6.2|Windows 8","CYGWIN_NT-6.1|Windows NT 6.1|Windows 7","CYGWIN_NT-6.0|Windows NT 6.0|Windows Vista","CYGWIN_NT-5.2|Windows NT 5.2|Windows Server 2003 / XP x64","CYGWIN_NT-5.1|Windows NT 5.1|Windows XP","CYGWIN_NT-5.0|Windows NT 5.0|Windows 2000","CYGWIN_NT-4.0|Windows NT 4.0|WinNT|Windows NT","CYGWIN_ME-4.90|Win 9x 4.90|Windows ME","CYGWIN_98-4.10|Win98|Windows 98","CYGWIN_95-4.0|Win32|Win95|Windows 95|Windows_95","Windows 3.1","Windows"],HarmonyOS:[],Other:[]},on=(tn={},{set:function(e,t){tn[e]=t},get:function(e){if(Object.prototype.hasOwnProperty.call(tn,e))return tn[e]}}),an=function(e,t){try{var n=function(e){var t=on.get(e);if(t)return t.value;var n=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:".concat(e,")"),"i");return on.set(e,{value:n}),n}(e),r=n.exec(t);return r?r.slice(1):null}catch(e){return null}};function cn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var un=Oe((function e(){be(this,e),Ie(this,"parse",(function(e){for(var t=null,n=0,r=Object.keys(rn);n<r.length;n++){var o=r[n];if(o&&Object.prototype.hasOwnProperty.call(rn,o)){var i,a=cn(rn[o]);try{for(a.s();!(i=a.n()).done;){var c=i.value;if(an(c,e))return t=o}}catch(e){a.e(e)}finally{a.f()}}}return t})),Ie(this,"getVersion",(function(e,t){switch(t){case"MacOS":return e.replace(/^.*Mac OS X ([\d_]+).*$/,"$1").replace(/_/g,".");case"iOS":return e.replace(/^.*OS ([\d_]+) like.*$/,"$1").replace(/_/g,".");case"Windows":return e.replace(/^.*Windows NT ([\d.]+);.*$/,"$1");case"Android":return e.replace(/^.*Android ([\d.]+);.*$/,"$1")}return""}))})),ln=function(){var e,t,n=window.navigator,r=n.userAgent,o=n.language,i=window.screen,a=i.colorDepth,c=i.width,s=i.height,u=window.navigator.javaEnabled().toString(),l=(t=(e=new un).parse(navigator.userAgent)||"Other",e.getVersion(navigator.userAgent,t));return{transactionWebSite:window.location.href,javaEnabled:u,colorDepth:a.toString(),screenHeight:c.toString(),screenWidth:s.toString(),timeZoneOffset:(new Date).getTimezoneOffset().toString(),accept:"application/json",userAgent:r,language:o,javaScriptEnabled:"true",deviceOsVersion:l}};function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pn(e){return hn.apply(this,arguments)}function hn(){return(hn=ge(Le.mark((function e(t){var n,r,o,i,a,c;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.method,o=void 0===r?"GET":r,i=t.url,a=t.data,o!==We.GET){e.next=7;break}return e.next=4,gt.get(i);case 4:c=e.sent,e.next=11;break;case 7:if(o!==We.POST){e.next=11;break}return e.next=10,gt.post(i,a||{});case 10:c=e.sent;case 11:return e.abrupt("return",null===(n=c)||void 0===n?void 0:n.data);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post",r=arguments.length>3?arguments[3]:void 0,o=document.createElement("form");for(var i in o.style.display="none",o.method=n,o.action=e,r&&(o.target=r),t){var a=document.createElement("input");a.name=i,a.value=t[i]||"",o.appendChild(a)}document.body.appendChild(o),o.submit()}function vn(e){return mn.apply(this,arguments)}function mn(){return(mn=ge(Le.mark((function e(t){var n,r,o,i;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.method,r=void 0===n?"GET":n,o=t.url,i=t.data,ve.get().info("ready to redirect",{data:{nextAction:t}}),"POST"===r?yn(o,i):"GET"===r&&window.location.assign(o);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gn,bn,wn,_n,On,Cn=function(){var e=ge(Le.mark((function e(t,n){var r,o,i,a,c,s,u;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.data,o=r.needNotify,i=r.notifyUrl,a=r.notifySecretKey,c=(n||{}).data,o){e.next=4;break}return e.abrupt("return");case 4:if(i&&a&&c){e.next=6;break}throw{message:"require props missed",data:{needNotify:o,notifyUrl:i,notifySecretKey:a,data:c}};case 6:return l=JSON.stringify(null==c?void 0:c.eventData),d=a,f=en.parse(l),p=en.parse(d),s=zt.encrypt(f,p,{mode:Kt,padding:Jt}).toString(),u=fn(fn({},c),{},{eventData:s}),e.next=10,nn(i,u);case 10:case"end":return e.stop()}var l,d,f,p}),e)})));return function(t,n){return e.apply(this,arguments)}}(),kn=function(){var e=ge(Le.mark((function e(t,n){var r,o,i,a,c,s,u,l,d,f,p,h,y,v,m;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.type,o=t.url,r!==ze.Confirm){e.next=11;break}return s=fn(fn({},null==n?void 0:n.data),{},{additionalData:{language:(null===(i=window)||void 0===i||null===(a=i.Shopline)||void 0===a?void 0:a.locale)||"en"},client:ln()}),e.next=5,gt.post(o,s);case 5:if(200===(u=e.sent).statusCode&&null!==(c=u.data)&&void 0!==c&&c.nextAction){e.next=8;break}throw new Error("confirm return return error or no nextAction");case 8:kn(u.data.nextAction),e.next=54;break;case 11:if(r!==ze.Redirect){e.next=15;break}vn(t),e.next=54;break;case 15:if(r!==ze.ChannelInfoUpdate){e.next=25;break}return t.data&&(null!=n&&n.data&&(t.data=fn(fn({},t.data),n.data)),null!=n&&n.channelInfoData&&null!==(l=t.data)&&void 0!==l&&null!==(d=l.channelInfoJsonData)&&void 0!==d&&d.includes("@@channelInfoData@@")&&(f=null!=n&&n.channelInfoData?JSON.stringify(n.channelInfoData):"",t.data.channelInfoJsonData=t.data.channelInfoJsonData.replace("@@channelInfoData@@",f))),e.next=19,pn(t);case 19:if(null==(p=e.sent)||!p.nextAction){e.next=23;break}return e.next=23,kn(p.nextAction,n);case 23:e.next=54;break;case 25:if(r!==ze.ChannelConfirm){e.next=32;break}if(null==(y=null==n||null===(h=n.payOptions)||void 0===h?void 0:h.hooks)||!y.channelConfirm){e.next=30;break}return e.next=30,y.channelConfirm(t);case 30:e.next=54;break;case 32:if(r!==ze.OpenIframe){e.next=37;break}new qt(t.type).openIframe(t),e.next=54;break;case 37:if(r!==ze.RedirectOrPopup){e.next=42;break}return e.next=40,Cn(t,n);case 40:e.next=54;break;case 42:if(r!==ze.Gather){e.next=47;break}return v=new qt(t.type,n),e.abrupt("return",v.gather(t));case 47:if(r!==ze.Challenge){e.next=52;break}return m=new qt(t.type,n),e.abrupt("return",m.challenge(t));case 52:ve.get().error("do not match nextAction type",{data:{nextAction:t},error:new Error("")});case 54:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();!function(e){e.TEST="TEST",e.PRODUCTION="PRODUCTION"}(bn||(bn={})),function(e){e.INITIALIZE="INITIALIZE",e.SHIPPING_ADDRESS="SHIPPING_ADDRESS",e.SHIPPING_OPTION="SHIPPING_OPTION",e.OFFER="OFFER"}(wn||(wn={})),function(e){e.NOT_CURRENTLY_KNOWN="NOT_CURRENTLY_KNOWN",e.ESTIMATED="ESTIMATED",e.FINAL="FINAL"}(_n||(_n={})),function(e){e.DEFAULT="DEFAULT",e.COMPLETE_IMMEDIATE_PURCHASE="COMPLETE_IMMEDIATE_PURCHASE"}(On||(On={}));var Sn,En,Pn,In=(Ie(gn={},wn.INITIALIZE,Ye.Ordinary),Ie(gn,wn.SHIPPING_ADDRESS,Ye.ChangeAddress),Ie(gn,wn.SHIPPING_OPTION,Ye.ChangeDeliveryMethod),Ie(gn,wn.OFFER,Ye.UseDiscountCode),gn);!function(e){e.OFFER_INVALID="OFFER_INVALID",e.PAYMENT_DATA_INVALID="PAYMENT_DATA_INVALID",e.SHIPPING_ADDRESS_INVALID="SHIPPING_ADDRESS_INVALID",e.SHIPPING_ADDRESS_UNSERVICEABLE="SHIPPING_ADDRESS_UNSERVICEABLE",e.SHIPPING_OPTION_INVALID="SHIPPING_OPTION_INVALID",e.OTHER_ERROR="OTHER_ERROR"}(Sn||(Sn={})),function(e){e[e.TimeoutToLoadPaymentData=18]="TimeoutToLoadPaymentData",e[e.UserCancel=20]="UserCancel"}(En||(En={})),(Pn||(Pn={})).CANCELED="CANCELED";var xn,Tn,jn,An,Ln,Dn=function(){function e(t,n,r){var o=this;be(this,e),Ie(this,"container",void 0),Ie(this,"button",void 0),Ie(this,"styleElement",null),Ie(this,"options",void 0),Ie(this,"insertStyle",(function(){var e=document.createElement("style"),t="\n      .gpay-card-info-container {\n        border-radius: 0;\n        min-width: 140px;\n        min-height: 36px;\n      }\n\n      .".concat(Bt," .gpay-card-info-container-fill {\n        display: none;\n      }\n    ");void 0===o.options["border-radius"]&&(t+="\n        #".concat(o.container.id," .gpay-card-info-container {\n          border-radius: 4px;\n        }\n\n        [data-button_style=square] #").concat(o.container.id," .gpay-card-info-container {\n          border-radius: 0;\n        }\n\n        [data-button_style=rounded] #").concat(o.container.id," .gpay-card-info-container {\n          border-radius: 9999px;\n        }\n      ")),e.innerHTML=t;var n=48;o.options.height&&(n=o.options.height),o.container.style.height="".concat(n,"px"),o.styleElement=e,o.container.appendChild(e)})),Ie(this,"insertButton",(function(){o.container.appendChild(o.button)})),Ie(this,"removeElement",(function(){o.container.removeChild(o.button),o.styleElement&&o.container.removeChild(o.styleElement)})),Ie(this,"destroy",(function(){o.removeElement()})),this.container=t,this.button=n,this.options=r,this.insertStyle(),this.insertButton()}return Oe(e,[{key:"setDisabled",value:function(e){e?this.container.classList.add(Nt):this.container.classList.remove(Nt)}},{key:"setLoading",value:function(e){e?this.container.classList.add(Bt):this.container.classList.remove(Bt)}}]),e}();!function(e){e.Dev="dev",e.Test="test",e.Test2="test2",e.Stg="stg",e.Prev="prev",e.Prod="prod"}(Tn||(Tn={})),function(e){e.Dev="stg",e.Test="stg",e.Test2="stg",e.Prev="prev",e.Prod="prod"}(jn||(jn={})),function(e){e.Test1="test1",e.Test2="test2",e.Test3="test3",e.Alpha="alpha",e.Prod="prod"}(An||(An={})),function(e){e.Dev="https://ec-pa-cashier.myshoplinedev.com",e.Test="https://ec-pa-cashier.myshoplinestg.com",e.Test2="https://paygate-cashier-test.myshoplinestg.com",e.Stg="https://ec-pa-cashier-stg.myshoplinestg.com",e.Prev="https://ec-pa-cashier-prev.myshopline.com",e.Prod="https://ec-pa-cashier.myshopline.com"}(Ln||(Ln={}));var Nn,Bn={host:"ec-pa-cashier.myshopline.com",staticHost:"https://cdn.myshopline.com/sl/payment-sdk"};function Rn(e){return"".concat(Bn.staticHost,"/").concat(e,"assets")}!function(e){e.Dev="dev/",e.Test="test/",e.Test2="test/",e.Stg="test/",e.Prev="prev/",e.Prod=""}(Nn||(Nn={}));var Mn=Object.freeze((Ie(xn={},Tn.Dev,{env:An.Test3,host:Ln.Dev,slI18nEnv:jn.Dev,staticPath:Rn(Nn.Dev)}),Ie(xn,Tn.Test,{env:An.Test3,host:Ln.Test,slI18nEnv:jn.Test,staticPath:Rn(Nn.Test)}),Ie(xn,Tn.Test2,{env:An.Test2,host:Ln.Test2,slI18nEnv:jn.Test2,staticPath:Rn(Nn.Test2)}),Ie(xn,Tn.Stg,{env:An.Test3,host:Ln.Stg,slI18nEnv:jn.Test,staticPath:Rn(Nn.Test)}),Ie(xn,Tn.Prev,{env:An.Test3,host:Ln.Prev,slI18nEnv:jn.Prev,staticPath:Rn(Nn.Prev)}),Ie(xn,Tn.Prod,{env:An.Prod,host:Ln.Prod,slI18nEnv:jn.Prod,staticPath:Rn(Nn.Prod)}),xn)),Fn=function(e){return window.loadjs=Ze,new Promise((function(t,n){var r=e;Ze.isDefined(r)?t(!0):Ze(e,r,{returnPromise:!0}).then((function(){t(!0)})).catch((function(e){n(e)}))}))},Hn=function(){if(/iphone|ipod|ipad/i.test(navigator.userAgent.toLowerCase()))return!1;var e=navigator.userAgent.match(/Chrome\/(\d+)/),t=e&&e[1]&&Number(e[1])>=61;return function(){var e=window.navigator.userAgent;return!!e.match("CriOS")||/Chrome/.test(e)&&/Google Inc./.test(window.navigator.vendor)&&!!window.chrome}()&&t};function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yn=function(e){Se(i,Mt);var t,n,r,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(i);function i(e){var t,n,r;return be(this,i),Ie(Ce(r=o.call(this,e)),"name","GOOGLE_PAY"),Ie(Ce(r),"config",void 0),Ie(Ce(r),"paymentsClient",null),Ie(Ce(r),"buttonElement",null),Ie(Ce(r),"disabled",!1),Ie(Ce(r),"loading",!1),Ie(Ce(r),"initSuccess",!0),Ie(Ce(r),"loadResourceFail",!1),Ie(Ce(r),"initTime",0),Ie(Ce(r),"logger",void 0),Ie(Ce(r),"onPaymentDataChanged",function(){var e=ge(Le.mark((function e(t){var n,o,i,a,c,s,u,l,d;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.callbackTrigger,e.next=3,null===(n=(o=r.config).onFormDataChange)||void 0===n?void 0:n.call(o,t,In[i]).catch((function(){r.handleError(new Error("Failed to update abandonedOrder info"),Ne.Pay)}));case 3:if(a=e.sent,r.logger.info("Order information updated, data received from business side",{data:qn({},a)}),a&&!a.error){e.next=7;break}return e.abrupt("return",{error:{reason:Sn.OTHER_ERROR,intent:i===wn.OFFER?wn.INITIALIZE:i,message:(null==a||null===(c=a.error)||void 0===c?void 0:c.message)||"update error"}});case 7:return s=a.newOfferInfo,u=a.newTransactionInfo,l=a.newShippingOptionParameters,It(d={newOfferInfo:s,newTransactionInfo:u,newShippingOptionParameters:l}),r.logger.log("Order information updated, data returned to channel",{data:qn({},d)}),e.abrupt("return",d);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ie(Ce(r),"onPaymentAuthorized",(function(e){return new Promise((function(t,n){var o,i;(null===(o=(i=r.config).createOrder)||void 0===o?void 0:o.call(i,r.config.paymentInfo,{payChannelData:e,token:e})).then((function(e){if(!e||e.error)throw e.error;r.afterCreateOrder(qe.Success),t({transactionState:"SUCCESS"}),kn(e.nextAction)})).catch((function(e){r.afterCreateOrder(qe.Fail),n({reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_AUTHORIZATION",message:e.message||"pay error"})}))}))})),Ie(Ce(r),"onGooglePaymentButtonClicked",ge(Le.mark((function e(){var t,n,o,i;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.paymentsClient&&!r.loading&&!r.disabled){e.next=2;break}return e.abrupt("return");case 2:return r.setLoading(!0),e.next=5,r.beforeCreateOrder().catch((function(){return{valid:!1}}));case 5:if(n=e.sent,r.setLoading(!1),!1!==(null==n?void 0:n.valid)){e.next=9;break}return e.abrupt("return");case 9:if(o=null==n||null===(t=n.paymentConfig)||void 0===t?void 0:t.payChannelData){e.next=12;break}return e.abrupt("return");case 12:It(o),i=setTimeout((function(){r.onChannelModalSuccess()}),1e3),r.logger.log("User clicked GP button, launching payment modal",{data:qn({},o)}),r.paymentsClient.loadPaymentData(o).catch((function(e){clearTimeout(i),e.statusCode!==Pn.CANCELED||e.code!==En.TimeoutToLoadPaymentData?e.statusCode!==Pn.CANCELED?r.handleError(new Error("pay failed"),Ne.Pay,{error:e}):r.logger.log("loadPaymentData return cancel error",{data:{error:e}}):r.handleError(new Error("Failed to pull up the channel"),Ne.PullUpChannel,{error:e})}));case 16:case"end":return e.stop()}}),e)})))),Ie(Ce(r),"destroy",(function(){var e;null===(e=r.buttonElement)||void 0===e||e.destroy(),r.buttonElement=null,r.paymentsClient=null})),r.config=e,ve.set(null===(t=(n=r.config).loggerFn)||void 0===t?void 0:t.call(n)),r.logger=ve.get().pipeOwner("payment-common.SLP-GooglePay").pipeData({domId:"".concat(r.config.props.domId)}),r}return Oe(i,[{key:"render",value:(r=ge(Le.mark((function e(){var t,n;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Hn()){e.next=3;break}return this.handleError(new Error("The current browser does not support Google Pay"),Ne.Init),e.abrupt("return");case 3:return this.beforeInit(),e.next=6,this.loadChannelJs();case 6:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:if(t=this.createClient()){e.next=12;break}return e.abrupt("return");case 12:if(n={},this.config.paymentInfo.channelSdkInitConfig){e.next=16;break}return this.handleError(new Error("channelSdkInitConfig is empty"),Ne.Init),e.abrupt("return");case 16:e.prev=16,n=JSON.parse(this.config.paymentInfo.channelSdkInitConfig),e.next=24;break;case 20:return e.prev=20,e.t0=e.catch(16),this.handleError(new Error("Failure to parse channel configuration JSON string"),Ne.Init,{channelSdkInitConfig:this.config.paymentInfo.channelSdkInitConfig}),e.abrupt("return");case 24:return e.next=26,this.canMakePayments(t,n.payChannelData);case 26:if(e.sent){e.next=30;break}return this.handleError(new Error("The current browser does not support Google Pay"),Ne.Init),e.abrupt("return");case 30:this.renderButton(),this.afterInit();case 32:case"end":return e.stop()}}),e,this,[[16,20]])}))),function(){return r.apply(this,arguments)})},{key:"canMakePayments",value:(n=ge(Le.mark((function e(t,n){var r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.isReadyToPay(n);case 3:return r=e.sent,e.abrupt("return",r.result);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e,t){return n.apply(this,arguments)})},{key:"beforeInit",value:function(){this.initTime=Pt.now(),Ct(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(){this.initSuccess=!0,this.showButton();var e=Pt.now()-this.initTime;this.logger.log("afterInit",{data:{duration:e}}),Ct(this.config.afterInit)&&this.config.afterInit()}},{key:"onChannelModalSuccess",value:function(){Ct(this.config.onChannelModalSuccess)&&this.config.onChannelModalSuccess(this.config.paymentInfo)}},{key:"beforeCreateOrder",value:(t=ge(Le.mark((function e(){var t,n,r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ct(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return t=this.config.paymentInfo,n=t.channelCode,r=t.methodCode,o=t.paymentId,i=t.accessMode,e.next=5,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o,accessMode:i});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){Ct(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:this.config.paymentInfo.channelCode,methodCode:Me.GooglePay})}},{key:"setDisabled",value:function(e){var t;this.disabled=e,null===(t=this.buttonElement)||void 0===t||t.setDisabled(e)}},{key:"setLoading",value:function(e){var t;this.loading=e,null===(t=this.buttonElement)||void 0===t||t.setLoading(e)}},{key:"loadChannelJs",value:function(){var e=this;return new Promise((function(t){Fn("https://pay.google.com/gp/p/js/pay.js").then((function(){e.loadResourceFail=!1,t(!0)})).catch((function(n){e.loadResourceFail=!0,e.handleError(new Error("Failed to load channel js resource:".concat(n)),Ne.Init),t(!1)}))}))}},{key:"createClient",value:function(){var e=this.config.paymentInfo.sdkEnv===Tn.Prod?bn.PRODUCTION:bn.TEST;try{return this.paymentsClient=new window.google.payments.api.PaymentsClient({environment:e,paymentDataCallbacks:{onPaymentDataChanged:this.onPaymentDataChanged,onPaymentAuthorized:this.onPaymentAuthorized}}),this.paymentsClient}catch(e){this.handleError(new Error("Failed to create channel instance"),Ne.Init,{channelMsg:e.message})}}},{key:"renderButton",value:function(){if(this.paymentsClient)try{var e,t,n=this.paymentsClient.createButton({onClick:this.onGooglePaymentButtonClicked,buttonSizeMode:"fill"}),r=document.getElementById(this.config.paymentInfo.currentDomId);if(!r)throw new Error("Container not found: #".concat(this.config.paymentInfo.currentDomId));this.buttonElement=new Dn(r,n,{height:null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height,"border-radius":null===(t=this.config.props.styleOptions)||void 0===t?void 0:t["border-radius"]})}catch(e){this.handleError(new Error("Failed to render button"),Ne.Init,{channelMsg:e.message})}}},{key:"handleError",value:function(e,t,n){window[window.__sl_console__?"__sl_console__":"console"].error("GP unified error handling: ",{error:e,type:t,extData:n}),t!==Ne.CreateExpected&&this.logger.error("handleError",{action:t,error:e,data:qn({},n)}),t===Ne.Init&&(this.initSuccess=!1,this.hideButton()),Ct(this.config.onError)&&this.config.onError(e,t,n)}}]),i}();function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zn=function(e){var t=e;if(null!=e&&e.paymentInfo){var n=e.paymentInfo.configData;t.props=Vn(Vn({},e.props),n)}return t};function Wn(e){return"object"===("undefined"==typeof Node?"undefined":N(Node))?e instanceof Node:e&&"object"===N(e)&&"number"==typeof e.nodeType}function Kn(){var e=[];return{watch:e.push.bind(e),trigger:function(t,n){for(var r=!0,o={detail:n,preventDefault:function(){r=!1}},i=0;i<e.length;i++)e[i](t,o);return r}}}function Xn(e){return"none"===window.getComputedStyle(e).display}function Jn(e){this.elem=e}function $n(e,t){return Jn.make(e("parent")).clazz("pico-overlay").clazz(e("overlayClass","")).stylize({display:"none",position:"fixed",top:"0px",left:"0px",height:"100%",width:"100%",zIndex:1e4}).stylize(e("overlayStyles",{opacity:.5,background:"#000"})).onClick((function(){e("overlayClose",!0)&&t()}))}Jn.make=function(e,t){"string"==typeof e&&(e=document.querySelector(e));var n=document.createElement(t||"div");return(e||document.body).appendChild(n),new Jn(n)},Jn.prototype={child:function(e){return Jn.make(this.elem,e)},stylize:function(e){for(var t in void 0!==(e=e||{}).opacity&&(e.filter="alpha(opacity="+100*e.opacity+")"),e)e.hasOwnProperty(t)&&(this.elem.style[t]=e[t]);return this},clazz:function(e){return this.elem.className+=" "+e,this},html:function(e){return Wn(e)?this.elem.appendChild(e):this.elem.innerHTML=e,this},onClick:function(e){return this.elem.addEventListener("click",e),this},destroy:function(){this.elem.parentNode.removeChild(this.elem)},hide:function(){this.elem.style.display="none"},show:function(){this.elem.style.display="block"},attr:function(e,t){return void 0!==t&&this.elem.setAttribute(e,t),this},anyAncestor:function(e){for(var t=this.elem;t;){if(e(new Jn(t)))return!0;t=t.parentNode}return!1},isVisible:function(){return!Xn(this.elem)}};var Zn=1;function Qn(e,t){if(t("closeButton",!0))return e.child("button").html(t("closeHtml","&#xD7;")).clazz("pico-close").clazz(t("closeClass","")).stylize(t("closeStyles",{borderRadius:"2px",border:0,padding:0,cursor:"pointer",height:"15px",width:"15px",position:"absolute",top:"5px",right:"5px",fontSize:"16px",textAlign:"center",lineHeight:"15px",background:"#CCC"})).attr("aria-label",t("close-label","Close"))}function er(e){return function(){return e().elem}}var tr,nr,rr,or,ir,ar=Kn(),cr=Kn();function sr(e){("string"==typeof e||Wn(e))&&(e={content:e});var t=Kn(),n=Kn(),r=Kn(),o=Kn(),i=Kn();function a(t,n){var r=e[t];return"function"==typeof r&&(r=r(n)),void 0===r?n:r}var c,s,u=y.bind(window,"modal"),l=y.bind(window,"overlay"),d=y.bind(window,"close");function f(e){l().hide(),u().hide(),i.trigger(c,e)}function p(e){o.trigger(c,e)&&f(e)}function h(e){return function(){return e.apply(this,arguments),c}}function y(e,n){if(!s){var r=function(e,t){var n=e("width","auto");"number"==typeof n&&(n+="px");var r=e("modalId","pico-"+Zn++);return Jn.make(e("parent")).clazz("pico-content").clazz(e("modalClass","")).stylize({display:"none",position:"fixed",zIndex:10001,left:"50%",top:"38.1966%",maxHeight:"90%",boxSizing:"border-box",width:n,"-ms-transform":"translate(-50%,-38.1966%)","-moz-transform":"translate(-50%,-38.1966%)","-webkit-transform":"translate(-50%,-38.1966%)","-o-transform":"translate(-50%,-38.1966%)",transform:"translate(-50%,-38.1966%)"}).stylize(e("modalStyles",{overflow:"auto",backgroundColor:"white",padding:"20px",borderRadius:"5px"})).html(e("content")).attr("id",r).attr("role","dialog").attr("aria-labelledby",e("ariaLabelledBy")).attr("aria-describedby",e("ariaDescribedBy",r)).onClick((function(e){new Jn(e.target).anyAncestor((function(e){return/\bpico-close\b/.test(e.elem.className)}))&&t()}))}(a,p);s={modal:r,overlay:$n(a,p),close:Qn(r,a)},t.trigger(c,n)}return s[e]}return function(e,t){function n(e,t){return(e.msMatchesSelector||e.webkitMatchesSelector||e.matches).call(e,t)}function r(e){return!(Xn(e)||n(e,":disabled")||e.hasAttribute("contenteditable"))&&(e.hasAttribute("tabindex")||n(e,"input,select,textarea,button,a[href],area[href],iframe"))}function o(e){for(var t=e.getElementsByTagName("*"),n=0;n<t.length;n++)if(r(t[n]))return t[n]}var i;e.beforeShow((function(){i=document.activeElement})),e.afterShow((function(){if(t()){var n=o(e.modalElem());n&&n.focus()}})),e.afterClose((function(){t()&&i&&i.focus(),i=null})),cr.watch((function(n){if(t()&&e.isVisible()){var i=o(e.modalElem()),a=function(e){for(var t=e.getElementsByTagName("*"),n=t.length;n--;)if(r(t[n]))return t[n]}(e.modalElem());(n.shiftKey?i:a)===document.activeElement&&((n.shiftKey?a:i).focus(),n.preventDefault())}}))}(c={modalElem:er(u),closeElem:er(d),overlayElem:er(l),buildDom:h(y.bind(null,null)),isVisible:function(){return!!(s&&u&&u().isVisible())},show:function(e){return n.trigger(c,e)&&(l().show(),d(),u().show(),r.trigger(c,e)),this},close:h(p),forceClose:h(f),destroy:function(){u().destroy(),l().destroy(),l=u=d=void 0},options:function(t){Object.keys(t).map((function(n){e[n]=t[n]}))},afterCreate:h(t.watch),beforeShow:h(n.watch),afterShow:h(r.watch),beforeClose:h(o.watch),afterClose:h(i.watch)},a.bind(null,"focus",!0)),function(e,t){var n,r=new Jn(document.body);e.beforeShow((function(){n=r.elem.style.overflow,t()&&r.stylize({overflow:"hidden"})})),e.afterClose((function(){r.stylize({overflow:n})}))}(c,a.bind(null,"bodyOverflow",!0)),ar.watch((function(){a("escCloses",!0)&&c.isVisible()&&c.close()})),c}document.documentElement.addEventListener("keydown",(function(e){var t=e.which||e.keyCode;27===t?ar.trigger():9===t&&cr.trigger(e)})),function(e){e.Validatemerchant="validatemerchant",e.Paymentmethodselected="paymentmethodselected",e.Cancel="cancel",e.Shippingcontactselected="shippingcontactselected",e.Authorize="Authorize",e.Create="create",e.Couponcodechanged="couponcodechanged",e.Shippingmethodselected="shippingmethodselected",e.Paymentauthorized="paymentauthorized"}(tr||(tr={})),function(e){e.ShippingContactInvalid="shippingContactInvalid",e.BillingContactInvalid="billingContactInvalid",e.AddressUnserviceable="addressUnserviceable",e.CouponCodeInvalid="couponCodeInvalid",e.CouponCodeExpired="couponCodeExpired",e.Unknown="unknown"}(nr||(nr={})),(rr||(rr={})).Credit="credit",(or||(or={})).Unknown="unknown";var ur,lr="applepay-confirm-modal",dr='<svg width="59" height="24" viewBox="0 0 59 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M10.6871 3.0942C10.002 3.90485 8.90594 4.54424 7.80985 4.4529C7.67283 3.3568 8.20947 2.1922 8.83744 1.47288C9.5225 0.639391 10.7214 0.0456708 11.6919 0C11.806 1.14177 11.3608 2.2607 10.6871 3.0942ZM11.6804 4.66984C10.0934 4.5785 8.73468 5.57184 7.98111 5.57184C7.21613 5.57184 6.06294 4.71551 4.80699 4.73834C3.17426 4.76118 1.65571 5.68601 0.822213 7.1589C-0.890442 10.1047 0.376923 14.4662 2.03249 16.8639C2.84315 18.0514 3.81365 19.353 5.09243 19.3073C6.30271 19.2617 6.78225 18.5195 8.24372 18.5195C9.7166 18.5195 10.1391 19.3073 11.4178 19.2845C12.7423 19.2617 13.5758 18.0971 14.3864 16.9096C15.3113 15.5623 15.6881 14.2493 15.7109 14.1808C15.6881 14.1579 13.1533 13.1874 13.1305 10.2645C13.1077 7.82112 15.1286 6.65652 15.2199 6.58801C14.0782 4.89819 12.297 4.71551 11.6804 4.66984ZM20.8489 1.35871V19.1589H23.6119V13.0733H27.4369C30.9307 13.0733 33.3855 10.6755 33.3855 7.20457C33.3855 3.73359 30.9764 1.35871 27.5282 1.35871H20.8489ZM23.6119 3.68792H26.7975C29.1952 3.68792 30.5653 4.9667 30.5653 7.21598C30.5653 9.46527 29.1952 10.7555 26.7861 10.7555H23.6119V3.68792ZM38.4321 19.2959C40.1676 19.2959 41.7775 18.4167 42.5082 17.0238H42.5653V19.1589H45.1229V10.2988C45.1229 7.72978 43.0677 6.07421 39.905 6.07421C36.9706 6.07421 34.8013 7.75262 34.7214 10.059H37.2104C37.4159 8.96289 38.4321 8.24358 39.8251 8.24358C41.5149 8.24358 42.4626 9.0314 42.4626 10.4814V11.4634L39.0144 11.6689C35.806 11.863 34.0706 13.176 34.0706 15.4596C34.0706 17.7659 35.8631 19.2959 38.4321 19.2959ZM39.1743 17.1836C37.7014 17.1836 36.7651 16.4757 36.7651 15.3911C36.7651 14.2721 37.6671 13.6213 39.3912 13.5186L42.4626 13.3245V14.3292C42.4626 15.9962 41.0468 17.1836 39.1743 17.1836ZM48.5368 24C51.2314 24 52.4987 22.9724 53.6062 19.8554L58.4588 6.24548H55.65L52.396 16.7612H52.3389L49.0848 6.24548H46.1962L50.8774 19.2046L50.6262 19.9924C50.2038 21.3283 49.5187 21.8421 48.297 21.8421C48.0801 21.8421 47.6576 21.8192 47.4864 21.7964V23.9315C47.6462 23.9772 48.3313 24 48.5368 24Z" fill="currentColor"/>\n</svg>',fr={props:{payMode:Be.Continue,buttonTimeoutConfig:{enable:!1,timeoutMillis:5e3},timing:!1}},pr=(Ie(ir={},tr.Paymentmethodselected,Ye.Ordinary),Ie(ir,tr.Shippingcontactselected,Ye.ChangeAddress),Ie(ir,tr.Cancel,Ye.Ordinary),Ie(ir,tr.Validatemerchant,Ye.Ordinary),Ie(ir,tr.Authorize,Ye.Ordinary),Ie(ir,tr.Create,Ye.Ordinary),Ie(ir,tr.Couponcodechanged,Ye.UseDiscountCode),Ie(ir,tr.Shippingmethodselected,Ye.ChangeDeliveryMethod),Ie(ir,tr.Paymentauthorized,Ye.Ordinary),ir),hr=function(){var e=ge(Le.mark((function e(t){var n,r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={useRetry:!0,action:$e.I18n,retryOptions:{maxCount:3,interval:1e3}},r=t.project,o=t.env,i=t.lang,e.next=4,gt.get("https://cdn.myshopline.com/t/i18n/".concat(r,"/").concat(o,"/").concat(i,".raw.tree.json"),n);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();!function(e){e.Dev="develop",e.Stg="staging",e.Prev="preview",e.Prod="product"}(ur||(ur={}));var yr,vr="pay-button";!function(e){e.Stg="stg",e.Prev="prev",e.Prod="prod"}(yr||(yr={}));var mr=function(e,t){var n=t.split(".").reduce((function(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:{}}),e);return function(e){return function(e,t){return"[object Object]"===Object.prototype.toString.call(e)}(e)}(n)?"":n},gr=function(e){var t;return(Ie(t={},ur.Dev,yr.Stg),Ie(t,ur.Stg,yr.Stg),Ie(t,ur.Prev,yr.Prev),Ie(t,ur.Prod,yr.Prod),t)[e]},br={en:{applepay:{cancel:"Cancel",enquire:"Continue to place the order with Apple Pay?",paywith:"Pay with"},cart:{cart:{buy_now:"Buy now"},checkout:{max_amount_limit:"You exceeded the maximum amount for checkout"},couponCode:{existCode:"Discount code already exists"},error:{default:"Failed to load resource",noshipping:"No available shipping rate plans",order:"Unable to place order",renew:"Failed to update data"}},general:{abandon:{Order:{risk:"You have sent too many requests"}}},products:{product_details:{link_preview_does_not_support:"The link preview does not support this action",more_payment_options:"More payment options"},product_list:{select_product_all_options:"Please select all options of this product"}},sdk:{button:{show:"More",unavailable:{network_unstable:"Network unstable. Try again to continue.",wait_and_retry:"There are currently too many customers. Please wait patiently and try again after {seconds} seconds."}}},transaction:{discount:{code_error:"Enter a valid discount code"}},unvisiable:{shopby:{button:{show:"Secured and Faster"}}}}},wr=Oe((function e(){var t=this;be(this,e),Ie(this,"locale",br.en),Ie(this,"envLocal",window.__I18N__),Ie(this,"language",""),Ie(this,"setLanguage",function(){var e=ge(Le.mark((function e(n){var r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.language!==n){e.next=2;break}return e.abrupt("return");case 2:return t.language=n,r=(null===(c=window.__ENV__)||void 0===c?void 0:c.APP_ENV)||ur.Prod,o=gr(r),i=br.en,a=ve.get().withOwner("I18n"),e.prev=7,a.info("get i18n json",{data:{project:vr,env:o,lang:n}}),e.next=11,hr({project:vr,env:o,lang:n});case 11:i=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),a.error("get i18n json error",{error:e.t0});case 17:t.locale=i;case 18:case"end":return e.stop()}var c}),e,null,[[7,14]])})));return function(t){return e.apply(this,arguments)}}()),Ie(this,"useI18n",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(n,r){var o=mr(t.envLocal||{},e?[e,n].join("."):n)||"";return o||(o=mr(t.locale||{},e?[e,n].join("."):n)||""),o||(o=mr(br.en||{},e?[e,n].join("."):n)||""),r&&Object.entries(r).forEach((function(e){var t=Ot(e,2),n=t[0],r=t[1];return o=o.replace(new RegExp("{".concat(n,"}"),"ig"),r)})),o}}))})),_r=new wr,Or=_r.useI18n,Cr=_r.setLanguage,kr=Or(),Sr=function(){var e=ge(Le.mark((function e(t){var n,r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ok,r=t.cancel,o="".concat(lr,"-action-ok"),i="".concat(lr,"-action-cancel"),a=sr({content:'<div>\n        <div class="'.concat(lr,'-header">').concat(dr,'</div>\n        <div class="').concat(lr,'-content">').concat(kr("applepay.enquire"),'</div>\n        <div class="').concat(lr,'-action">\n          <button class="').concat(o,'"><span>').concat(kr("applepay.paywith"),"</span> ").concat(dr,'</button>\n          <button class="').concat(i,'">').concat(kr("applepay.cancel"),"</button>\n        </div>\n      </div>"),modalStyles:function(e){return e.width="calc(100% - 32px)",e.maxWidth="397px",e.padding="24px",e.top="45%",e.borderRadius="8px",e.background="rgba(255, 255, 255, 1)",e.backdropFilter="blur(6px)",e},overlayStyles:function(e){return e.backgroundColor="rgba(0, 0, 0, 0.5)",e.opacity="1",e},modalClass:"sl-payment ".concat(lr),closeButton:!1,overlayClose:!1,escCloses:!1}).afterCreate((function(e){var t,a,c=e.modalElem();if(!c)throw new Error("picoModal instantiated object not found");null===(t=c.querySelector(".".concat(o)))||void 0===t||t.addEventListener("click",(function(){e.close(),n(e)})),null===(a=c.querySelector(".".concat(i)))||void 0===a||a.addEventListener("click",(function(){e.close(),null==r||r()}))})),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Er=function(e){var t,n=e.node,r=e.domId,o=e.height,i=e.wrapperClass,a=document.createElement("div");a.classList.add("applepay__bg");var c=document.createElement("style");if(Pr({styleTag:c,domId:r,height:o}),n)return i&&n.classList.add(i),null===(t=n.parentElement)||void 0===t||t.insertBefore(c,n),n.appendChild(a),a},Pr=function(e){var t=e.styleTag,n=e.domId,r=e.height;t.innerHTML="\n    #".concat(n," applepay__bg {\n        overflow: hidden;\n        text-align: center;\n        height: ").concat(r,"px;\n      }\n    ")};function Ir(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var xr=function(e){return e.channelCode===Re.SLpayments},Tr=function(e){return e.channelCode===Re.AdyenExpress},jr=function(e){return function(e){return e.accessMode===Ge.PAYMENT_OPEN}(e)||e.channelCode===Re.CybsOther};function Ar(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}window.crypto||(window.crypto=window.msCrypto);var Lr=function(){try{return function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,t="",n=crypto.getRandomValues(new Uint8Array(e));e--;){var r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t}(36)}catch(e){return Date.now()+Math.random().toString(36).slice(2)}},Dr=function e(){Ar(this,e),this.pvId=Lr()};Dr.setPvIdInGlobal=function(e){window.__PAYMENT_SDK_PVID__=e},Dr.getPvIdInGlobal=function(){return window.__PAYMENT_SDK_PVID__};var Nr=function(){var e=Dr.getPvIdInGlobal();if(e)return e;var t=(new Dr).pvId;return Dr.setPvIdInGlobal(t),t}();function Br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rr(e,t,n){return t&&Br(e.prototype,t),n&&Br(e,n),e}var Mr="",Fr=function(){function e(){Ar(this,e);var t=navigator.userAgent;this.ua=t,this.os=this.detectOS(this.ua),this.os_version=this.detectOSVersion(this.ua,this.os),this.browser=this.detectBrowser(this.ua),this.browser_version=this.detectBrowserVersion(this.ua,this.browser)}return Rr(e,[{key:"detectOS",value:function(e){switch(!0){case/Android/.test(e):return"Android";case/iPhone|iPad|iPod/.test(e):return"iOS";case/Windows/.test(e):return"Windows";case/Mac OS X/.test(e):return"Mac";case/CrOS/.test(e):return"Chrome OS";case/Firefox/.test(e):return"Firefox OS"}return""}},{key:"detectOSVersion",value:function(e,t){switch(t){case"Android":return this.getVersion(e,"Android");case"iOS":return this.getVersion(e,/OS /);case"Windows":return this.getVersion(e,/Phone/.test(e)?/Windows Phone (?:OS )?/:/Windows NT/);case"Mac":return this.getVersion(e,/Mac OS X /)}return"0.0.0"}},{key:"getVersion",value:function(e,t){try{return this.normalizeSemverString(e.split(t)[1].trim().split(/[^\w.]/)[0])}catch(e){}return"0.0.0"}},{key:"normalizeSemverString",value:function(e){var t=e.split(/[._]/);return(parseInt(t[0],10)||0)+"."+(parseInt(t[1],10)||0)+"."+(parseInt(t[2],10)||0)}},{key:"detectBrowser",value:function(e){var t=/Android/.test(e);switch(!0){case/CriOS/.test(e):return"Chrome for iOS";case/Edge/.test(e):return"Edge";case t&&/Silk\//.test(e):return"Silk";case/Chrome/.test(e):return"Chrome";case/Firefox/.test(e):return"Firefox";case t:return"AOSP";case/MSIE|Trident/.test(e):return"IE";case/Safari\//.test(e):return"Safari";case/AppleWebKit/.test(e):return"WebKit"}return""}},{key:"detectBrowserVersion",value:function(e,t){switch(t){case"Chrome for iOS":return this.getVersion(e,"CriOS/");case"Edge":return this.getVersion(e,"Edge/");case"Chrome":return this.getVersion(e,"Chrome/");case"Firefox":return this.getVersion(e,"Firefox/");case"Silk":return this.getVersion(e,"Silk/");case"AOSP":case"Safari":return this.getVersion(e,"Version/");case"IE":return/IEMobile/.test(e)?this.getVersion(e,"IEMobile/"):/MSIE/.test(e)?this.getVersion(e,"MSIE "):this.getVersion(e,"rv:");case"WebKit":return this.getVersion(e,"WebKit/")}return"0.0.0"}}]),e}();function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function Ur(e){if("object"!==Hr(e))return"";var t=[];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=encodeURIComponent(e[n]);t.push("".concat(n,"=").concat(r))}return t.join("&")}var qr=new(function(){function e(){Ar(this,e),this.buildUrl=function(e,t){var n=Object.prototype.toString.call(t);return t&&"[object Object]"===n?(e=decodeURIComponent(e).indexOf("?")>-1?"".concat(e,"&"):"".concat(e,"?"))+Ur(t):e}}return Rr(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=this.buildUrl(e,t.params),this.http(e,Object.assign(Object.assign({method:"GET"},t),{headers:Object.assign(Object.assign({},{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}),t.headers)}))}},{key:"post",value:function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={Accept:"application/json"},a=t||o.data;return"form"==((null===(n=null==o?void 0:o.headers)||void 0===n?void 0:n["Content-Type"])&&/application\/json/.test(null===(r=null==o?void 0:o.headers)||void 0===r?void 0:r["Content-Type"])?"json":"form")?(i["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",a=Ur(a)):(i["Content-Type"]="application/json;charset=UTF-8",a=a?JSON.stringify(a):null),this.http(e,Object.assign(Object.assign({method:"POST",body:a},o),{headers:Object.assign(Object.assign({},i),o.headers)}))}},{key:"http",value:function(e,t){return new Promise((function(n,r){var o=new XMLHttpRequest,i=t.body,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["body"]);for(var c in o.open(t.method,e),t.headers)Object.prototype.hasOwnProperty.call(t.headers,c)&&o.setRequestHeader(c,t.headers[c]);o.onreadystatechange=function(){if(4===o.readyState){var t={options:a,statusCode:o.status,url:e},i="";try{i=JSON.parse(o.responseText)}catch(e){i=o.responseText}if(/^(2|3)\d{2}$/.test(o.status.toString())){try{n(Object.assign({data:i},t))}catch(e){n(Object.assign({data:i},t))}return}r(Object.assign({data:i},t))}},o.send(i),o.onerror=function(e){throw e}}))}}]),e}()),Yr=0;function Gr(e,t){return(Gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vr(e){return(Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zr(e,t,n){return(zr=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Gr(o,n.prototype),o}).apply(null,arguments)}function Wr(e){var t="function"==typeof Map?new Map:void 0;return(Wr=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return zr(e,arguments,Vr(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Gr(r,e)})(e)}var Kr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gr(e,t)}(n,Wr(Error));var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vr(e);if(t){var o=Vr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!==Hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,n)}}(n);function n(e){var r;return Ar(this,n),(r=t.call(this,e)).name="LinkMonitorError",r.message="[LinkMonitorError]: "+e||"[LinkMonitorError]: Error",r}return n}(),Xr=function(){function e(t,n){var r=this;if(Ar(this,e),this.act="",this.reportNetworkConfig={},this.defaultOptions={},this.bs_queue=0,this.queue=[],this.queueIsRIFScheduled=!1,this.upload=function(e){if(r.queueIsRIFScheduled=!1,e||(e={didTimeout:!0,timeRemaining:function(){return Number.MAX_VALUE}}),(null==e?void 0:e.timeRemaining())>0||r.queue.length>0){var t=r.queue.shift();t&&function(e,t){var n=e.url,r=e.mode,o=e.method,i=e.headers,a=e.onError;if(n&&!(Yr>=5))if("image"!==r)"ajax"!==r||"post"!==o?"ajax"!==r||"get"!==o||qr.get(n,{params:t,headers:i}).catch((function(e){Yr+=1,"function"==typeof a&&a(e),window[window.__sl_console__?"__sl_console__":"console"].log("linkMonitor:",e)})):qr.post(n,t,{headers:i}).catch((function(e){Yr+=1,"function"==typeof a&&a(e),window[window.__sl_console__?"__sl_console__":"console"].log("linkMonitor:",e)}));else try{!function(e,t,n){var r=new Image(1,1),o=Ur(t),i="".concat(e,"?").concat(o);r.onerror=function(){"function"==typeof n&&n(new Error("linkMonitor: fail to get img"))},r.onload=function(){},r.src=i}(n,t,a)}catch(e){Yr+=1,window[window.__sl_console__?"__sl_console__":"console"].log("linkMonitor:",e)}}(t.reportNetworkConfig,t.reportData)}r.queue.length>0&&r.upload()},this.sendBeacon=function(e){!function(e,t){var n=e.url,r=e.onError;if(n&&!(Yr>=5))try{navigator.sendBeacon(e.url,URLSearchParams?new URLSearchParams(t):Ur(t))}catch(e){Yr+=1,"function"==typeof r&&r(e)}}(e.reportNetworkConfig,e.reportData)},!t)throw new Kr("Core class initialization requires the act field");this.act=t,this.reportNetworkConfig=n,this.getDefaultOptions()}return Rr(e,[{key:"updateReportNetworkConfig",value:function(e){this.reportNetworkConfig=Object.assign(Object.assign({},this.reportNetworkConfig),e)}},{key:"getDefaultOptions",value:function(){var e,t=this.act,n={bs_ua:(e=new Fr).ua,bs_os:e.os,bs_os_version:e.os_version,bs_browser:e.browser,bs_browser_version:e.browser_version},r={bs_screen_height:window.screen.height,bs_screen_width:window.screen.width,bs_color_depth:window.screen.colorDepth.toString()},o=window.navigator.javaEnabled().toString(),i=(new Date).getTimezoneOffset().toString(),a=window.navigator.language,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2021-12-08";try{var t=document.createElement("canvas"),n=t.getContext("2d"),r=e;if(!n)return Date.now()+Math.random().toString(36).slice(2);n.textBaseline="top",n.font="14px 'Arial'",n.textBaseline="tencent",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText(r,2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText(r,4,17);var o=t.toDataURL().replace("data:image/png;base64,","");return function(e){var t,n,r,o="";for(t=0,n=(e+="").length;t<n;t++)o+=(r=e.charCodeAt(t).toString(16)).length<2?"0"+r:r;return o}(window.atob(o).slice(-16,-12))}catch(e){return Date.now()+Math.random().toString(36).slice(2)}}();this.defaultOptions=Object.assign(Object.assign(Object.assign({act:t,bs_lib_plugin_version:"1.7.1"},n),r),{bs_java_enabled:o,bs_time_zone_offset:i,bs_language:a,fg:c})}},{key:"getDefaultDynamicOptions",value:function(){var e=Date.now(),t=Math.floor(e/1e3),n=document.title,r=window.location.href,o=document.referrer,i={bs_viewport_height:document.documentElement.offsetHeight||document.body.offsetHeight,bs_viewport_width:document.documentElement.offsetWidth||document.body.offsetWidth},a=i.bs_viewport_height,c=i.bs_viewport_width,s=this.bs_queue++,u=Lr();return{pvId:Nr,time:t,bs_create_time:e,bs_title:n,bs_url:r,bs_referrer:o,bs_viewport_height:a,bs_viewport_width:c,bs_queue:s,bs_uuid:u}}},{key:"send",value:function(e,t){var n=this.getDefaultDynamicOptions(),r=Object.assign(Object.assign(Object.assign(Object.assign({},this.defaultOptions),n),{eventName:e}),t),o=function(e){try{var t="ajax"===e.mode&&"post"===e.method,n=!!e.headers&&Object.keys(e.headers).length>0;return t&&!n&&window.navigator&&"function"==typeof window.navigator.sendBeacon}catch(e){return!1}}(this.reportNetworkConfig),i={reportNetworkConfig:this.reportNetworkConfig,reportData:r};o?this.sendBeacon(i):(this.queue.push(i),this.queueUpload())}},{key:"queueUpload",value:function(){var e,t;this.queueIsRIFScheduled||(this.queueIsRIFScheduled=!0,e=this.upload,t={timeout:2e3},"requestIdleCallback"in window?window.requestIdleCallback(e,t):setTimeout(e,0))}}]),e}(),Jr={debug:!1,url:"",mode:"ajax",method:"post"},$r=function(){function e(t,n){Ar(this,e),this.businessDefaultOptions={version:"0.0.0",environment:"production"},this.act=t,this.options=Object.assign(Object.assign({},Jr),n),this.options.debug&&(this.options.url=Mr),this.fedLog=new Xr(t,{url:this.options.url,mode:this.options.mode,method:this.options.method,headers:this.options.headers})}return Rr(e,[{key:"init",value:function(e,t){t&&this.fedLog.updateReportNetworkConfig(t),this.businessDefaultOptions=Object.assign(Object.assign({},this.businessDefaultOptions),e)}},{key:"report",value:function(e,t){var n=function(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t[n]=r instanceof Object?JSON.stringify(r):r}return t}(t),r=Object.assign(Object.assign({},this.businessDefaultOptions),n);this.fedLog.send(e,r)}}]),e}();function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qr(e){return function(e){if(Array.isArray(e))return Zr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Zr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function to(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function no(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ro(e,t,n){return t&&no(e.prototype,t),n&&no(e,n),e}function oo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ao(e,t,n){return(ao="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=io(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function so(e){return(so="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}"function"!=typeof Object.assign&&(Object.assign=function(e){for(var t=arguments.length,n=1;n<t;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e});var uo=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,lo=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,fo=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,po=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/;function ho(e){return(e&&e.message||"No error message").split("\n").filter((function(e){return!!e}))[0]}function yo(e){try{var t=function(e){if(!e.stack)return null;for(var t,n,r=[],o=e.stack.split("\n"),i=0;i<o.length;++i){if(t=uo.exec(o[i]))n={filename:t[2]&&0===t[2].indexOf("address at ")?t[2].substr("address at ".length):t[2],function:t[1]||"?",lineno:t[3]?+t[3]:null,colno:t[4]?+t[4]:null};else if(t=fo.exec(o[i]))n={filename:t[2],function:t[1]||"?",lineno:+t[3],colno:t[4]?+t[4]:null};else{if(!(t=lo.exec(o[i])))continue;0!==i||t[5]||void 0===e.columnNumber||(r[0].column=e.columnNumber+1),n={filename:t[3],function:t[1]||"?",lineno:t[4]?+t[4]:null,colno:t[5]?+t[5]:null}}!n.function&&n.lineno&&(n.function="?"),r.push(n)}return r.length?{value:ho(e),type:e.name,stacktrace:{frames:r.reverse()}}:null}(e);if(t)return t}catch(e){}return{value:ho(e),type:e&&e.name,stacktrace:{frames:[]}}}var vo=Object.assign||function(e){for(var t=arguments.length,n=1;n<t;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},mo=function(){function e(t){if(to(this,e),t.dsn){var n=po.exec(t.dsn),r=n?n.slice(1):[],o=r[5].split("/"),i=o.slice(0,-1).join("/");this.apiUrl=r[0]+"://"+r[3]+(r[4]?":"+r[4]:"")+(i?"/"+i:"")+"/api/"+o.pop()+"/store/",this.authHeader="Sentry sentry_version=7,sentry_key="+r[1]+(r[2]?",sentry_secret="+r[2]:"")}this.environment=t.environment}return ro(e,[{key:"prepare",value:function(e){return vo(this.getRequestBlank(),{exception:{values:[yo(e)]}})}},{key:"report",value:function(e){this.send(this.prepare(e))}},{key:"send",value:function(e){if(this.apiUrl){var t=new XMLHttpRequest;t.open("POST",this.apiUrl,!0),t.setRequestHeader("Content-type","application/json"),t.setRequestHeader("X-Sentry-Auth",this.authHeader||""),t.send(JSON.stringify(e))}}},{key:"getRequestBlank",value:function(){return{platform:"javascript",sdk:{name:"micro-sentry.javascript.browser",version:"0.0.0"},timestamp:Date.now()/1e3,request:{url:window.location.toString(),headers:{"User-Agent":window.navigator.userAgent}},environment:this.environment}}}]),e}();function go(e,t){return"[object RegExp]"===Object.prototype.toString.call(t)?t.test(e):"string"==typeof t&&-1!==e.indexOf(t)}var bo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(n,mo);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=io(e);if(t){var o=io(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!==so(t)&&"function"!=typeof t?oo(e):t}(this,n)}}(n);function n(e){var r;to(this,n),(r=t.call(this,e)).options=e,r.destroyed=!1,r._state={};var o=r.options||{},i=o.plugins,a=void 0===i?[]:i,c=o.beforeSend,s=void 0===c?function(e){return e}:c,u=o.beforeBreadcrumb,l=void 0===u?function(e){return e}:u,d=o.blacklistUrls,f=void 0===d?[]:d,p=o.ignoreErrors,h=void 0===p?[]:p,y=o.release,v=void 0===y?void 0:y;return r.plugins=a.map((function(e){return new e(oo(r))})),r.beforeSend=s,r.beforeBreadcrumb=l,r.blacklistUrls=f,r.ignoreErrors=h,r.release=v,r}return ro(n,[{key:"state",get:function(){return this._state}},{key:"clearState",value:function(){this._state={}}},{key:"setTags",value:function(e){return this.setKeyState("tags",Object.assign({},e)),this}},{key:"setTag",value:function(e,t){return this.extendState({tags:eo({},e,t)}),this}},{key:"setExtra",value:function(e,t){return this.extendState({extra:eo({},e,t)}),this}},{key:"setExtras",value:function(e){return this.setKeyState("extra",Object.assign({},e)),this}},{key:"setUser",value:function(e){return this.setKeyState("user",Object.assign({},e)),this}},{key:"clone",value:function(){var e=new n(Object.assign(Object.assign({},this.options),{plugins:[]}));return e.extendState(this.state),e}},{key:"withScope",value:function(e){var t=this.clone();e(t),t.destroy(),this.setBreadcrumbs(void 0)}},{key:"addBreadcrumb",value:function(e){this.extendState({breadcrumbs:[Object.assign({timestamp:Date.now()/1e3},this.beforeBreadcrumb(e))]})}},{key:"setBreadcrumbs",value:function(e){this.setKeyState("breadcrumbs",e)}},{key:"captureMessage",value:function(e,t){this.send(Object.assign(Object.assign({},this.getRequestBlank()),{message:e,level:t}))}},{key:"destroy",value:function(){this.destroyed=!0,this.plugins.forEach((function(e){e.destroy&&e.destroy()}))}},{key:"isIgnoredError",value:function(e){var t=this;return!!this.ignoreErrors.length&&this.getPossibleEventMessages(e).some((function(e){return t.ignoreErrors.some((function(t){return go(e,t)}))}))}},{key:"getRequestBlank",value:function(){return Object.assign(Object.assign({},ao(io(n.prototype),"getRequestBlank",this).call(this)),this.state)}},{key:"send",value:function(e){this.destroyed||this.isDeniedUrl(e)||this.isIgnoredError(e)||(ao(io(n.prototype),"send",this).call(this,this.beforeSend(Object.assign({release:this.release},e))),this.setBreadcrumbs(void 0))}},{key:"getPossibleEventMessages",value:function(e){if(e.message)return[e.message];if(e.exception)try{var t=e.exception.values&&e.exception.values[0]||{},n=t.type,r=void 0===n?"":n,o=t.value,i=void 0===o?"":o;return["".concat(i),"".concat(r,": ").concat(i)]}catch(e){return[]}return[]}},{key:"isDeniedUrl",value:function(e){if(!this.blacklistUrls.length)return!1;var t=this.getEventFilterUrl(e);return!!t&&this.blacklistUrls.some((function(e){return go(t,e)}))}},{key:"getEventFilterUrl",value:function(e){try{if(e.exception){var t=e.exception.values&&e.exception.values[0].stacktrace&&e.exception.values[0].stacktrace.frames;return t&&t[t.length-1].filename||null}return null}catch(e){return null}}},{key:"extendState",value:function(e){var t=this;this._state=Object.keys(e).reduce((function(n,r){var o=t.state[r],i=Array.isArray(o)?o:null,a=e[r],c=Array.isArray(a)?a:null;return Object.assign(Object.assign({},n),eo({},r,i||c?[].concat(Qr(i||[]),Qr(c||[])):Object.assign(Object.assign({},"string"!=typeof o?o:{}),"string"!=typeof a?a:{})))}),{})}},{key:"setKeyState",value:function(e,t){this._state[e]=t}}]),n}();function wo(e,t,n){var r=e[t],o=n(r);if("function"==typeof o)try{o.prototype=o.prototype||{},Object.defineProperties(o,{__original__:{enumerable:!1,value:r}})}catch(e){}e[t]=o}function _o(e){if(!e)return{};var t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+n+r}}function Oo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return"Request"in window&&e[0]instanceof Request&&e[0].method?String(e[0].method).toUpperCase():e[1]&&e[1].method?String(e[1].method).toUpperCase():"GET"}function Co(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return"string"==typeof e[0]?e[0]:"Request"in window&&e[0]instanceof Request?e[0].url:String(e[0])}function ko(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function So(e){var t=e,n=[];if(!t||!t.tagName)return"";n.push(t.tagName.toLowerCase()),t.id&&n.push("#".concat(t.id));var r=t.className;if(r&&"string"==typeof r){var o=r.split(/\s+/);n.concat(o.map((function(e){return".".concat(e)})))}return["type","name","title","alt","automation-id"].forEach((function(e){var r=t.getAttribute(e);r&&n.push("[".concat(e,'="').concat(r,'"]'))})),n.join("")}function Eo(e){try{for(var t,n=e,r=[],o=0,i=0,a=" > ".length;n&&o++<5&&!("html"===(t=So(n))||o>1&&i+r.length*a+t.length>=80);)r.push(t),i+=t.length,n=n.parentNode;return r.reverse().join(" > ")}catch(e){return"<unknown>"}}function Po(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return Array.isArray(e)?e.map((function(e){try{return String(e)}catch(e){return""}})).filter((function(e){return""!==e})).join(t):""}function Io(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function xo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Io(i,r,o,a,c,"next",e)}function c(e){Io(i,r,o,a,c,"throw",e)}a(void 0)}))}}function To(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ao(e,t,n){return t&&jo(e.prototype,t),n&&jo(e,n),e}function Lo(e,t){return(Lo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Do(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lo(e,t)}function No(e){return(No="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function Bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ro(e,t){return!t||"object"!==No(t)&&"function"!=typeof t?Bo(e):t}function Mo(e){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ro((function e(t){to(this,e),this.client=t,this.subscriptions=[],this.initDOM(),this.initConsole(),this.initFetch(),this.initHistory(),this.initXHR()}),[{key:"initXHR",value:function(){if("XMLHttpRequest"in window){var e=this,t=XMLHttpRequest.prototype;wo(t,"open",(function(t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var i=this,a=r[1];i.__sentry_xhr__={method:"string"==typeof r[0]?r[0].toUpperCase():r[0],url:r[1]},"string"==typeof a&&"POST"===i.__sentry_xhr__.method&&a.match(/sentry_key/)&&(i.__sentry_own_request__=!0);var c=function(){if(4===i.readyState){try{i.__sentry_xhr__&&(i.__sentry_xhr__.status_code=i.status)}catch(e){}e.xhrBreadcrumb({args:r,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:i})}};return"onreadystatechange"in i&&"function"==typeof i.onreadystatechange?wo(i,"onreadystatechange",(function(e){return function(){c();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.apply(i,n)}})):i.addEventListener("readystatechange",c),t.apply(i,r)}})),wo(t,"send",(function(t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.xhrBreadcrumb({args:r,startTimestamp:Date.now(),xhr:this}),t.apply(this,r)}}))}}},{key:"initHistory",value:function(){var e=this,t=window.onpopstate;function n(t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var i=r.length>2?r[2]:void 0;if(i){var a=e.lastHref,c=String(i);e.lastHref=c,e.historyBreadcrumb({from:a,to:c})}return t.apply(this,r)}}window.onpopstate=function(){var n=window.location.href,r=e.lastHref;if(e.lastHref=n,e.historyBreadcrumb({from:r,to:n}),t){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return t.apply(this,i)}},wo(window.history,"pushState",n),wo(window.history,"replaceState",n)}},{key:"destroy",value:function(){this.subscriptions.forEach((function(e){return e()}))}},{key:"initDOM",value:function(){var e=this,t=function(t){return e.prepareDomEvent("click",t)},n=function(t){return e.prepareDomEvent("keypress",t)};window.document.addEventListener("click",t,!1),window.document.addEventListener("keypress",n,!1),this.subscriptions.push((function(){window.document.removeEventListener("click",t,!1),window.document.removeEventListener("keypress",n,!1)}))}},{key:"prepareDomEvent",value:function(e,t){var n;try{n=t.target?Eo(t.target):Eo(t)}catch(e){n="<unknown>"}0!==n.length&&this.client.addBreadcrumb({category:"ui.".concat(e),message:n})}},{key:"initFetch",value:function(){var e=this;(function(){if(!function(){if(!("fetch"in window))return!1;try{return new Headers,new Request(""),new Response,!0}catch(e){return!1}}())return!1;if(ko(window.fetch))return!0;var e=!1,t=window.document;if(t&&"function"==typeof t.createElement)try{var n=t.createElement("iframe");n.sandbox.add("allow-scripts"),n.sandbox.add("allow-same-origin"),n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=ko(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){}return e})()&&wo(window,"fetch",(function(t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var i={args:r,fetchData:{method:Oo(r),url:Co(r)},startTimestamp:Date.now()};return e.fetchBreadcrumb(Object.assign({},i)),t.apply(window,r).then((function(t){return e.fetchBreadcrumb(Object.assign(Object.assign({},i),{endTimestamp:Date.now(),response:t})),t}),(function(t){throw e.fetchBreadcrumb(Object.assign(Object.assign({},i),{endTimestamp:Date.now(),error:t})),t}))}}))}},{key:"fetchBreadcrumb",value:function(e){e.endTimestamp&&(e.fetchData.url.match(/sentry_key/)&&"POST"===e.fetchData.method||(e.error?this.client.addBreadcrumb({category:"fetch",data:e.fetchData,level:"error",type:"http"}):this.client.addBreadcrumb({category:"fetch",data:Object.assign(Object.assign({},e.fetchData),{status_code:e.response.status}),type:"http"})))}},{key:"xhrBreadcrumb",value:function(e){if(e.endTimestamp){if(e.xhr.__sentry_own_request__)return;this.client.addBreadcrumb({category:"xhr",data:e.xhr.__sentry_xhr__,type:"http"})}}},{key:"initConsole",value:function(){var e=this;["debug","info","warn","error","log","assert"].forEach((function(t){t in window[window.__sl_console__?"__sl_console__":"console"]&&wo(window[window.__sl_console__?"__sl_console__":"console"],t,(function(n){return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a={category:"console",data:{arguments:o.map((function(e){try{return JSON.stringify(e),e}catch(t){return Object.prototype.toString.call(e)}})),logger:"console"},level:t,message:Po(o," ")};if("assert"===t){if(!1!==o[0])return;a.message="Assertion failed: ".concat(Po(o.slice(1)," ")||"console.assert"),a.data.arguments=o.slice(1)}e.client.addBreadcrumb(a),n&&Function.prototype.apply.call(n,window[window.__sl_console__?"__sl_console__":"console"],o)}}))}))}},{key:"historyBreadcrumb",value:function(e){var t=e.from,n=e.to,r=_o(window.location.href),o=_o(t),i=_o(n);o.path||(o=r),r.protocol===i.protocol&&r.host===i.host&&(n=i.relative),r.protocol===o.protocol&&r.host===o.host&&(t=o.relative),this.client.addBreadcrumb({category:"navigation",data:{from:t,to:n}})}}]);var Ho={};!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(e,t,n){var r=d;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?h:f,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=h,n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",y={};function v(){}function m(){}function g(){}var b={};b[i]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(x([])));_&&_!==n&&r.call(_,i)&&(b=_);var O=g.prototype=v.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,c){var s=l(e[o],e,i);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==N(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=l(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:T}}function T(){return{value:t,done:!0}}return m.prototype=O.constructor=g,g.constructor=m,m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,c,"GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},C(k.prototype),k.prototype[a]=function(){return this},e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(O),s(O,c,"Generator"),O[i]=function(){return this},O.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}(Ho);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}();var Uo,qo,Yo,Go,Vo=Ho;function zo(e,t,n){return(zo=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Lo(o,n.prototype),o}).apply(null,arguments)}function Wo(e){var t="function"==typeof Map?new Map:void 0;return(Wo=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return zo(e,arguments,Mo(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Lo(r,e)})(e)}function Ko(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mo(e);if(t){var o=Mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ro(this,n)}}!function(e){e.NotSupportBrowser="1026",e.InnerSDKError="1027",e.RenderFail="1028",e.NetworkError="1109",e.FrequentRequest="1904",e.AbnormalTrade="4205"}(Uo||(Uo={})),function(e){e.AbnormalTrade="TRANSACTION_ABNORMAL",e.NetworkError="Network error"}(qo||(qo={})),function(e){e.Fatal="fatal",e.Error="error"}(Yo||(Yo={})),function(e){e.IframeError="PciIframeError",e.NoDom="NoDomError"}(Go||(Go={}));var Xo=function(e){Do(n,Wo(Error));var t=Ko(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uo.InnerSDKError,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"UnknownError",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Yo.Error;return To(this,n),Fo(Bo(r=t.call(this,e)),"code",void 0),Fo(Bo(r),"isReported",!1),Fo(Bo(r),"data",void 0),Fo(Bo(r),"errorLevel",void 0),r.name=i,r.code=o,r.errorLevel=a,r}return Ao(n,[{key:"setIsReported",value:function(){this.isReported=!0}}]),n}(),Jo=function(e){Do(n,Xo);var t=Ko(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uo.InnerSDKError,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"SilenceError",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Yo.Error;return To(this,n),Fo(Bo(r=t.call(this,e,o,i,a)),"statusCode",void 0),r}return n}();function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qo=new bo({dsn:"https://820fe9124d6a4b4d8ef0ee1e44a29c4b@sentry-new.myshopline.com/305",release:"3.6.1",environment:"production",beforeSend:function(e){return e}});function ei(e,t){var n=JSON.stringify(Zo(Zo({},e||{}),{},{originErrorMessage:null==t?void 0:t.message,originErrorData:t?JSON.stringify(t):void 0,errorLevel:(null==t?void 0:t.errorLevel)||(null==e?void 0:e.errorLevel)||Yo.Error})),r=new Error(n);if(null!=t&&t.stack)try{r.stack=t.stack}catch(e){Qo.report(e),Qo.report(t)}Qo.report(r)}function ti(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e?function(e,t){for(var n="",r=0;r<t;r++)n+="*";return n}(0,t)+e.slice(t):e}function ni(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ri(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ni(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ni(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oi,ii,ai,ci,si=new $r("webpaymentsdk"),ui=function(){function e(){To(this,e)}return Ao(e,null,[{key:"init",value:function(e){si.init({projectName:"pcisdk",environment:"production",version:"3.6.1"},e.eventTrackingConfig),Qo.setTag("pvId",Nr)}},{key:"setHost",value:function(e){Qo.setTag("host",e)}},{key:"reportError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"report_error",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof Jo||e.name===Go.IframeError||(e instanceof Xo?e.isReported||(ei(ri({eventName:t},n),e),e.setIsReported()):ei(ri({eventName:t},n),e))}},{key:"handleError",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pci_sdk_default_error",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.reportData(n,ri(ri({},t),r)),e.reportError(t,n,r),t instanceof Jo||t instanceof Xo)throw t;var o="".concat(n," ").concat(t.message||"pci sdk inner error"),i=new Jo(o);throw i.statusCode=t.statusCode,i.name=t.name||"Error",i.code=t.code||i.code,i.errorLevel=t.errorLevel||Yo.Error,i.data=ri({code:Uo.InnerSDKError,msg:o},t.data||{}),i}},{key:"formatReportData",value:function(e){if(!e)return{};var t=ri({},e);return t.customerToken&&(t.customerToken=ti(t.customerToken,30)),t.payToken&&(t.payToken=ti(t.payToken,10)),t}},{key:"reportData",value:function(t,n){try{si.report(t,n?{extraData:JSON.stringify(n)}:{})}catch(r){e.reportError(r,"".concat(t,"_report_data_error"),n)}}},{key:"reportErrorData",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yo.Error;e.reportData(t,n),ei(ri({eventName:t,errorLevel:r},n))}}]),e}();!function(e){e.Redirect="Redirect",e.Confirm="Confirm",e.QrCode="QrCode",e.WorldPayGather="WorldPayGather",e.ExchangeTicket="ExchangeTicket"}(oi||(oi={})),function(e){e.Success="success",e.Fail="fail"}(ii||(ii={})),function(e){e.Number="number",e.Cvc="cvc",e.FirstName="firstName",e.ExpDate="expDate"}(ai||(ai={})),function(e){e.Hidden="hidden-iframe",e.Cache="cache-iframe"}(ci||(ci={})),ai.Number,ai.Cvc,ai.ExpDate;var li,di,fi,pi,hi=[ai.Number,ai.Cvc,ai.ExpDate,ai.FirstName];function yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yi(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(li||(li={})).CN="CN",function(e){e.SL2="shopline2",e.SLP="slp"}(di||(di={})),function(e){e.validate="getValidate",e.pay="pay",e.getBeforePayData="getBeforePayData",e.getCardToken="getCardToken",e.updateCardToken="updateCardToken",e.getCurrentCardInfo="getCurrentCardInfo",e.getCardTokenInfoByCardToken="getCardTokenInfoByCardToken"}(fi||(fi={})),function(e){e.validate="validate",e.pay="payResult",e.getBeforePayData="getBeforePayData",e.getCardToken="cardTokenResult",e.updateCardToken="updateCardTokenResult",e.getCurrentCardInfo="cardInfoResult",e.getCardTokenInfoByCardToken="getCardTokenInfoByCardTokenResult"}(pi||(pi={}));var mi=function(){function e(t){var n=this,r=t.uuid,o=t.host,i=t.channelId,a=t.env,c=t.receiveMessageHandler;To(this,e),Fo(this,"uuid",void 0),Fo(this,"iframeHost","https://cashiers.myshopline.com"),Fo(this,"isDev",!1),Fo(this,"env",void 0),Fo(this,"config",{}),Fo(this,"channelId",void 0),Fo(this,"mainIframe",ai.Number),Fo(this,"receiveMessageHandler",void 0),Fo(this,"onIframeLoaded",(function(e){var t=e.name,r=e.mainIframe,o=e.displayFieldNames,i=n.config.placeholder;n.postToIframe(t,"initData",{pvId:Nr,env:n.env,mainIframe:r,displayFieldNames:o,parentUrl:window.location.href,parentOrigin:window.location.origin,channelId:n.channelId}),i&&i[t]&&n.postToIframe(t,"setAttr",{attr:{placeholder:i[t]}})})),this.uuid=r,this.channelId=i,this.env=a,this.receiveMessageHandler=c,o&&!this.isDev&&(this.iframeHost=o)}return Ao(e,[{key:"setConfig",value:function(e){this.config=e}},{key:"setIframeStatus",value:function(e){this.mainIframe=e.mainIframe}},{key:"handleApi",value:function(e,t,n){var r=this,o=fi[e];return ui.reportData("pci_sdk_".concat(o,"_start"),{eventData:null!=t&&t.nextAction?vi(vi({},t),{},{nextAction:ui.formatReportData(t.nextAction)}):t}),new Promise((function(n,i){r.receiveMessageHandler.setApiHandlerMap(e,n,i),r.postToMainIframe(o,t)})).then((function(e){var t=n?n(e):{result:e};return ui.reportData("pci_sdk_".concat(o,"_end"),t),e})).catch((function(e){return ui.handleError(e,"pci_sdk_".concat(o,"_error"))}))}},{key:"handleApiWithKey",value:function(e,t,n){var r=this,o=fi[e];return ui.reportData("pci_sdk_".concat(o,"_start"),{eventData:t?t(""):void 0}),new Promise((function(n,i){var a=r.receiveMessageHandler.setApiHandlerMapWithKey(e,n,i),c=t?t(a):void 0;r.postToMainIframe(o,c)})).then((function(e){var t=e.key,r=e.result,i=n?n({key:t,result:r}):{key:t,result:r};return ui.reportData("pci_sdk_".concat(o,"_end"),i),r})).catch((function(e){return ui.handleError(e,"pci_sdk_".concat(o,"_error"))}))}},{key:"postToMainIframe",value:function(e,t){this.postToIframe(this.mainIframe,e,t)}},{key:"postToIframe",value:function(e,t,n){var r,o=vi({eventType:t,uuid:this.uuid},n||{}),i="".concat(e).concat(this.uuid);(null===(r=window.frames[i])||void 0===r?void 0:r.postMessage)&&window.frames[i].postMessage(o,this.iframeHost)}}]),e}(),gi=function(){var e=xo(Vo.mark((function e(t){return Vo.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e()}),t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bi=function(){function e(t){var n=t.uuid,r=t.host,o=t.receiveMessageHandler,i=t.cdn;To(this,e),Fo(this,"uuid",void 0),Fo(this,"iframePath","https://cashiers.myshopline.com/pci-sdk"),Fo(this,"innerDisplayIframeNames",[]),Fo(this,"cdn",void 0),Fo(this,"renderIframeDomMap",{}),Fo(this,"innerMainIframe",ai.Number),Fo(this,"receiveMessageHandler",void 0),Fo(this,"destroyed",!1),Fo(this,"isDev",!1),this.uuid=n,this.receiveMessageHandler=o,r&&!this.isDev&&(this.iframePath="".concat(r,"/pci-sdk")),this.cdn=i,this.createCacheIframe()}var t;return Ao(e,[{key:"displayIframeNames",get:function(){return this.innerDisplayIframeNames}},{key:"mainIframe",get:function(){return this.innerMainIframe}},{key:"mountIframe",value:function(e,t,n,r){if(!e)throw new Xo("Can't find the related dom node to mount the iframe",Uo.InnerSDKError,Go.NoDom);var o=document.createElement("iframe");o.onload=r,o.src=n,o.name=t,o.id=t,o.style.width="100%",o.style.height="100%",o.style.border="none",e.innerHTML="",e.appendChild(o)}},{key:"getIframeLink",value:function(e){var t=this.isDev?"":"v".concat("3.6.1".split(".")[0],"/");return"".concat(this.iframePath,"/").concat(t,"iframe").concat(this.cdn===li.CN?"-oss":"",".html#name=").concat(e,"&uuid=").concat(this.uuid)}},{key:"createHiddenMountDom",value:function(e){var t=document.createElement("div");return t.setAttribute("data-pci",e),t.setAttribute("style","display: none !important"),t.hidden=!0,document.body.appendChild(t),t}},{key:"doRenderIframe",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.destroyed||e.forEach((function(e){n.mountIframe(n.renderIframeDomMap[e],"".concat(e).concat(n.uuid),n.getIframeLink(e),(function(){return t({name:e,mainIframe:n.innerMainIframe,displayFieldNames:r})}))}))}},{key:"createHiddenIframeDom",value:function(e){var t=ci.Hidden,n=this.createHiddenMountDom(t);this.innerDisplayIframeNames.push(t),this.renderIframeDomMap[t]=n,this.innerMainIframe=t,this.doRenderIframe(this.innerDisplayIframeNames,e),this.startIframeReloadTiming(e)}},{key:"createCacheIframe",value:function(){var e=ci.Cache,t=document.querySelector("div[data-pci=".concat(e,"]"));if(!t||!t.querySelector("iframe[id=".concat(e,"]"))){var n=this.createHiddenMountDom(e);this.mountIframe(n,e,this.getIframeLink(e),(function(){ui.reportData("pci_sdk_cache_iframe_onload")}))}}},{key:"renderIframe",value:function(e,t){var n=this,r=[];if(e.querySelectorAll("[data-pci]").forEach((function(e,t){var o=e.getAttribute("data-pci");0!==t&&o!==ai.Number||(n.innerMainIframe=o),hi.indexOf(o)>-1&&(n.innerDisplayIframeNames.push(o),n.renderIframeDomMap[o]=e,r.push(o))})),0===this.innerDisplayIframeNames.length)throw new Xo("Can't find any dom node to mount the iframe",Uo.InnerSDKError,Go.NoDom);this.doRenderIframe(this.innerDisplayIframeNames,t,r),this.startIframeReloadTiming(t,r)}},{key:"startIframeReloadTiming",value:(t=xo(Vo.mark((function e(t){var n,r,o,i,a,c=this,s=arguments;return Vo.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=s.length>1&&void 0!==s[1]?s[1]:[],r=3,o=Vo.mark((function e(o){var i,a;return Vo.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.destroyed){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:return e.next=4,gi(15e3);case 4:if(!c.destroyed){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(i=c.receiveMessageHandler.getIframeLoadedStatus(),a=Object.keys(i).filter((function(e){return!i[e]})),ui.reportData("pci_sdk_check_iframe_status",{loadFailIframeNames:a}),a.length){e.next=13;break}return e.abrupt("return",{v:void 0});case 13:if(!(o<r-1)){e.next=19;break}ui.reportData("pci_sdk_reload_iframe"),a.forEach((function(e){var t=c.renderIframeDomMap[e];t&&(t.innerHTML="")})),c.doRenderIframe(a,t,n),e.next=23;break;case 19:return c.unmountIframe(),c.receiveMessageHandler.triggerEvent("onError",{}),ui.reportError(new Error("failed to load iframe"),"pci_sdk_load_iframe_failed"),e.abrupt("return",{v:void 0});case 23:case"end":return e.stop()}}),e)})),i=0;case 4:if(!(i<r)){e.next=12;break}return e.delegateYield(o(i),"t0",6);case 6:if("object"!==No(a=e.t0)){e.next=9;break}return e.abrupt("return",a.v);case 9:i++,e.next=4;break;case 12:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"unmountDom",value:function(e){if(e){var t=this.renderIframeDomMap[e];t&&(ui.reportData("pci_sdk_unmount_dom",{name:e}),e===ci.Hidden?t.parentNode.removeChild(t):t.innerHTML="",this.renderIframeDomMap[e]=null)}}},{key:"unmountIframe",value:function(){var e=this;ui.reportData("pci_sdk_unmount_iframe"),this.innerDisplayIframeNames.forEach((function(t){return e.unmountDom(t)}))}},{key:"destroy",value:function(){this.destroyed=!0,this.unmountIframe()}}]),e}();function wi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var _i,Oi,Ci=function(){function e(t){var n,r=this;To(this,e),Fo(this,"uuid",void 0),Fo(this,"config",void 0),Fo(this,"iframeLoaded",{}),Fo(this,"ApiHandlerMap",{}),Fo(this,"ReceiveMessageHandler",(Fo(n={loadFinished:function(e){r.iframeLoaded[e.name]=!0,ui.reportData("pci_sdk_iframe_loadFinished",e),Object.keys(r.iframeLoaded).every((function(e){return r.iframeLoaded[e]}))&&(ui.reportData("pci_sdk_onInit"),r.triggerEvent("onInit",{}))},focus:function(e){r.triggerEvent("onFocus",{fieldName:e.name,isEmpty:e.isEmpty,isFocus:e.isFocus})},input:function(e){r.triggerEvent("onFieldValidChange",{fieldName:e.name,isValid:e.isValid,isEmpty:e.isEmpty})},cardBinChange:function(e){r.triggerEvent("onCardBinChange",e.value)}},pi.validate,(function(e){ui.reportData("pci_sdk_validate_credit_card_cache",e.reportData),r.resolveApiHandler("validate",e.isValid)})),Fo(n,pi.pay,(function(e){ui.reportData("pci_sdk_pay_credit_card_cache",e.reportData),e.status===ii.Success?r.resolveApiHandler("pay",e.value):r.rejectApiHandler("pay",e.value)})),Fo(n,pi.getBeforePayData,(function(e){r.resolveApiHandler("getBeforePayData",e.value)})),Fo(n,pi.getCardToken,(function(e){var t=(e.extraOptions||{}).key;t&&(e.status===ii.Success?r.resolveApiHandlerWithKey("getCardToken",e.value,t):r.rejectApiHandlerWithKey("getCardToken",e.value,t))})),Fo(n,pi.updateCardToken,(function(e){var t=(e.extraOptions||{}).key;t&&(e.status===ii.Success?r.resolveApiHandlerWithKey("updateCardToken",e.value,t):r.rejectApiHandlerWithKey("updateCardToken",e.value,t))})),Fo(n,pi.getCardTokenInfoByCardToken,(function(e){var t=(e.extraOptions||{}).key;t&&(e.status===ii.Success?r.resolveApiHandlerWithKey("getCardTokenInfoByCardToken",e.value,t):r.rejectApiHandlerWithKey("getCardTokenInfoByCardToken",e.value,t))})),Fo(n,pi.getCurrentCardInfo,(function(e){e.status===ii.Success?r.resolveApiHandler("getCurrentCardInfo",e.value):r.rejectApiHandler("getCurrentCardInfo",e.value)})),n)),this.uuid=t}return Ao(e,[{key:"init",value:function(e,t){var n=this;this.config=t,e.forEach((function(e){return n.iframeLoaded[e]=!1})),this.listenMessage()}},{key:"getIframeLoadedStatus",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wi(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.iframeLoaded)}},{key:"listenMessage",value:function(){var e=this;window.addEventListener("message",(function(t){var n=t.data,r=n.uuid,o=n.eventType;r===e.uuid&&e.ReceiveMessageHandler[o]&&e.ReceiveMessageHandler[o](t.data)}))}},{key:"setApiHandlerMap",value:function(e,t,n){this.ApiHandlerMap[e]={resolve:t,reject:n}}},{key:"setApiHandlerMapWithKey",value:function(e,t,n){var r=((new Date).getTime()+Math.floor(Math.random()*Math.pow(10,13))).toString();return this.ApiHandlerMap[e]||(this.ApiHandlerMap[e]={}),this.ApiHandlerMap[e][r]={resolve:t,reject:n},r}},{key:"resolveApiHandler",value:function(e,t){var n;(null===(n=this.ApiHandlerMap[e])||void 0===n?void 0:n.resolve)&&this.ApiHandlerMap[e].resolve(t)}},{key:"rejectApiHandler",value:function(e,t){var n;(null===(n=this.ApiHandlerMap[e])||void 0===n?void 0:n.reject)&&this.ApiHandlerMap[e].reject(t)}},{key:"resolveApiHandlerWithKey",value:function(e,t,n){var r,o;null!==(r=this.ApiHandlerMap[e])&&void 0!==r&&null!==(o=r[n])&&void 0!==o&&o.resolve&&(this.ApiHandlerMap[e][n].resolve({key:n,result:t}),delete this.ApiHandlerMap[e][n])}},{key:"rejectApiHandlerWithKey",value:function(e,t,n){var r,o;null!==(r=this.ApiHandlerMap[e])&&void 0!==r&&null!==(o=r[n])&&void 0!==o&&o.reject&&(this.ApiHandlerMap[e][n].reject(t),delete this.ApiHandlerMap[e][n])}},{key:"triggerEvent",value:function(e,t){try{this.config[e]&&this.config[e](t)}catch(n){ui.handleError(n,"pci_sdk_triggerEvent_".concat(e,"_error"),t)}}}]),e}();!function(e){e.Test1="test1",e.Test2="test2",e.Test3="test3",e.Alpha="alpha",e.Prod="prod"}(_i||(_i={}));var ki=(Fo(Oi={},_i.Test1,{host:"https://cashiers-test1.myshoplinestg.com"}),Fo(Oi,_i.Test2,{host:"https://cashiers-test2.myshoplinestg.com"}),Fo(Oi,_i.Test3,{host:"https://cashiers-test3.myshoplinestg.com"}),Fo(Oi,_i.Alpha,{host:"https://cashiers-alpha.myshopline.com"}),Fo(Oi,_i.Prod,{host:"https://cashiers.myshopline.com"}),Oi);function Si(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pi=function(){function e(t){To(this,e),Fo(this,"apiInstance",void 0),Fo(this,"iframeInstance",void 0),Fo(this,"receiveMessageInstance",void 0),Fo(this,"cardToken",void 0),Fo(this,"config",void 0),this.initReporter(t);try{var n;ui.reportData("pci_sdk_constructor_start",ui.formatReportData(t));var r=(null===(n=ki[t.env])||void 0===n?void 0:n.host)||"";ui.setHost(r);var o=(i=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"===e?t:3&t|8).toString(16)})));this.cardToken=t.cardToken,this.receiveMessageInstance=new Ci(o),this.apiInstance=new mi({uuid:o,host:r,channelId:null==t?void 0:t.channelId,env:t.env,receiveMessageHandler:this.receiveMessageInstance}),this.iframeInstance=new bi({uuid:o,host:r,receiveMessageHandler:this.receiveMessageInstance,cdn:t.cdn}),ui.reportData("pci_sdk_constructor_end")}catch(e){ui.handleError(e,"pci_sdk_constructor_error")}var i}var t;return Ao(e,[{key:"initReporter",value:function(e){try{ui.init(e)}catch(e){ui.handleError(e,"pci_sdk_init_reporter_error")}}},{key:"update",value:(t=xo(Vo.mark((function e(){var t,n=arguments;return Vo.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:{},ui.reportData("pci_sdk_update_start",ui.formatReportData(t)),t.cardToken&&(this.cardToken=t.cardToken),ui.reportData("pci_sdk_update_end");case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setConfig",value:function(e){this.apiInstance.setConfig(e)}},{key:"getCardToken",value:function(e){return this.apiInstance.handleApiWithKey("getCardToken",(function(t){return{options:e,extraOptions:{key:t}}}),(function(t){var n=t.key,r=t.result;return Ei(Ei({},e),{},{token:(r.token||"").slice(-6),key:n})}))}},{key:"checkCardToken",value:function(){if(!this.cardToken)return ui.handleError(new Xo("Empty CardToken",Uo.InnerSDKError,"EmptyCardToken"),"pci_sdk_getCardTokenInfoByCardToken_empty_cardToken_error")}},{key:"getCardTokenInfoByCardToken",value:function(e){var t=this;return this.checkCardToken(),this.apiInstance.handleApiWithKey("getCardTokenInfoByCardToken",(function(n){return{options:Ei(Ei({},e),{},{token:t.cardToken}),extraOptions:{key:n}}}),(function(t){var n=t.key,r=t.result;return Ei(Ei({},e),{},{token:ti(r.token),key:n})}))}},{key:"pay",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.apiInstance.handleApi("pay",{nextAction:e,requestParams:Ei(Ei({},t),{},{cardToken:this.cardToken})})}},{key:"destroy",value:function(){try{ui.reportData("pci_sdk_destroy_start"),this.iframeInstance.destroy(),ui.reportData("pci_sdk_destroy_end")}catch(e){ui.handleError(e,"pci_sdk_destroy_error")}}}]),e}(),Ii=function(e){Do(n,Pi);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mo(e);if(t){var o=Mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ro(this,n)}}(n);function n(){return To(this,n),t.apply(this,arguments)}return Ao(n,[{key:"create",value:function(e){try{ui.reportData("api_only_pci_sdk_create_start"),this.config=e,this.setConfig(e),this.iframeInstance.createHiddenIframeDom(this.apiInstance.onIframeLoaded),this.receiveMessageInstance.init(this.iframeInstance.displayIframeNames,this.config),this.apiInstance.setIframeStatus({mainIframe:this.iframeInstance.mainIframe}),ui.reportData("api_only_pci_sdk_create_end")}catch(e){ui.handleError(e,"api_only_pci_sdk_create_error")}}}]),n}();function xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xi(Object(n),!0).forEach((function(t){Fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ji=function(e){Do(r,Pi);var t,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mo(e);if(t){var o=Mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ro(this,n)}}(r);function r(){return To(this,r),n.apply(this,arguments)}return Ao(r,[{key:"create",value:function(e){try{ui.reportData("pci_sdk_create_start",{config:e}),this.config=e,this.apiInstance.setConfig(e),ui.reportData("pci_sdk_create_end")}catch(e){ui.handleError(e,"pci_sdk_create_error")}}},{key:"mount",value:function(e){try{ui.reportData("pci_sdk_mount_start");var t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Xo("Can't find the mount dom",Uo.InnerSDKError,Go.NoDom);this.iframeInstance.renderIframe(t,this.apiInstance.onIframeLoaded),this.receiveMessageInstance.init(this.iframeInstance.displayIframeNames,this.config),this.apiInstance.setIframeStatus({mainIframe:this.iframeInstance.mainIframe}),ui.reportData("pci_sdk_mount_end",{displayIframeNames:this.iframeInstance.displayIframeNames,mainIframe:this.iframeInstance.mainIframe})}catch(e){ui.handleError(e,"pci_sdk_mount_error")}}},{key:"setStyle",value:function(e){try{ui.reportData("pci_sdk_setStyle_start",{params:e});var t=e.type,n=e.fieldName,r=e.style;this.apiInstance.postToIframe(n,"setStyle",{style:r,type:t}),ui.reportData("pci_sdk_setStyle_end")}catch(e){ui.handleError(e,"pci_sdk_setStyle_error")}}},{key:"validate",value:function(e){return this.apiInstance.handleApi("validate",{validateItems:e})}},{key:"getBeforePayData",value:function(e){return this.apiInstance.handleApi("getBeforePayData",{nextAction:e})}},{key:"updateCardToken",value:function(e){var t=this;return this.checkCardToken(),this.apiInstance.handleApiWithKey("updateCardToken",(function(n){return{options:Ti(Ti({},e),{},{token:t.cardToken}),extraOptions:{key:n}}}),(function(t){var n=t.key,r=t.result;return Ti(Ti({},e),{},{token:ti(r.token),key:n})})).then((function(e){return t.cardToken=e.token,ui.reportData("pci_sdk_updateCardToken_update_token"),e}))}},{key:"getCurrentCardInfo",value:(t=xo(Vo.mark((function e(){return Vo.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiInstance.handleApi("getCurrentCardInfo"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}();function Ai(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Fo(ji,"ApiOnly",Ii);var Di={};!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(e,t,n){var r=d;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return T()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?h:f,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=h,n.method="throw",n.arg=s.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",y={};function v(){}function m(){}function g(){}var b={};s(b,i,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(x([])));_&&_!==n&&r.call(_,i)&&(b=_);var O=g.prototype=v.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,c){var s=l(e[o],e,i);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==N(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=l(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:T}}function T(){return{value:t,done:!0}}return m.prototype=g,s(O,"constructor",g),s(g,"constructor",m),m.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,c,"GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},C(k.prototype),s(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(O),s(O,c,"Generator"),s(O,i,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}(Di);try{regeneratorRuntime=t}catch(e){"object"==("undefined"==typeof globalThis?"undefined":N(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}();var Ni,Bi=Di;!function(e){e.Google="googleFont",e.ShopLine="slFont",e.System="system"}(Ni||(Ni={}));var Ri,Mi=["Helvetica Neue","Arial","sans-serif"];!function(){var e,t,n,r;e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ni.System,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mi;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),Li(this,"fontLib",void 0),Li(this,"fontFamily",void 0),this.fontLib=t,this.fontFamily=n},(t=[{key:"setFontFamily",value:(n=Bi.mark((function e(t){var n;return Bi.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fontLib!==Ni.Google){e.next=5;break}return e.next=3,this.injectGoogleFontCss();case 3:e.next=8;break;case 5:if(this.fontLib!==Ni.ShopLine){e.next=8;break}return e.next=8,this.injectSLPFontCss();case 8:n=t.getAttribute("style")||"",t.setAttribute("style","".concat(n,"font-family:").concat(this.fontFamily.join(",")));case 10:case"end":return e.stop()}}),e,this)})),r=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){Ai(i,r,o,a,c,"next",e)}function c(e){Ai(i,r,o,a,c,"throw",e)}a(void 0)}))},function(e){return r.apply(this,arguments)})},{key:"injectCss",value:function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");return n.rel="stylesheet",n.href=e,t.appendChild(n),new Promise((function(t,r){n.onerror=function(){r({message:"inject css failed",url:e})},n.onload=function(){t()}}))}},{key:"injectGoogleFontCss",value:function(){var e=this.fontFamily.map((function(e){return"family=".concat(e.replace(/\s/g,"+"))}));return this.injectCss("https://fonts.googleapis.com/css?".concat(e.join("&"),"&display=swap"))}},{key:"injectSLPFontCss",value:function(){var e=this,t=this.fontFamily.map((function(t){return e.injectCss("https://cdn-theme.myshopline.com/cdn/shop/fonts/".concat(t,".css"))}));return Promise.all(t)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(),(Ri||(Ri={})).SL="sl_pci";var Fi=function(e,t){var n;return{card:{bin:e.bin,last4:null==e||null===(n=e.first6Last4)||void 0===n?void 0:n.slice(-4),data:JSON.stringify({host:t,token:null==e?void 0:e.token}),type:Ri.SL},channelToken:e.extend}},Hi=["paymentRequest","paymentOptions","paymentSession","version"],Ui=["newTotal","newLineItems","newShippingMethods","version","paymentSession","paymentRequest","paymentOptions"];function qi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gi=function(){function e(t,n){be(this,e),Ie(this,"payClient",null),Ie(this,"config",void 0),Ie(this,"logger",void 0),Ie(this,"payChannelData",void 0),Ie(this,"isUsePciToken",!1),this.config=t,this.logger=n.logger,this.isUsePciToken=jr(t.paymentInfo)}var t,n;return Oe(e,[{key:"setPayChannelData",value:function(e){var t=e.payChannelData,n=t.paymentRequest,r=t.paymentOptions,o=t.paymentSession,i=t.version,a=Ir(t,Hi);this.payChannelData={version:i,paymentRequest:n,paymentOptions:r,paymentSession:o,rest:Yi({},a)},It(this.payChannelData)}},{key:"beforePay",value:function(e){this.logger.info("beforePay",{data:Yi({},e)}),this.setPayChannelData(e),this.payChannelData&&(this.payClient=new window.ApplePaySession(this.payChannelData.version,this.payChannelData.paymentRequest,this.payChannelData.paymentOptions))}},{key:"pay",value:(n=ge(Le.mark((function e(t){var n=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setPayChannelData(t),this.logger.info("pay",{data:Yi({},t)}),e.abrupt("return",new Promise((function(e,t){var r,o=tr.Create,i=function(e){var t=e.type,r=e.originalEvent,i=e.updateEvent;o=t,n.logger.info("handleLogUpdateCurrentEvent",{data:{eventName:t,originalEvent:r,updateEvent:i}})},a=function(e,r){window[window.__sl_console__?"__sl_console__":"console"].error("AP unified error handling:",{error:e,type:Ne.Pay,extData:r}),n.logger.error("handleError",{action:Ne.Pay,error:e,data:Yi({},r)}),t(e),Ct(n.config.onError)&&n.config.onError(e,Ne.Pay,r)},c=function(){var e=ge(Le.mark((function e(t){var r,o,i,c,s,u,l,d,f,p,h,y,v,m,g,b,w,_,O,C,k,S,E,P;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.type,s=t.paymentMethod,u=t.shippingContact,l=t.couponCode,d=t.shippingMethod,f=Yi(Yi({},n.payChannelData),null===(r=n.payChannelData)||void 0===r?void 0:r.rest)){e.next=5;break}return a(new Error("without payChannelData")),e.abrupt("return");case 5:p="unknown",e.t0=c,e.next=e.t0===tr.Paymentmethodselected?9:e.t0===tr.Shippingcontactselected?11:e.t0===tr.Couponcodechanged?14:e.t0===tr.Shippingmethodselected?17:19;break;case 9:return f.newPaymentMethod=s,e.abrupt("break",20);case 11:return f.newShippingContact=u,p="shippingContactInvalid",e.abrupt("break",20);case 14:return f.newCouponCode=l,p="couponCodeInvalid",e.abrupt("break",20);case 17:return f.newShippingMethod=d,e.abrupt("break",20);case 19:return e.abrupt("break",20);case 20:if(Ct(n.config.onFormDataChange)){e.next=23;break}return a(new Error("without onFormDataChange")),e.abrupt("return");case 23:return delete f.rest,e.next=26,null===(o=(i=n.config).onFormDataChange)||void 0===o?void 0:o.call(i,f,pr[c]).catch((function(e){window[window.__sl_console__?"__sl_console__":"console"].error("onPaymentDataChanged fetch error",e),a(new Error("onPaymentDataChanged fetch error"))}));case 26:if((h=e.sent)&&!h.error){e.next=29;break}return e.abrupt("return",{errors:[new window.ApplePayError(p,void 0,(null==h||null===(y=h.error)||void 0===y?void 0:y.message)||"update error")],newTotal:null===(v=n.payChannelData)||void 0===v?void 0:v.rest.newTotal,newLineItems:null===(m=n.payChannelData)||void 0===m?void 0:m.rest.newLineItems,newShippingMethods:null===(g=n.payChannelData)||void 0===g?void 0:g.rest.newShippingMethods});case 29:return b=h.newTotal,w=h.newLineItems,_=h.newShippingMethods,O=h.version,C=h.paymentSession,k=h.paymentRequest,S=h.paymentOptions,E=Ir(h,Ui),n.payChannelData={version:O,paymentSession:C,paymentRequest:k,paymentOptions:S,rest:Yi(Yi({},E),{},{newTotal:b,newShippingMethods:_,newLineItems:w})},It(n.payChannelData),P={newTotal:b,newLineItems:w,newShippingMethods:_},e.abrupt("return",P);case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!n.payChannelData||!n.payChannelData.paymentSession)return window[window.__sl_console__?"__sl_console__":"console"].error("without payChannelData"),void a(new Error("without payChannelData"));try{var s=JSON.parse(window.atob(n.payChannelData.paymentSession)),u=n.payClient,l=n.logger;if(!u)throw new Error("No payment instance found");u.onvalidatemerchant=function(){var e=ge(Le.mark((function e(t){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i({type:tr.Validatemerchant,originalEvent:t,decodeMerchantSession:s}),u.completeMerchantValidation(s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.onpaymentmethodselected=function(){var e=ge(Le.mark((function e(t){var n,r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:tr.Paymentmethodselected,paymentMethod:t.paymentMethod},i({type:tr.Paymentmethodselected,originalEvent:t,updateEvent:n}),e.next=4,c(n);case 4:if(r=e.sent){e.next=7;break}throw new Error("no update information");case 7:u.completePaymentMethodSelection(r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.onshippingcontactselected=function(){var e=ge(Le.mark((function e(t){var n,r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:tr.Shippingcontactselected,shippingContact:t.shippingContact},i({type:tr.Shippingcontactselected,originalEvent:t,updateEvent:n}),e.next=4,c(n);case 4:if(r=e.sent){e.next=7;break}throw new Error("no update information");case 7:r.status=window.ApplePaySession.STATUS_SUCCESS,u.completeShippingContactSelection(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.onshippingmethodselected=function(){var e=ge(Le.mark((function e(t){var n,r,o;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:tr.Shippingmethodselected,shippingMethod:Yi(Yi({},t.shippingMethod),{},{selected:!0})},i({type:tr.Shippingmethodselected,originalEvent:t,updateEvent:n}),e.next=4,c(n);case 4:r=e.sent,o=Yi(Yi({},r),{},{status:window.ApplePaySession.STATUS_SUCCESS}),u.completeShippingMethodSelection(o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.oncouponcodechanged=function(){var e=ge(Le.mark((function e(t){var n,r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={type:tr.Couponcodechanged,couponCode:t.couponCode},i({type:tr.Couponcodechanged,originalEvent:t,updateEvent:n}),e.next=4,c(n);case 4:if(r=e.sent){e.next=7;break}throw new Error("no update information");case 7:u.completeCouponCodeChange(r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.onpaymentauthorized=function(){var t=ge(Le.mark((function t(r){var o,c,s,d,f,p,h,y,v,m,g,b,w,_,O;return Le.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i({type:tr.Paymentauthorized,originalEvent:r}),o=function(e){var t={status:e};l.info("pay",{data:{status:e}}),e===window.ApplePaySession.STATUS_SUCCESS&&u.completePayment(t)},t.prev=2,f=r.payment,p=f.billingContact,h=f.shippingContact,y=f.token,Ct(n.config.createOrder)){t.next=7;break}return a(new Error("onPaymentAuthorized failed, createOrder not triggered")),t.abrupt("return");case 7:return null==(v=Yi(Yi(Yi({},n.payChannelData),null===(c=n.payChannelData)||void 0===c?void 0:c.rest),{},{newShippingContact:h,newBillingContact:p}))||delete v.rest,t.next=11,null===(s=(d=n.config).createOrder)||void 0===s?void 0:s.call(d,n.config.paymentInfo,{payChannelData:v,token:{token:y}});case 11:if((m=t.sent)&&(null==m||!m.error)){t.next=15;break}throw o(window.ApplePaySession.STATUS_FAILURE),new Error("Failed to place order");case 15:if(o(window.ApplePaySession.STATUS_SUCCESS),n.afterCreateOrder(qe.Success),!n.isUsePciToken){t.next=27;break}return g=m.nextAction.pciInfo,t.next=21,n.getCardToken(r.payment,g).catch((function(e){a(e)}));case 21:if(b=t.sent){t.next=24;break}return t.abrupt("return");case 24:return e("onpaymentauthorized"),w=Fi(b,(null==g?void 0:g.host)||""),_=w.card,O=w.channelToken,t.abrupt("return",kn(m.nextAction,{data:{fastCheckout:!0,paymentMethodOptions:{paymentMethodInstrument:JSON.stringify(O)},paymentInstrument:{paymentMethod:n.config.paymentInfo.methodCode,card:n.config.channelCode===Re.CybsOther?Yi(Yi({},_),{},{binInfo:b.binInfo}):_}}}));case 27:e("onpaymentauthorized"),kn(m.nextAction),t.next=37;break;case 31:t.prev=31,t.t0=t.catch(2),o(window.ApplePaySession.STATUS_FAILURE),n.afterCreateOrder(qe.Fail),window[window.__sl_console__?"__sl_console__":"console"].error("pay failed",t.t0),a(new Error("pay failed"));case 37:case"end":return t.stop()}}),t,null,[[2,31]])})));return function(e){return t.apply(this,arguments)}}(),u.oncancel=function(){var t=ge(Le.mark((function t(r){return Le.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o!==tr.Paymentauthorized){t.next=3;break}return window[window.__sl_console__?"__sl_console__":"console"].warn("Cannot cancel payment after token has been received"),t.abrupt("return");case 3:i({type:tr.Cancel,originalEvent:r}),e("oncancel"),Ct(n.config.onCancel)&&n.config.onCancel(null==r?void 0:r.sessionError);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r=setTimeout((function(){Ct(n.config.onChannelModalSuccess)&&n.config.onChannelModalSuccess(n.config.paymentInfo)}),1e3),u.begin(),n.logger.log("Final parameters for launching Apple Pay",{data:{payChannelData:n.payChannelData}})}catch(e){clearTimeout(r),a(e)}})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){Ct(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:this.config.paymentInfo.channelCode,methodCode:Me.ApplePay})}},{key:"getCardToken",value:(t=ge(Le.mark((function e(t,n){var r,o,i,a,c=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n&&n.host&&null!=n&&n.resourceId){e.next=2;break}throw new Error("host or resourceId is required");case 2:return r=this.config.paymentInfo.sdkEnv,o=Mn[r].env||An.Prod,i=new ji.ApiOnly({env:o,channelId:this.config.paymentInfo.paymentId}),e.next=7,new Promise((function(e,t){i.create({onInit:function(){c.logger.info("hidden_iframe_has_loaded"),e("")},onError:function(){c.logger.error("hidden_iframe_load_fail"),t(new Error("hidden_iframe_load_fail"))}})}));case 7:return e.next=9,i.getCardToken({rawToken:t,paymentMethod:"ApplePay",partnerId:di.SL2,pciHost:n.host,resourceId:n.resourceId});case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),e}();function Vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wi,Ki,Xi,Ji=function(e){Se(i,Mt);var t,n,r,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(i);function i(e){var t,n,r;return be(this,i),Ie(Ce(r=o.call(this,e)),"name","APPLE_PAY"),Ie(Ce(r),"config",void 0),Ie(Ce(r),"initTime",0),Ie(Ce(r),"element",void 0),Ie(Ce(r),"domId",void 0),Ie(Ce(r),"client",null),Ie(Ce(r),"skeleton",void 0),Ie(Ce(r),"disabled",void 0),Ie(Ce(r),"orderData",void 0),Ie(Ce(r),"loading",void 0),Ie(Ce(r),"initSuccess",!0),Ie(Ce(r),"loadResourceFail",!1),Ie(Ce(r),"logger",void 0),Ie(Ce(r),"handleClick",ge(Le.mark((function e(){var t,n,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.disabled&&!r.loading){e.next=3;break}return r.logger.warn("applepay is disabled or loading"),e.abrupt("return");case 3:return r.logger.log("applepay onClick"),r.setLoading(!0),(t=r.config.props.expressOptimizationSwitch)&&(n=r.channelSdkInitConfig,o={amount:"99.99",label:"Total",type:"pending"},i=zi(zi({},n),{},{payChannelData:zi(zi({},n.payChannelData),{},{paymentRequest:zi(zi({},n.payChannelData.paymentRequest),{},{total:o,lineItems:[o]})})}),r.beforePay(i)),e.next=9,r.getOrderData();case 9:if((a=e.sent)&&a.paymentConfig){e.next=12;break}return e.abrupt("return");case 12:t?r.pay(a.paymentConfig):r.openModal(a.paymentConfig);case 13:case"end":return e.stop()}}),e)})))),Ie(Ce(r),"destroy",(function(){r.client=null,r.removeEvents()})),r.validate(),r.config=zn(Et(fr,e)),ve.set(null===(t=(n=r.config).loggerFn)||void 0===t?void 0:t.call(n)),r.logger=ve.get().pipeOwner("payment-common.SLP-ApplePay").pipeData({domId:"".concat(r.config.props.domId)}),r}return Oe(i,[{key:"channelSdkInitConfig",get:function(){var e;return JSON.parse((null===(e=this.config.paymentInfo)||void 0===e?void 0:e.channelSdkInitConfig)||"{}")}},{key:"validate",value:function(){return!0}},{key:"onError",value:function(e,t,n){Ct(this.config.onError)&&this.config.onError(e,t,n)}},{key:"handleError",value:function(e,t,n){t!==Ne.CreateExpected&&this.logger.error("handleError",{action:t,data:{type:t},error:e}),t===Ne.Init&&(this.initSuccess=!1,this.hideButton()),this.onError(e,t,n)}},{key:"beforeInit",value:function(){this.initTime=Pt.now(),Ct(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(e){try{this.initSuccess=!0,this.showButton();var t=Pt.now()-this.initTime;this.logger.log("afterInit",{data:{data:e,duration:t}}),Ct(this.config.afterInit)&&this.config.afterInit()}catch(e){this.handleError(e)}}},{key:"beforeCreateOrder",value:(r=ge(Le.mark((function e(){var t,n,r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ct(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return t=this.config.paymentInfo,n=t.channelCode,r=t.methodCode,o=t.paymentId,i=t.accessMode,e.next=5,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o,accessMode:i});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadResource",value:function(){var e=this;return new Promise((function(t){Fn("https://applepay.cdn-apple.com/jsapi/1.latest/apple-pay-sdk.js").then((function(){e.loadResourceFail=!1,t(!0)})).catch((function(n){e.loadResourceFail=!0,e.handleError(new Error("Failed to load channel js resource:".concat(n)),Ne.Init),t(!1)}))}))}},{key:"canMakePayments",value:function(){try{var e,t,n=window.ApplePaySession;return!!(n&&n.canMakePayments()&&n.supportsVersion((null===(e=this.channelSdkInitConfig)||void 0===e||null===(t=e.payChannelData)||void 0===t?void 0:t.version)||4))}catch(e){return!1}}},{key:"renderButton",value:function(){var e,t;this.element&&this.domId?(function(e){var t,n=e.domId,r=e.node,o=e.height,i=e.borderRadius,a=document.createElement("style"),c=document.createElement("div");r.style.height="".concat(o||43,"px"),c.innerHTML="<apple-pay-button id=".concat(n,' buttonstyle="black" type="plain" locale="en"></apple-pay-button>');var s="\n    #".concat(n," {\n      --apple-pay-button-width: 100%;\n      --apple-pay-button-height: ").concat(o||43,"px;\n      --apple-pay-button-border-radius: 0px;\n      --apple-pay-button-padding: 0px 0px;\n      --apple-pay-button-box-sizing: border-box;\n    }\n\n    .").concat(Bt," apple-pay-button {\n      display: none;\n    }\n\n    ").concat("\n    .applepay-confirm-modal-header {\n      margin-bottom: 12px;\n    }\n\n    .applepay-confirm-modal-content {\n      font-family: 'Helvetica Neue';\n      font-style: normal;\n      font-weight: 400;\n      font-size: 16px;\n      line-height: 24px;\n      color: #2c2c2c;\n    }\n\n    .applepay-confirm-modal-action {\n      margin-top: 24px;\n      display: flex;\n      flex-direction: column;\n    }\n\n    .applepay-confirm-modal-action > button {\n      border: 0;\n      text-align: center;\n      border-radius: 4px;\n      cursor: pointer;\n      font-style: normal;\n      line-height: 24px;\n    }\n\n    .applepay-confirm-modal-action-ok {\n      padding: 9px 0;\n      color: #fff;\n      background: #000;\n      font-size: 19px;\n      font-weight: 500;\n    }\n\n    .applepay-confirm-modal-action-ok > span {\n      vertical-align: middle;\n      font-family: 'SF Pro', 'Helvetica Neue';\n    }\n\n    .applepay-confirm-modal-action-ok > svg {\n      vertical-align: middle;\n    }\n\n    .applepay-confirm-modal-action-cancel {\n      padding: 0;\n      margin-top: 24px;\n      color: rgba(44, 44, 44, 0.5);\n      background: transparent;\n      font-size: 16px;\n      font-weight: 500;\n      font-family: 'Helvetica Neue';\n    }\n  ","\n  ");void 0===i&&(s+="\n      #".concat(n," {\n        --apple-pay-button-border-radius: 4px;\n      }\n\n      [data-button_style=square] #").concat(n," {\n        --apple-pay-button-border-radius: 0px;\n      }\n  \n      [data-button_style=rounded] #").concat(n," {\n        --apple-pay-button-border-radius: 9999px;\n      }\n    ")),a.innerHTML=s,null===(t=r.parentElement)||void 0===t||t.insertBefore(a,r),r.appendChild(c)}({node:this.element,domId:this.domId,height:null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height,borderRadius:null===(t=this.config.props.styleOptions)||void 0===t?void 0:t["border-radius"]}),this.removeSkeleton(this.element)):window[window.__sl_console__?"__sl_console__":"console"].error("applepay has no node")}},{key:"removeSkeleton",value:function(e){var t=this,n=null;n&&clearTimeout(n),n=setTimeout((function(){e&&t.skeleton&&e.removeChild(t.skeleton)}),300)}},{key:"openModal",value:function(e){var t=this;Sr({ok:function(n){t.beforePay(e),t.pay(e),null==n||n.close(),t.setLoading(!1)},cancel:function(){t.setLoading(!1),t.logger.info("user cancelled payment")}}).then((function(e){t.logger.info("Payment modal launched successfully"),e.show()})).catch((function(e){window[window.__sl_console__?"__sl_console__":"console"].error("Failed to prepare order",e),t.handleError(e,Ne.Pay)}))}},{key:"pay",value:function(e){var t,n=this;this.setLoading(!1),null===(t=this.client)||void 0===t||t.pay(e).then((function(e){n.logger.info("User payment completed without errors",{data:{res:e}})})).catch((function(e){window[window.__sl_console__?"__sl_console__":"console"].error("User payment error",{error:e}),n.handleError(e,Ne.Pay)}))}},{key:"beforePay",value:function(e){try{var t;null===(t=this.client)||void 0===t||t.beforePay(e)}catch(e){this.setLoading(!1),window[window.__sl_console__?"__sl_console__":"console"].error("Failed to prepare order",e),this.handleError(e,Ne.Pay)}}},{key:"getOrderData",value:(n=ge(Le.mark((function e(){var t;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeCreateOrder();case 2:if(t=e.sent,this.logger.log("Requesting API to get order data",{data:{params:t}}),!1!==(null==t?void 0:t.valid)){e.next=8;break}return this.setLoading(!1),this.onError(new Error("create order data no found"),Ne.Pay,{params:t}),e.abrupt("return");case 8:if(t.paymentConfig){e.next=13;break}return window[window.__sl_console__?"__sl_console__":"console"].error("No payment information"),this.handleError(new Error("no payment information"),Ne.Pay,{params:t}),this.setLoading(!1),e.abrupt("return");case 13:return this.orderData=t,e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getEle",value:function(){var e,t=null===(e=this.element)||void 0===e?void 0:e.querySelector("#".concat(this.domId));if(t)return t;window[window.__sl_console__?"__sl_console__":"console"].error("Apple Pay node not found")}},{key:"bindEvents",value:function(){var e=this.getEle();e&&e.addEventListener("click",this.handleClick)}},{key:"removeEvents",value:function(){var e=this.getEle();e&&e.removeEventListener("click",this.handleClick)}},{key:"render",value:(t=ge(Le.mark((function e(){var t,n,r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.config,r=n.props,o=n.paymentInfo,i=document.getElementById(o.currentDomId)){e.next=5;break}return this.handleError(new Error("[onError][Init failed][Cannot find mounted DOM]"),Ne.Init),e.abrupt("return",null);case 5:return this.domId="".concat(o.currentDomId,"-contain"),this.element=i,this.logger.log("render start",{data:{config:this.config}}),e.next=10,this.loadResource();case 10:if(e.sent){e.next=13;break}return window[window.__sl_console__?"__sl_console__":"console"].error("load applePay resource failed"),e.abrupt("return");case 13:return e.next=15,this.canMakePayments();case 15:if(e.sent){e.next=20;break}return this.handleError(new Error("Cannot use applePay"),Ne.Init),window[window.__sl_console__?"__sl_console__":"console"].error("Cannot use applePay"),e.abrupt("return");case 20:if(this.beforeInit(),a=Er({node:i,domId:this.domId,height:(null===(t=r.styleOptions)||void 0===t?void 0:t.height)||"",wrapperClass:r.wrapperClass,wrapperStyle:r.wrapperStyle}),this.skeleton=a,this.renderButton(),this.client=new Gi(this.config,{logger:this.logger}),this.client){e.next=28;break}return window[window.__sl_console__?"__sl_console__":"console"].error("new Failed to create new Client"),e.abrupt("return");case 28:return this.afterInit(),this.bindEvents(),e.abrupt("return",this.client);case 31:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setDisabled",value:function(e){if(this.element)try{if(this.disabled=e,e)return void this.element.classList.add(Nt);this.element.classList.remove(Nt)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("This error does not affect functionality, no need to address",e)}}},{key:"setLoading",value:function(e){if(this.element)try{if(this.disabled=e,e)return void this.element.classList.add(Bt);this.element.classList.remove(Bt)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("This error does not affect functionality, no need to address",e)}}}]),i}();!function(e){e.GooglePay="googlePay",e.ApplePay="applePay",e.Link="link",e.BrowserCard="browserCard"}(Wi||(Wi={})),function(e){e.Default="default",e.Square="square",e.Rounded="rounded"}(Ki||(Ki={}));var $i=[Wi.ApplePay,Wi.GooglePay,Wi.Link,Wi.BrowserCard],Zi=(Ie(Xi={},Ki.Default,4),Ie(Xi,Ki.Rounded,9999),Ie(Xi,Ki.Square,0),Xi),Qi=function(e,t,n){if(e){var r=e.contains(t);n&&!r?e.add(t):!n&&r&&e.remove(t)}},ea=function(){function e(t,n){var r=this;be(this,e),Ie(this,"container",void 0),Ie(this,"styleElement",null),Ie(this,"insertStyle",(function(e){if(r.container){var t=document.createElement("style");t.innerHTML="\n      .".concat(Bt," .__PrivateStripeElement {\n        display: none !important;\n        visibility: hidden;\n      }\n    "),e.height&&(r.container.style.height="".concat(e.height,"px")),r.styleElement=t,r.container.parentElement&&r.container.parentElement.insertBefore(t,r.container)}})),Ie(this,"destroy",(function(){r.container.parentElement&&r.styleElement&&r.container.parentElement.removeChild(r.styleElement)})),this.container=t,this.insertStyle(n)}return Oe(e,[{key:"setDisabled",value:function(e){Qi(this.container.classList,Nt,e)}},{key:"setLoading",value:function(e){Qi(this.container.classList,Bt,e)}}]),e}();function ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function na(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ta(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ra=function(e){return(e||"").toLowerCase()},oa=function(e,t){return{label:"Total",amount:e,pending:t}},ia=function(e){return e===Wi.ApplePay},aa=function(e){Se(u,Mt);var t,n,r,o,i,a,c,s=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(u);function u(e){var t,n,r;return be(this,u),Ie(Ce(r=s.call(this,e)),"config",void 0),Ie(Ce(r),"payChannelData",null),Ie(Ce(r),"instance",null),Ie(Ce(r),"paymentRequest",null),Ie(Ce(r),"prButton",null),Ie(Ce(r),"buttonElement",null),Ie(Ce(r),"styleElement",null),Ie(Ce(r),"paymentMethod",null),Ie(Ce(r),"confirmModalLoadState",null),Ie(Ce(r),"disabled",!1),Ie(Ce(r),"loading",!1),Ie(Ce(r),"initSuccess",!0),Ie(Ce(r),"loadResourceFail",!1),Ie(Ce(r),"initTime",0),Ie(Ce(r),"logger",void 0),Ie(Ce(r),"destroy",(function(){try{var e,t;null===(e=r.buttonElement)||void 0===e||e.destroy(),r.buttonElement=null,null===(t=r.prButton)||void 0===t||t.unmount();var n,o=document.getElementById(r.config.paymentInfo.currentDomId);null!=o&&o.parentElement&&r.styleElement&&(null==o||null===(n=o.parentElement)||void 0===n||n.removeChild(r.styleElement),o.innerHTML=""),r.paymentRequest=null,r.instance=null}catch(e){r.logger.error("stripeOther destroy error",{error:e,data:{channelSdkInitConfig:r.config.paymentInfo.channelSdkInitConfig}})}})),r.config=e,ve.set(null===(t=(n=r.config).loggerFn)||void 0===t?void 0:t.call(n)),r.logger=ve.get().pipeOwner("payment-common.StripeOther").pipeData({domId:"".concat(r.config.props.domId)}),r}return Oe(u,[{key:"render",value:(c=ge(Le.mark((function e(){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.beforeInit(),e.next=3,this.init();case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"init",value:(a=ge(Le.mark((function e(){var t,n,r,o;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.paymentMethod=Wi[this.config.paymentInfo.methodCode]||null,e.next=3,this.loadChannelJs();case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:if(this.createStripeInstance(),!this.paymentRequest){e.next=23;break}return t=Pt.now(),e.next=11,this.paymentRequest.canMakePayment();case 11:if(n=e.sent,r=Pt.now()-t,o={canMakePaymentResult:n,paymentMethod:this.paymentMethod,taken:r},this.logger.info("canMakePaymentResult",{data:{logInfo:o}}),window[window.__sl_console__?"__sl_console__":"console"].log("canMakePaymentResult:",o),!(this.paymentMethod&&n&&n[this.paymentMethod])){e.next=21;break}this.renderButton(),this.afterInit(),e.next=23;break;case 21:return this.handleError(new Error("The current browser does not support this payment method"),Ne.Init,{canMakePaymentResult:n}),e.abrupt("return");case 23:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"beforeInit",value:function(){this.initTime=Pt.now(),Ct(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(){this.initSuccess=!0,this.showButton();var e=Pt.now()-this.initTime;this.logger.log("afterInit",{data:{duration:e}}),Ct(this.config.afterInit)&&this.config.afterInit()}},{key:"onChannelModalSuccess",value:function(){Ct(this.config.onChannelModalSuccess)&&this.config.onChannelModalSuccess(this.config.paymentInfo)}},{key:"beforeCreateOrder",value:(i=ge(Le.mark((function e(){var t,n,r,o,i;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ct(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.confirmModalLoadState;case 4:return t=this.config.paymentInfo,n=t.channelCode,r=t.methodCode,o=t.paymentId,e.next=7,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o});case 7:return i=e.sent,e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){Ct(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:Re.StripeOther,methodCode:this.config.paymentInfo.methodCode})}},{key:"setDisabled",value:function(e){this.disabled=e,this.buttonElement&&this.buttonElement.setDisabled(e)}},{key:"setLoading",value:function(e){this.loading=e,this.buttonElement&&this.buttonElement.setLoading(e)}},{key:"loadChannelJs",value:function(){var e=this;return new Promise((function(t){Fn("https://js.stripe.com/v3/").then((function(){e.loadResourceFail=!1,t(!0)})).catch((function(n){e.loadResourceFail=!0,e.handleError(new Error("Failed to load channel js resource: ".concat(n)),Ne.Init),t(!1)}))}))}},{key:"createStripeInstance",value:function(){var e=this;try{var t=this.config.paymentInfo,n=t.configData,r=n.publicApiKey,o=void 0===r?"":r,i=n.stripeApiVersion,a=n.accountId,c=n.accountCountry,s=void 0===c?"":c,u=t.channelSdkInitConfig,l=this.config.paymentInfo.settleCurrency||"",d=$i.filter((function(t){return t!==e.paymentMethod}));if(!u)return void this.handleError(new Error("channelSdkInitConfig is empty"),Ne.Init);var f={};try{f=JSON.parse(u)}catch(e){return void this.handleError(new Error("Failure to parse channel configuration JSON string"),Ne.Init,{channelSdkInitConfig:u})}this.instance=window.Stripe(o,{apiVersion:i,stripeAccount:a});var p=this.instance.paymentRequest(na(na({},f),{},{currency:ra(l),country:s,total:oa(9999,!0),disableWallets:d}));this.paymentRequest=p}catch(e){this.handleError(new Error("Failed to create channel instance"),Ne.Init,{channelMsg:e.message})}}},{key:"onPaymentAuthorized",value:(o=ge(Le.mark((function e(t){var n,r,o,i,a,c,s,u,l,d,f,p,h=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.config.createOrder,Ct(n)){e.next=3;break}return e.abrupt("return");case 3:return r=t.paymentMethod,o=t.shippingAddress,i=t.shippingOption,a=t.payerName,c=t.payerPhone,s=t.payerEmail,u=r.id,l=void 0===u?"":u,d=r.billing_details,f=na(na({},this.payChannelData),{},{paymentMethod:l,billing_details:d,shippingAddress:o,shippingOption:i,payerInfo:{name:a,phone:c,email:s}}),e.prev=6,e.next=9,n(this.config.paymentInfo,{payChannelData:f,token:f});case 9:if(!(y=p=e.sent)||!Boolean(y.error)){e.next=13;break}throw p.error;case 13:return e.next=15,kn(p.nextAction,{payOptions:{hooks:{channelConfirm:function(e){return h.channelConfirm(e,t)}}}});case 15:e.next=22;break;case 17:e.prev=17,e.t0=e.catch(6),t.complete("fail"),this.handleError(e.t0,Ne.Pay),this.afterCreateOrder(qe.Fail);case 22:case"end":return e.stop()}var y}),e,this,[[6,17]])}))),function(e){return o.apply(this,arguments)})},{key:"channelConfirm",value:(r=ge(Le.mark((function e(t,n){var r,o,i,a;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(null===(r=t.data)||void 0===r?void 0:r.clientSecret)||"",this.instance){e.next=3;break}throw new Error("stripe instance not found");case 3:if(o){e.next=9;break}if(!t.nextAction){e.next=8;break}return e.next=7,kn(t.nextAction);case 7:return e.abrupt("return");case 8:throw new Error("The interface does not return clientSecret, and the sdk`s confirm cannot be called");case 9:return e.prev=9,e.next=12,this.instance.confirmCardPayment(o);case 12:i=e.sent,(a=i.error)?(n.complete("fail"),this.afterCreateOrder(qe.Fail),this.handleError(new Error("confirm error"),Ne.Pay,{error:a,clientSecret:o})):(n.complete("success"),this.afterCreateOrder(qe.Success));case 15:if(e.prev=15,!t.nextAction){e.next=19;break}return e.next=19,kn(t.nextAction);case 19:return e.finish(15);case 20:case"end":return e.stop()}}),e,this,[[9,,15,20]])}))),function(e,t){return r.apply(this,arguments)})},{key:"renderButton",value:function(){if(this.instance&&this.paymentRequest)try{var e,t,n=document.getElementById(this.config.paymentInfo.currentDomId);if(!n)throw new Error("Container not found: #".concat(this.config.paymentInfo.currentDomId));var r=this.instance.elements(),o=null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height;if(ia(this.paymentMethod)){var i,a=document.createElement("style");a.innerHTML="\n    .applepay-confirm-modal-header {\n      margin-bottom: 12px;\n    }\n\n    .applepay-confirm-modal-content {\n      font-family: 'Helvetica Neue';\n      font-style: normal;\n      font-weight: 400;\n      font-size: 16px;\n      line-height: 24px;\n      color: #2c2c2c;\n    }\n\n    .applepay-confirm-modal-action {\n      margin-top: 24px;\n      display: flex;\n      flex-direction: column;\n    }\n\n    .applepay-confirm-modal-action > button {\n      border: 0;\n      text-align: center;\n      border-radius: 4px;\n      cursor: pointer;\n      font-style: normal;\n      line-height: 24px;\n    }\n\n    .applepay-confirm-modal-action-ok {\n      padding: 9px 0;\n      color: #fff;\n      background: #000;\n      font-size: 19px;\n      font-weight: 500;\n    }\n\n    .applepay-confirm-modal-action-ok > span {\n      vertical-align: middle;\n      font-family: 'SF Pro', 'Helvetica Neue';\n    }\n\n    .applepay-confirm-modal-action-ok > svg {\n      vertical-align: middle;\n    }\n\n    .applepay-confirm-modal-action-cancel {\n      padding: 0;\n      margin-top: 24px;\n      color: rgba(44, 44, 44, 0.5);\n      background: transparent;\n      font-size: 16px;\n      font-weight: 500;\n      font-family: 'Helvetica Neue';\n    }\n  ",this.styleElement=a,null===(i=n.parentElement)||void 0===i||i.insertBefore(a,n)}var c=null===(t=this.config.props.styleOptions)||void 0===t?void 0:t["border-radius"];if(void 0===c){var s,u=document.querySelector("[data-button_style]"),l=null==u?void 0:u.getAttribute("data-button_style");this.logger.info("buttonStyle",{data:{buttonStyle:l}}),c=null!==(s=Zi[l])&&void 0!==s?s:Zi.default}var d={height:o?"".concat(o,"px"):"",theme:"dark",borderRadius:"".concat(c,"px")},f=r.create("paymentRequestButton",{paymentRequest:this.paymentRequest,style:{paymentRequestButton:d}});this.prButton=f,this.initButtonListener(this.paymentRequest,this.prButton),this.buttonElement=new ea(n,{height:o}),this.prButton.mount(n);var p=n.querySelector(".__PrivateStripeElement");p&&(p.style.display="block")}catch(e){this.handleError(new Error("Failed to render button"),Ne.Init,{channelMsg:e.message})}}},{key:"initButtonListener",value:function(e,t){var n=this;e.on("shippingaddresschange",(function(e){var t=e.shippingAddress,r=e.updateWith;n.handleFormDataChange(Ye.ChangeAddress,{shippingAddress:t},r)})),e.on("shippingoptionchange",function(){var e=ge(Le.mark((function e(t){var r,o;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.shippingOption,o=t.updateWith,n.handleFormDataChange(Ye.ChangeDeliveryMethod,{shippingOption:r},o);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("cancel",(function(){n.logger.info("User closed payment modal")})),e.on("paymentmethod",this.onPaymentAuthorized.bind(this)),t.on("click",(function(e){e.preventDefault(),n.handleStripeOtherButtonClick()}))}},{key:"handleFormDataChange",value:(n=ge(Le.mark((function e(t,n,r){var o,i,a,c,s,u,l,d;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.info("handleFormDataChange: ".concat(t),{data:{params:n}}),o=this.config.onFormDataChange,Ct(o)){e.next=5;break}return r({status:"fail"}),e.abrupt("return");case 5:return e.prev=5,e.next=8,o(na(na({},this.payChannelData),n),t);case 8:if((i=e.sent)&&!i.error){e.next=11;break}throw new Error(null==i||null===(a=i.error)||void 0===a?void 0:a.message);case 11:if(this.payChannelData=i,c=this.payChannelData,s=c.amount,u=void 0===s?0:s,l=c.shippingOptions,d=c.displayItems,null!=l&&l.length){e.next=16;break}return r({status:"invalid_shipping_address"}),e.abrupt("return");case 16:r({status:"success",total:oa(u,!1),displayItems:d,shippingOptions:l}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),r({status:"fail"}),this.handleError(new Error("Failed to update abandonedOrder info"),Ne.Pay,{error:e.t0});case 23:case"end":return e.stop()}}),e,this,[[5,19]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"handleStripeOtherButtonClick",value:(t=ge(Le.mark((function e(){var t,n,r,o,i,a,c,s,u=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.instance&&this.paymentRequest&&!this.loading&&!this.disabled){e.next=2;break}return e.abrupt("return");case 2:return t=this.config.props.expressOptimizationSwitch,n=function(){var e=null;try{u.paymentRequest&&(e=setTimeout((function(){u.onChannelModalSuccess()}),1e3),u.paymentRequest.show(),u.logger.info("Payment modal launched successfully"))}catch(t){e&&(clearTimeout(e),e=null),u.handleError(new Error("Failed to pull up the channel"),Ne.PullUpChannel,{error:t})}},this.setLoading(!0),ia(this.paymentMethod)&&t&&setTimeout((function(){n()})),e.next=8,this.beforeCreateOrder().catch((function(e){u.handleError(e,Ne.PullUpChannel)}));case 8:if(r=e.sent,this.setLoading(!1),(l=r)&&!1!==l.valid&&r.paymentConfig&&r.paymentConfig.payChannelData){e.next=13;break}return e.abrupt("return");case 13:o=r.paymentConfig.payChannelData,i=o.amount,a=o.currency,c=o.shippingOptions,s=o.displayItems,this.payChannelData=na({},o),this.logger.info("Updating payment modal information",{data:{amount:i,shippingOptions:c,displayItems:s}}),this.paymentRequest.update({currency:ra(a),total:oa(i,!1),shippingOptions:c,displayItems:s}),ia(this.paymentMethod)?t||Sr({ok:n,cancel:function(){u.logger.info("user cancelled payment")}}).then((function(e){e.show()})).catch((function(e){u.handleError(e,Ne.Pay)})):setTimeout((function(){n()}));case 19:case"end":return e.stop()}var l}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleError",value:function(e,t,n){window[window.__sl_console__?"__sl_console__":"console"].error("Unified Error Handling for StripeOther:",{error:e,type:t,extData:n}),t!==Ne.CreateExpected&&this.logger.error("handleError",{action:t,error:e,data:na({},n)}),t===Ne.Init&&(this.initSuccess=!1,this.hideButton()),Ct(this.config.onError)&&this.config.onError(e,t,n)}}]),u}(),ca=function(e){Se(n,aa);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(e){var r;return be(this,n),Ie(Ce(r=t.call(this,e)),"name","GOOGLE_PAY"),r}return Oe(n)}(),sa=function(e){Se(n,aa);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(e){var r;return be(this,n),Ie(Ce(r=t.call(this,e)),"name","APPLE_PAY"),r}return Oe(n)}();function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var da=function(e){var t=e.paymentInfo,n=t.configData,r=t.channelSdkInitConfig,o=t.captureInfo.autoCapture,i=e.props.payMode===Be.Continue,a=e.props.isSubscription,c=function(e,t){var n="",r=function(e){var t=e.key,r=e.value;n=Ft(n,Ie({},t,r))};return Array.isArray(e)&&(null==e||e.forEach((function(e){e.scope===Be.All?r(e):(t&&e.scope===Be.Continue&&r(e),t||e.scope!==Be.PayNow||r(e))}))),n}(JSON.parse(r),i),s={currency:e.paymentInfo.settleCurrency||"USD",commit:!i,"merchant-id":n.paypalMerchantId,"client-id":n.clientId};return Ft(c,la(la({},s),a?{intent:"tokenize",vault:!0}:{intent:o?"capture":"authorize"}))},fa=function(e){var t=e;if(null!=e&&e.paymentInfo){var n=e.paymentInfo.configData;t.props=la(la({},e.props),{},{queryParams:da(e)},n)}return t},pa=function(e,t){var n,r=t.props.isSubscription;return{abandonedOrderInfo:e.abandonedOrderInfo,orderFrom:e.orderFrom||e.abandonedOrderInfo.orderFrom,channelCode:Re.Paypal,spbCurrencyCode:t.paymentInfo.settleCurrency,payInfo:{cancelUrl:window.location.href,returnUrl:e.returnUrl,captureInfo:null===(n=t.paymentInfo)||void 0===n?void 0:n.captureInfo,paymentScenes:r?Ke.PAY_AND_BIND:Ke.PAY_NORMAL},dataReportReq:e.dataReportReq}},ha=function(e){var t=Math.floor(e);return t>=5e3&&t<=1e4?"warn":t>1e4?"error":"info"};function ya(e){var t,n=(Ie(t={},"".concat(Re.Paypal,"-").concat(Me.Paypal),{validate:function(){return e.props&&kt(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:Ta}),Ie(t,"".concat(Re.StripeOther,"-").concat(Me.ApplePay),{validate:function(){return e.props&&kt(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:sa}),Ie(t,"".concat(Re.StripeOther,"-").concat(Me.GooglePay),{validate:function(){return e.props&&kt(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:ca}),Ie(t,Me.GooglePay,{validate:function(){return e.props&&kt(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:Yn}),Ie(t,Me.ApplePay,{validate:function(){return e.props&&kt(e.props)?{result:!0}:{result:!1,errorTip:"props illegal"}},getConfig:function(){return e},component:Ji}),t);return xr(e.paymentInfo)||jr(e.paymentInfo)||Tr(e.paymentInfo)?n["".concat(e.paymentInfo.methodCode)]:n["".concat(e.channelCode,"-").concat(e.paymentInfo.methodCode)]}function va(e){var t=!0;return e&&e.type||(t=!1),t}function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ga(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ba,wa=function(e){var t,n=e.node,r=e.domId,o=e.height,i=e.isContinueMode,a=e.isVerticalLayout,c=e.wrapperClass,s=e.wrapperStyle,u=document.createElement("div");u.classList.add("paypal__skeleton--animated");var l=document.createElement("style");if(_a({styleTag:l,domId:r,height:o,isContinueMode:i,isVerticalLayout:a}),n){if(c&&n.classList.add(c),s){var d,f={},p=(null===(d=n.getAttribute("style"))||void 0===d?void 0:d.replace(/\s+/g,""))||"",h=function(e){var t={};return e.split(";").forEach((function(e){var n=Ot(e.split(":"),2),r=n[0],o=n[1],i=null==r?void 0:r.replace(/-[^0-9]/g,(function(e){return e.charAt(1).toUpperCase()}));i&&(t[i]=o)})),t};"string"==typeof s?f=ga(ga({},h(p)),h(s)):"object"===N(s)&&(f=ga(ga({},h(p)),s)),n.style="object"!==N(y=f)?"":Object.entries(y).map((function(e){return e.join(":")})).join(";").replace(/[A-Z]/g,(function(e){return"-".concat(e.charAt(0).toLowerCase())}))}var y;return null===(t=n.parentElement)||void 0===t||t.insertBefore(l,n),n.appendChild(u),u}},_a=function(e){var t=e.styleTag,n=e.domId,r=e.height,o=e.isContinueMode,i=e.isVerticalLayout;t.innerHTML=o&&!i?"\n        #".concat(n," {\n          overflow: hidden;\n          text-align: center;\n          height: ").concat(r,"px;\n          z-index: 1;\n        }\n        /** paypal background color */\n        #").concat(n,".paypal__bg::before,\n        #").concat(n,".paypal__bg::after {\n          content:'';\n          position: absolute;\n          top: 0;\n          bottom: 0;\n          left: 0;\n          width: calc(50% - 3px);\n          border-radius: 4px;\n        }\n        #").concat(n,".paypal__bg::after {\n          left: unset;\n          right: 0;\n        }\n        [data-button_style=square] #").concat(n,".paypal__bg::before,\n        [data-button_style=square] #").concat(n,".paypal__bg::after{\n          border-radius: 0 !important;\n        }\n        [data-button_style=rounded] #").concat(n,".paypal__bg{\n          border-radius: 9999px !important;\n        }\n      "):"\n        #".concat(n," {\n          min-height: ").concat(r,"px;\n        }\n        ");var a=["90deg","hsla(0, 0%, 74.5%, 0.2) 25%","hsla(0, 0%, 50.6%, 0.24) 37%","hsla(0, 0%, 74.5%, 0.2) 63%"].join(", ");t.innerHTML+="\n      #".concat(n," {\n        position: relative;\n        user-select: none;\n      }\n      #").concat(n," .paypal__skeleton--animated {\n        margin: 0 auto;\n        border-radius: 4px;\n        width: 100%;\n        height: ").concat(r,"px;\n        position: absolute;\n      }\n\n      .paypal__skeleton--animated {\n        background: linear-gradient(").concat(a,");\n        background-size: 400% 100%;\n        animation: skeleton 2s linear infinite;\n      }\n\n      ").concat("\n            @keyframes skeleton {\n              0% {\n                background-position: 100% 50%;\n              }\n              100% {\n                background-position: 0 50%;\n              }\n            }\n          ","\n      ")};function Oa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ca(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){Se(i,it);var t,n,r,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(i);function i(e){var t;return be(this,i),Ie(Ce(t=o.call(this,e)),"paypalInstance",null),t}Oe(i,[{key:"initPaypal",value:function(){this.paypalInstance=window[this.paypalInstanceName]}},{key:"getConfig",value:(r=ge(Le.mark((function e(){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paypalInstance){e.next=2;break}throw new Error("paypalInstance is not initialized");case 2:return e.abrupt("return",this.paypalInstance.Applepay().config());case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"validateMerchant",value:(n=ge(Le.mark((function e(t){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paypalInstance){e.next=2;break}throw new Error("paypalInstance is not initialized");case 2:return e.abrupt("return",this.paypalInstance.Applepay().validateMerchant(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"confirmOrder",value:(t=ge(Le.mark((function e(t,n){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paypalInstance){e.next=2;break}throw new Error("paypalInstance is not initialized");case 2:return e.abrupt("return",this.paypalInstance.Applepay().confirmOrder(Ca({orderId:t},n||{})));case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.paypalInstance=null}}])}(),function(e){Se(i,it);var t,n,r,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(i);function i(e){var t;return be(this,i),Ie(Ce(t=o.call(this,e)),"paypalInstance",null),t}Oe(i,[{key:"initPaypal",value:function(){this.paypalInstance=window[this.paypalInstanceName]}},{key:"getConfig",value:(r=ge(Le.mark((function e(t){var n,r,o,i;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paypalInstance){e.next=2;break}throw new Error("paypalInstance is not initialized");case 2:return e.next=4,this.paypalInstance.Googlepay().config();case 4:return i=e.sent,"JP"==t&&null!=i&&null!==(n=i.allowedPaymentMethods)&&void 0!==n&&null!==(r=n[0])&&void 0!==r&&null!==(o=r.parameters)&&void 0!==o&&o.allowedAuthMethods&&(i.allowedPaymentMethods[0].parameters.allowedAuthMethods=["PAN_ONLY"]),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"confirmOrder",value:(n=ge(Le.mark((function e(t,n){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paypalInstance){e.next=2;break}throw new Error("paypalInstance is not initialized");case 2:return e.abrupt("return",this.paypalInstance.Googlepay().confirmOrder({orderId:t,paymentMethodData:n}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"initiatePayerAction",value:(t=ge(Le.mark((function e(t){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.paypalInstance){e.next=2;break}throw new Error("paypalInstance is not initialized");case 2:return e.abrupt("return",this.paypalInstance.Googlepay().initiatePayerAction({orderId:t}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.paypalInstance=null}}])}();var Ea={loadingStatus:Ue.Await,info:{},promise:null},Pa=function(e){Se(c,Mt);var t,n,r,o,i,a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var o=Pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(c);function c(e){var t,n;return be(this,c),Ie(Ce(n=a.call(this,e)),"name","PAY_PAL"),Ie(Ce(n),"config",void 0),Ie(Ce(n),"payMode",void 0),Ie(Ce(n),"isHidePayPalButton",void 0),Ie(Ce(n),"isRendered",void 0),Ie(Ce(n),"element",null),Ie(Ce(n),"initTimer",void 0),Ie(Ce(n),"initActions",void 0),Ie(Ce(n),"createOrderParams",void 0),Ie(Ce(n),"returnUrl",void 0),Ie(Ce(n),"orderInfoMap",{}),Ie(Ce(n),"initTime",0),Ie(Ce(n),"skeleton",void 0),Ie(Ce(n),"initSuccess",!0),Ie(Ce(n),"loadResourceFail",!1),Ie(Ce(n),"logger",void 0),Ie(Ce(n),"dynamicJsonpCallback",(function(e){Ea=Sa(Sa({},Ea),{},{info:e,loadingStatus:Ue.Done}),n.handleDynamicNotify(e)})),Ie(Ce(n),"destroy",(function(){try{ba&&(ba.disconnect(),ba=null),n.element&&(n.element.innerHTML="",n.element=null)}catch(e){n.logger.error("paypal destroy error",{error:e,data:{channelSdkInitConfig:n.config.paymentInfo.channelSdkInitConfig}})}})),n.payMode=e.props.payMode||Be.Continue,n.returnUrl="",ve.set(null===(t=e.loggerFn)||void 0===t?void 0:t.call(e)),n.logger=ve.get().pipeOwner("payment-common.PayPal").pipeData({domId:"".concat(e.props.domId)}),n.config=fa(Et(tt,e)),n.handleDomHeight(),n.validate(e)?n:Ee(n)}return Oe(c,[{key:"validate",value:function(e){var t=ya(e);if(!t)return!1;var n=t.validate(),r=n.result,o=n.errorTip;return!!r||(this.logger.error("constructor error ".concat(o)),!1)}},{key:"handleDomHeight",value:function(){var e,t=(null===(e=this.config.props.styleOptions)||void 0===e?void 0:e.height)||45;t>55&&(this.logger.warn("Button height input exception",{data:{height:t}}),t=55),t<25&&(this.logger.warn("Button height input exception",{data:{height:t}}),t=25),this.config.props.styleOptions=Sa(Sa({},this.config.props.styleOptions),{},{height:t})}},{key:"isContinueMode",get:function(){return this.payMode===Be.Continue}},{key:"expressButtonConfig",get:function(){try{var e;return JSON.parse((null===(e=this.config.paymentInfo)||void 0===e?void 0:e.expressButtonConfig)||"{}")}catch(e){var t;this.logger.error("parse expressButtonConfig error",{error:e,data:{expressButtonConfig:null===(t=this.config.paymentInfo)||void 0===t?void 0:t.expressButtonConfig}})}}},{key:"isVerticalLayout",get:function(){var e;return"vertical"===(null===(e=this.expressButtonConfig)||void 0===e?void 0:e.layout)}},{key:"isSubscription",get:function(){return this.config.props.isSubscription}},{key:"handleError",value:function(e,t,n){this.initTimer&&clearTimeout(this.initTimer),t!==Ne.CreateExpected&&this.logger.error("handleError",{action:t,error:e,data:{type:t,extData:n},tags:null==n?void 0:n.tags}),t===Ne.Init&&(this.initSuccess=!1,this.hideButton()),Ct(this.config.onError)&&this.config.onError(e,t,n)}},{key:"handleDynamicNotify",value:function(e){var t=(e||{}).paypal;this.isHidePayPalButton=!t,t||(Ct(this.config.onDynamicNotify)&&this.config.onDynamicNotify(Sa(Sa({},e),{},{isHidePayPalButton:!0})),this.handleError(new Error("Dynamic button loading failed"),Ne.Init))}},{key:"handleDynamic",value:(i=ge(Le.mark((function e(){var t,n,r=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ie(t={},Ue.Done,(function(){r.handleDynamicNotify(Ea.info)})),Ie(t,Ue.Fail,(function(){})),Ie(t,Ue.Pending,ge(Le.mark((function e(){return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ea.promise;case 2:r.handleDynamicNotify(Ea.info);case 3:case"end":return e.stop()}}),e)})))),Ie(t,Ue.Await,(function(){var e;return Ea.loadingStatus=Ue.Pending,window[et]=r.dynamicJsonpCallback,Ea.promise=Ze([(e=et,"https://www.paypal.com/checkoutnow/remembered?callback=".concat(e))],{returnPromise:!0}).catch((function(){r.loadResourceFail=!0,r.handleError(new Error("[Failed to load remember script]:".concat(et)),Ne.Init)})),Ea.promise})),n=t[Ea.loadingStatus],e.abrupt("return",n());case 3:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"handlePay",value:function(e){var t=e.nextAction,n=e.context,r=(void 0===n?{returnUrl:""}:n).returnUrl;if(this.returnUrl=r,this.isSubscription){var o=t.data.popupData.tokenId;return this.orderInfoMap[o||""]={returnUrl:r},o||""}var i=t.data.popupData.id;return this.orderInfoMap[i||""]={returnUrl:r},i||""}},{key:"continueMode",value:(o=ge(Le.mark((function e(t,n){var r,o,i,a,c,s,u,l,d,f,p,h;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.createOrderParams&&!1!==this.createOrderParams.valid){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,s=pa(this.createOrderParams,this.config),e.next=6,wt(s);case 6:if(u=e.sent,null==(l=null===(r=u.data)||void 0===r?void 0:r.data)||!l.errorInfo){e.next=11;break}return this.handleError(new Error("Place order failed"),Ne.CreateExpected,{errorInfo:null==l?void 0:l.errorInfo}),e.abrupt("return","");case 11:if(!(d=(null===(o=u.data)||void 0===o?void 0:o.code)||(null===(i=u.data)||void 0===i||null===(a=i.data)||void 0===a||null===(c=a.paymentError)||void 0===c?void 0:c.code))||"SUCCESS"===d){e.next=15;break}return this.handleError(new Error("prepare-pay request failed"),Ne.Pay,{tags:{code:d},res:u.data}),e.abrupt("return","");case 15:if(va(f=JSON.parse((null==l?void 0:l.nextAction)||"{}"))){e.next=19;break}return this.handleError(new Error("prepare-pay response illegal"),Ne.Pay,{res:u.data}),e.abrupt("return","");case 19:return p={nextAction:f,context:null==l?void 0:l.context},this.logger.info("continueMode",{data:{data:l,payOptions:p,actions:n}}),e.next=23,this.handlePay(p);case 23:return(h=e.sent)&&Ct(this.config.onChannelModalSuccess)&&this.config.onChannelModalSuccess(this.config.paymentInfo),e.abrupt("return",h);case 28:return e.prev=28,e.t0=e.catch(2),this.handleError(e.t0,Ne.Pay),e.abrupt("return","");case 32:case"end":return e.stop()}}),e,this,[[2,28]])}))),function(e,t){return o.apply(this,arguments)})},{key:"payNowMode",value:(r=ge(Le.mark((function e(t,n){var r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Ct(this.config.createOrder)){e.next=13;break}return e.next=4,this.config.createOrder(this.config.paymentInfo,t,n);case 4:if(r=e.sent,this.logger.info("payNowMode, createOrder input parameters",{data:Sa({},r)}),!1!==r.valid){e.next=9;break}return this.logger.log("Business side input parameter exception, process interrupted",{data:Sa({},r)}),e.abrupt("return","");case 9:if(va(null==r?void 0:r.nextAction)){e.next=12;break}return this.handleError(new Error("prepare-pay response illegal"),Ne.Pay,{res:r}),e.abrupt("return","");case 12:return e.abrupt("return",this.handlePay(r));case 13:return e.abrupt("return","");case 16:return e.prev=16,e.t0=e.catch(0),this.handleError(e.t0,Ne.Pay),e.abrupt("return","");case 20:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e,t){return r.apply(this,arguments)})},{key:"handleRenderTimeout",value:function(e){var t,n,r=this;ba&&(ba.disconnect(),ba=null),this.initTimer=setTimeout((function(){var t,n,o,i;r.element&&(r.element.innerHTML="");var a=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;ba=new a((function(e){e.forEach((function(){r.element&&(r.element.innerHTML="")}))})),r.element&&ba.observe(r.element,{childList:!0,attributes:!1,subtree:!1}),setTimeout((function(){ba&&(ba.disconnect(),ba=null)}),5e3),r.handleError(new Error("[Init rendering failed][Call onInit timeout][Current timeout time: ".concat(null===(t=r.config.props)||void 0===t||null===(n=t.buttonTimeoutConfig)||void 0===n?void 0:n.timeoutMillis,"ms]")),Ne.Init),e(new Error("[Init rendering failed][Call onInit timeout][Current timeout time: ".concat(null===(o=r.config.props)||void 0===o||null===(i=o.buttonTimeoutConfig)||void 0===i?void 0:i.timeoutMillis,"ms]")))}),null===(t=this.config.props)||void 0===t||null===(n=t.buttonTimeoutConfig)||void 0===n?void 0:n.timeoutMillis)}},{key:"setDisabled",value:function(e){if(this.element)try{if(e)return this.initActions&&this.initActions.disable(),void this.element.classList.add(Nt);this.initActions&&this.initActions.enable(),this.element.classList.remove(Nt)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("This error does not affect functionality, no need to address",e)}}},{key:"beforeInit",value:function(){this.initTime=Pt.now(),Ct(this.config.beforeInit)&&this.config.beforeInit()}},{key:"afterInit",value:function(e,t){try{this.initSuccess=!0,this.showButton();var n=Pt.now()-this.initTime;this.logger.info("afterInit",{data:{data:e,actions:t,duration:n,level:ha(n)}}),Ct(this.config.afterInit)&&this.config.afterInit()}catch(e){this.handleError(e)}}},{key:"beforeCreateOrder",value:(n=ge(Le.mark((function e(){var t,n,r,o,i;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ct(this.config.beforeCreateOrder)){e.next=2;break}return e.abrupt("return");case 2:return t=this.config.paymentInfo,n=t.channelCode,r=t.methodCode,o=t.paymentId,e.next=5,this.config.beforeCreateOrder({channelCode:n,methodCode:r,paymentId:o});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"afterCreateOrder",value:function(e){Ct(this.config.afterCreateOrder)&&this.config.afterCreateOrder(e,{channelCode:Re.Paypal,methodCode:Me.Paypal})}},{key:"removeSkeleton",value:function(e){var t=this,n=null;n&&clearTimeout(n),n=setTimeout((function(){e&&(t.skeleton&&e.removeChild(t.skeleton),t.isContinueMode&&e.classList.add("paypal__bg"))}),300)}},{key:"specialParamsByScenes",get:function(){var e,t,n=this;return this.isSubscription?{actions:{createBillingAgreement:(e=ge(Le.mark((function e(t,r){var o;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.logger.log("createBillingAgreement PayPal starting to place order",{data:{data:t,actions:r}}),e.prev=1,!n.isContinueMode){e.next=8;break}return e.next=5,n.continueMode(t,r);case 5:e.t1=e.sent,e.next=11;break;case 8:return e.next=10,n.payNowMode(t,r);case 10:e.t1=e.sent;case 11:if(e.t0=e.t1,e.t0){e.next=14;break}e.t0="";case 14:return o=e.t0,n.afterCreateOrder(o?qe.Success:qe.Fail),e.abrupt("return",o);case 19:return e.prev=19,e.t2=e.catch(1),n.afterCreateOrder(qe.Fail),e.abrupt("return","");case 23:case"end":return e.stop()}}),e,null,[[1,19]])}))),function(t,n){return e.apply(this,arguments)})}}:{actions:{createOrder:(t=ge(Le.mark((function e(t,r){var o;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.logger.log("createOrder PayPal starting to place order",{data:{data:t,actions:r}}),e.prev=1,!n.isContinueMode){e.next=8;break}return e.next=5,n.continueMode(t,r);case 5:e.t1=e.sent,e.next=11;break;case 8:return e.next=10,n.payNowMode(t,r);case 10:e.t1=e.sent;case 11:if(e.t0=e.t1,e.t0){e.next=14;break}e.t0="";case 14:return o=e.t0,n.afterCreateOrder(o?qe.Success:qe.Fail),e.abrupt("return",o);case 19:return e.prev=19,e.t2=e.catch(1),n.afterCreateOrder(qe.Fail),e.abrupt("return","");case 23:case"end":return e.stop()}}),e,null,[[1,19]])}))),function(e,n){return t.apply(this,arguments)})}}}},{key:"render",value:(t=ge(Le.mark((function e(){var t,n,r,o,i,a,c=this;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.config,r=n.props,o=n.paymentInfo,i=document.getElementById(o.currentDomId),!r.dynamic){e.next=5;break}return e.next=5,this.handleDynamic();case 5:if(!this.isHidePayPalButton){e.next=7;break}return e.abrupt("return",null);case 7:if(!this.isRendered){e.next=9;break}return e.abrupt("return",null);case 9:if(i){e.next=12;break}return this.handleError(new Error("[onError][Initialization failed][Could not find mounted DOM]"),Ne.Init,{domId:o.currentDomId}),e.abrupt("return",null);case 12:return this.element=i,a=wa({node:i,domId:o.currentDomId,height:(null===(t=r.styleOptions)||void 0===t?void 0:t.height)||"",isContinueMode:this.isContinueMode,isVerticalLayout:this.isVerticalLayout,wrapperClass:r.wrapperClass,wrapperStyle:r.wrapperStyle}),this.skeleton=a,this.logger.log("render start",{data:{config:this.config}}),this.beforeInit(),e.abrupt("return",new Promise((function(e,t){r.buttonTimeoutConfig&&r.buttonTimeoutConfig.enable&&c.handleRenderTimeout(t);var n,a,s,u=null,l=Sa({domId:o.currentDomId,clientId:r.clientId,currency:o.settleCurrency,queryParams:r.queryParams,scriptParams:r.scriptParams,style:Sa(Sa(Sa({},r.styleOptions),c.expressButtonConfig),{},{disableMaxWidth:!0}),onInit:function(t,n){c.logger.info("onInit"),c.afterInit(t,n),c.initTimer&&clearTimeout(c.initTimer),c.initActions=n,e(u)},onClick:(s=ge(Le.mark((function e(t,n){var r,o;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.beforeCreateOrder();case 2:if(o=e.sent,c.logger.log("onClick, user clicked the button",{data:{data:t,params:o,actions:n}}),o){e.next=6;break}return e.abrupt("return");case 6:if(!1!==o.valid){e.next=8;break}return e.abrupt("return",n.reject());case 8:null===(r=c.initActions)||void 0===r||r.enable(),c.isContinueMode&&(c.createOrderParams=o);case 10:case"end":return e.stop()}}),e)}))),function(e,t){return s.apply(this,arguments)}),onApprove:(a=ge(Le.mark((function e(t,n){var r,o,i;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(o=null===(r=c.orderInfoMap[t.orderID])||void 0===r?void 0:r.returnUrl)!==c.returnUrl&&c.logger.error("Front-end recorded returnUrl does not match this.returnUrl",{action:Ne.Pay,data:{orderId:t.orderID,map:c.orderInfoMap,url:c.returnUrl}}),i=o||c.returnUrl,c.logger.log("onApprove PayPal order placed successfully, triggering callback",{data:{data:t,returnUrl:i,actions:n}}),Ct(c.config.onApprove)&&c.config.onApprove(t,n),window.location.href=i;case 6:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)}),onCancel:(n=ge(Le.mark((function e(t,n){var r;return Le.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.logger.log("user cancelled payment",{data:t}),!Ct(null==n?void 0:n.redirect)||!Ct(c.config.onCancel)){e.next=6;break}return e.next=4,c.config.onCancel(t);case 4:r=e.sent,null==n||n.redirect(r);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)}),onError:function(e,n,r){c.handleError(e,n,r),t(e)}},c.specialParamsByScenes.actions);(u=new at(l)).render().then((function(){c.loadResourceFail=!1})).catch((function(e){c.loadResourceFail=!0,c.handleError(new Error("Load Paypal resource failed"),Ne.Init,{error:e}),t(e)})),u&&c.removeSkeleton(i)})));case 18:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),c}();Pa=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":N(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}([At],Pa);var Ia,xa,Ta=Pa;function ja(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aa(e,t){return Aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Aa(e,t)}function La(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Aa(e,t)}function Da(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ja(e)}function Na(e){return Na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Na(e)}!function(e){e.TEXT="text",e.I18N_CODE="i18n_code"}(Ia||(Ia={})),function(e){e.NonGray="NON_GRAY",e.GrayForAbort="GRAY_FOR_ABORT",e.GrayForTips="GRAY_FOR_TIPS"}(xa||(xa={}));var Ba,Ra,Ma,Fa,Ha={BUY_NOW:"pay-button-buy-now",MORE_OPTIONS:"pay-button-more-options",CHECKOUT:"pay-button-checkout",PAY_PAL:"pay-button-Paypal",APPLE_PAY:"pay-button-ApplePay",GOOGLE_PAY:"pay-button-GooglePay",SHOP_BY_FAST_CHECKOUT:"pay-button-shop-by",COMMON_ITEM_LAYOUT:"pay-button-common-item-layout",COMMON_ITEM:"pay-button-common-item",COMMON_ITEM_EXPRESS:"pay-button-common-item-express",BUTTON_SUBSCRIPTION:"pay-button-subscription",BUTTON_CUSTOM:"pay-button-custom",BUTTON_LOADING:"pay-button-loading",BUTTON_DISABLED:"pay-button-disabled",BUTTON_HIDE:"pay-button-hide",BUTTON_MASK:"pay-button-mask",BUTTON_SKELETON:"pay-button-skeleton",BUTTON_COLLAPSE:"pay-button-collapse",PAY_PAL_BG_BEFORE:"pay-button-Paypal-bg-before",PAY_PAL_BG_AFTER:"pay-button-Paypal-bg-after"},Ua="smart-payment-hide",qa="pay-button-more-options-theme-color",Ya={height:48,width:null,"border-radius":0},Ga=Or(),Va=function(){function e(t){var n=this;w(this,e),S(this,"needRender",!1),S(this,"buttonElement",null),S(this,"isLoading",!1),S(this,"isDisabled",!1),S(this,"isVisible",!1),S(this,"disabledMessage",""),S(this,"setLoading",(function(e){n.logger.info("setLoading",{data:{bool:e}}),n.isLoading=e;var t=n.buttonElement;e?null==t||t.classList.add(Ha.BUTTON_LOADING):null==t||t.classList.remove(Ha.BUTTON_LOADING)})),S(this,"setDisabled",(function(e,t){if(n.logger.info("setDisabled",{data:{value:e,options:t}}),n.needRender){n.isDisabled=e,n.disabledMessage=Ga("products.product_list.select_product_all_options"),null!=t&&t.message&&(n.disabledMessage=t.message);var r=n.buttonElement;e?null==r||r.classList.add(Ha.BUTTON_DISABLED):null==r||r.classList.remove(Ha.BUTTON_DISABLED)}})),S(this,"setVisible",(function(e){if(n.logger.info("setVisible",{data:{value:e}}),n.needRender){n.isVisible=e;var t=n.buttonElement;e?null==t||t.classList.remove(Ha.BUTTON_HIDE):null==t||t.classList.add(Ha.BUTTON_HIDE)}})),S(this,"renderedList",[]),this.config=t,this.container=document.getElementById(t.domId),this.logger=this.config.props.logger}return k(e,[{key:"getRenderedList",value:function(){return this.isVisible?this.renderedList:[]}}]),e}();!function(e){e.ProductDetail="productDetail",e.Cart="cart",e.Checkout="checkout"}(Ra||(Ra={})),function(e){e.Normal="normalButton",e.Express="expressCheckoutButton",e.Fast="fastCheckoutButton"}(Ma||(Ma={})),function(e){e.BUY_NOW="BUY_NOW",e.MORE_OPTIONS="MORE_OPTIONS",e.CHECKOUT="CHECKOUT",e.PAY_PAL="PAY_PAL",e.APPLE_PAY="APPLE_PAY",e.GOOGLE_PAY="GOOGLE_PAY",e.SHOP_BY_FAST_CHECKOUT="SHOP_BY_FAST_CHECKOUT"}(Fa||(Fa={}));var za,Wa=(S(Ba={},Me.Paypal,Fa.PAY_PAL),S(Ba,Me.ApplePay,Fa.APPLE_PAY),S(Ba,Me.GooglePay,Fa.GOOGLE_PAY),Ba);!function(e){e.ButtonClick="buttonClick",e.ModalOpen="modalOpen"}(za||(za={}));var Ka,Xa=[Fa.PAY_PAL,Fa.APPLE_PAY,Fa.GOOGLE_PAY];function Ja(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ja(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ja(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.Column="column",e.Row="row",e.BuyNowRow="buyNowRow",e.Checkout="checkout"}(Ka||(Ka={}));var Za,Qa,ec,tc=function(e){return e.buttonTypeDataList.map((function(e){return e.buttonNameDataList})).reduce((function(e,t){return e.concat.apply(e,v(t))}),[]).map((function(e){return e.buttonName}))},nc=function(e){return e.isSystem},rc=function(e){return e.className.includes(Ha.BUY_NOW)?Fa.BUY_NOW:e.className.includes(Ha.MORE_OPTIONS)?Fa.MORE_OPTIONS:e.className.includes(Ha.PAY_PAL)?Fa.PAY_PAL:e.className.includes(Ha.GOOGLE_PAY)?Fa.GOOGLE_PAY:e.className.includes(Ha.APPLE_PAY)?Fa.APPLE_PAY:e.className.includes(Ha.SHOP_BY_FAST_CHECKOUT)?Fa.SHOP_BY_FAST_CHECKOUT:void 0},oc={exports:{}};!function(e){function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==E?E:"undefined"!=typeof self?self:{},o=1/0,i=17976931348623157e292,a=NaN,c="[object Symbol]",s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt,p="object"==_(r)&&r&&r.Object===Object&&r,h="object"==("undefined"==typeof self?"undefined":_(self))&&self&&self.Object===Object&&self,y=p||h||Function("return this")(),v=Object.prototype.toString,m=y.Symbol,g=Math.min,b=m?m.prototype:void 0,w=b?b.toString:void 0;function O(e){var t=_(e);return!!e&&("object"==t||"function"==t)}function C(e){return"symbol"==_(e)||function(e){return!!e&&"object"==_(e)}(e)&&v.call(e)==c}function k(e){if("number"==typeof e)return e;if(C(e))return a;if(O(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=O(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=l.test(e);return n||d.test(e)?f(e.slice(2),n?2:8):u.test(e)?a:+e}function S(e){return null==e?"":function(e){if("string"==typeof e)return e;if(C(e))return w?w.call(e):"";var t=e+"";return"0"==t&&1/e==-o?"-0":t}(e)}var P,I,x,T,j,A=function(e){var t=Math[e];return function(e,n){if(e=k(e),n=g(function(e){var t=function(e){return e?(e=k(e))===o||e===-o?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}(n),292)){var r=(S(e)+"e").split("e");return+((r=(S(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}("round"),L="CNY",D=2,N={amount:{value:"amount",decimalSymbol:".",groupSymbol:",",format:"amount"},amount_no_decimals:{value:"amount_no_decimals",decimalSymbol:"",groupSymbol:",",format:"amount_no_decimals"},amount_with_comma_separator:{value:"amount_with_comma_separator",decimalSymbol:",",groupSymbol:".",format:"amount_with_comma_separator"},amount_no_decimals_with_comma_separator:{value:"amount_no_decimals_with_comma_separator",decimalSymbol:"",groupSymbol:".",format:"amount_no_decimals_with_comma_separator"},amount_with_apostrophe_separator:{value:"amount_with_apostrophe_separator",decimalSymbol:".",groupSymbol:"'",format:"amount_with_apostrophe_separator"},amount_no_decimals_with_space_separator:{value:"amount_no_decimals_with_space_separator",decimalSymbol:"",groupSymbol:" ",format:"amount_no_decimals_with_space_separator"},amount_with_space_separator:{value:"amount_with_space_separator",decimalSymbol:",",groupSymbol:" ",format:"amount_with_space_separator"}},B=/.*\{\{(.*)\}\}/,R=/(\{\{.*\}\})/,M="amount";!function(e){e.PREFIX="prefix",e.SUFFIX="suffix"}(P||(P={}));var F=Object.entries(N).map((function(e){return t(e,2)[1].value})),H=new Map,U=new Map,q=new Map,Y=new Map,G=new Map,V=new Map,z=new Map,W=new Map,K=new Map,X=function(e){T=e},J=function(){return T},$=function(){return j},Z=function(e){return F.includes(e||"")},Q=function(e){var t=e.match(B);if(t&&t.length){var n=(t[1]||"").trim();return Z(n)?N[n]:null}return null},ee=function(e,t,n){var r=n?V:G,o=Q(t),i=r.get(e),a=i&&i.format;return o||(Z(a)?N[a]:N[M])},te=function(e){return Q(e)||N[M]},ne=function(e,t,n){var r,o,i=e.match(B);return null!=i&&i.length&&F.includes((null==i||null===(r=i[1])||void 0===r?void 0:r.trim())||"")?e:(null===(o=(n?V:G).get(t))||void 0===o?void 0:o.origin)||"{{amount}}"},re=function(e,t){var n=te(t).format;G.set(e,{format:n,origin:t})},oe=function(e,t){var n=te(t).format;V.set(e,{format:n,origin:t})},ie=function(e,t){var n=ee(e,t,!1),r=n.format,o=n.decimalSymbol,i=n.groupSymbol;W.set(e,o),K.set(e,i),q.set(e,{format:r,origin:ne(t,e,!1)})},ae=function(e,t){var n=ee(e,t,!0),r=n.format,o=n.decimalSymbol,i=n.groupSymbol;W.set(e,o),K.set(e,i),Y.set(e,{format:r,origin:ne(t,e,!0)})},ce=function(e){var t=function(e){return $().find((function(t){return t.currencyCode===e}))}(e);if(t){var n=t.messageWithoutDefaultCurrency,r=t.messageWithCurrency,o=t.messageWithoutCurrency,i=t.messageWithDefaultCurrency,a=t.currencyCode,c=t.rate,s=void 0===c?D:c,u=t.currencySymbol;(function(e,t){H.set(e,t)})(a,s),function(e,t){U.set(e,t)}(a,u),function(e,t){t?(null==t?void 0:t.replace(/^\s+/,"").indexOf("{{"))>0?z.set(e,P.PREFIX):z.set(e,P.SUFFIX):window[window.__sl_console__?"__sl_console__":"console"].error("".concat(e,"messageWithoutDefaultCurrency"))}(a,n),re(a,n),oe(a,i),ie(a,o),ae(a,r)}else window[window.__sl_console__?"__sl_console__":"console"].error("".concat(e,""))},se=function(e,t,n){var r=N[t],o=r.groupSymbol,i=r.decimalSymbol,a=e<0,c=function(e,t,n){var r,o,i=A(e,t);return 0!==t&&n?(r=Math.floor(i),o="".concat(A(i-r,t)).replace(/^0?\.?/,"").padEnd(t,"0")):(r=A(i),o=""),{integerPart:r,fractionPart:o}}(a?-e:e,n,i),s=c.fractionPart,u=function(e,t){return"".concat(e||0).replace(/(\d)(?=(?:\d{3})+$)/g,"$1".concat(t))}(c.integerPart,o);return{integer:"".concat(a?"-":"").concat(u),fraction:s,groupSymbol:o,decimalSymbol:i}},ue=function(e,t){var n,r=(null==t?void 0:t.code)||I||L;q.get(r)||ce(r);var o=we(r),i=be(r),a=ye(r),c=ve(r),s=(q.get(r)||{}).format,u=Z(s)?s:M,l=se(e,u,D),d=l.integer,f=l.fraction,p=[],h=(null==d?void 0:d.split(o))||[];return h.forEach((function(e,t){p.push({type:"integer",value:e}),t!==h.length-1&&p.push({type:"group",value:o})})),p.push({type:"decimal",value:i}),p.push({type:"fraction",value:null!==(n=null==f?void 0:f.trim())&&void 0!==n?n:""}),"prefix"===c?p.unshift({type:"currency",value:a}):p.push({type:"currency",value:a}),p},le=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x,i=(arguments.length>3?arguments[3]:void 0)||J();return r===o?e:e*(null!==(t=i[o])&&void 0!==t?t:1)/(null!==(n=i[r])&&void 0!==n?n:1)},de=function(e,t,n){var r=t?Y:q,o=t?pe:he,i=n||{},a=i.from,c=void 0===a?I:a,s=i.to,u=void 0===s?x:s,l=i.currencyRates;r.get(c)||ce(c),r.get(u)||ce(u);var d=l||J();return o(le(e,c,u,d),{code:u})},fe=function(e,t,n){var r,o=t?Y:q,i=(null==n?void 0:n.code)||I||L;o.get(i)||ce(i);var a=o.get(i)||{},c=a.format,s=a.origin,u=null!==(r=null==n?void 0:n.digits)&&void 0!==r?r:D,l=Z(c)?c:M,d=se(e/Math.pow(10,u),l,u),f=d.integer,p=d.fraction,h=d.decimalSymbol;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").replace(R,e)}(h&&u?"".concat(f).concat(h).concat(p):f,s)},pe=function(e,t){return fe(e,!0,t)},he=function(e,t){return fe(e,!1,t)},ye=function(e){var t;return q.get(e)||ce(e),null!==(t=U.get(e))&&void 0!==t?t:""},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L;return q.get(e)||ce(e),z.get(e)},me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D;return("number"!=typeof e?Number(e):e)/Math.pow(10,t)},ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D;return A(("number"!=typeof e?Number(e):e)*Math.pow(10,t),0)},be=function(e){var t;return q.get(e)||ce(e),null!==(t=W.get(e))&&void 0!==t?t:""},we=function(e){var t;return q.get(e)||ce(e),null!==(t=K.get(e))&&void 0!==t?t:""};e.convertCalc=le,e.convertFormat=function(e,t){return de(e,!0,t)},e.convertFormatWithoutCurrency=function(e,t){return de(e,!1,t)},e.covertCalc=le,e.defaultCurrency=L,e.defaultCurrencyDigit=D,e.defaultPresentDigit=2,e.format=pe,e.formatCurrency=function(e){return me(e,D)},e.formatMoneyWithoutCurrency=function(e,t){var n=q,r=(null==t?void 0:t.code)||I||L;n.get(r)||ce(r);var o=(n.get(r)||{}).format,i=Z(o)?o:M,a=D,c=se(e/Math.pow(10,a),i,a),s=c.integer,u=c.fraction,l=c.decimalSymbol;return l&&a?"".concat(s).concat(l).concat(u):s},e.formatNumber=me,e.formatPercent=function(e){return me(e,2)},e.formatWithoutCurrency=he,e.getConvertPrice=function(e,t){var n=null!=t?t:{},r=n.from,o=n.code,i=n.to,a=n.currencyRates,c=r||I||L;q.get(c)||ce(c);var s=i||o||x;q.get(s)||ce(s);var u=me(e),l=le(u,c,s,a||T),d=ue(l,{code:s}),f={group:"",integer:"",decimal:"",fraction:"",symbolOrder:"",currencySymbol:""},p=ve(s);return p&&(f.symbolOrder=p),d.forEach((function(e){var t=e.value;"currency"===e.type&&(f.currencySymbol=t),"integer"===e.type&&(f.integer?f.integer="".concat(f.integer).concat(f.group).concat(t):f.integer=t),"group"===e.type&&(f.group=t),"decimal"===e.type&&(f.decimal=t),"fraction"===e.type&&(f.fraction=t)})),f},e.getCurrencyConfig=$,e.getCurrencyRates=J,e.getDecimalSymbolByCode=be,e.getDefaultToCurrency=function(){return x},e.getDigitsByCode=function(e){return q.get(e)||ce(e),H.get(e)},e.getFormatParts=ue,e.getGroupSymbolByCode=we,e.getStoreCurrency=function(){return I},e.getSymbolByCode=ye,e.getSymbolOrderByCode=ve,e.parseCustomFormat=ee,e.parseCustomFormatWithCurrency=ae,e.parseCustomFormatWithoutCurrency=ie,e.parseDefaultFormat=te,e.parseDefaultFormatWithCurrency=oe,e.parseDefaultFormatWithoutCurrency=re,e.setCurrencyConfig=function(e){var t={};(j=e).forEach((function(e){t[e.currencyCode]=e.exchangeRate})),X(t),"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)&&(H.clear(),U.clear(),q.clear(),Y.clear(),G.clear(),V.clear(),z.clear(),W.clear(),K.clear())},e.setCurrencyRates=X,e.setDefaultToCurrency=function(e){x=e},e.setStoreCurrency=function(e){I=e},e.unformatCurrency=function(e){return ge(e,D)},e.unformatNumber=ge,e.unformatPercent=function(e){return ge(e,2)},Object.defineProperty(e,"__esModule",{value:!0})}(oc.exports),function(e){e.PayButtonView="View",e.PayButtonClick="",e.InitiateCheckout="InitiateCheckout",e.AddCustomerInfo="AddCustomerInfo",e.AddShippingInfo="AddShippingInfo",e.AddPaymentInfo="AddPaymentInfo",e.FastCheckout="FastCheckout"}(ec||(ec={}));var ic=(S(Za={FastCheckout:158},Ra.ProductDetail,159),S(Za,Ra.Cart,162),S(Za,Ra.Checkout,163),Za),ac=(S(Qa={Other:-999},Fa.BUY_NOW,102),S(Qa,Fa.MORE_OPTIONS,102),S(Qa,Fa.PAY_PAL,103),S(Qa,Fa.APPLE_PAY,180),S(Qa,Fa.GOOGLE_PAY,181),S(Qa,Fa.SHOP_BY_FAST_CHECKOUT,182),Qa);function cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uc,lc=function(e){window.HdSdk&&window.HdSdk.shopTracker&&window.HdSdk.shopTracker.collect(e)},dc={reportConversionEvent:function(e,t){var n=t.currency,r=t.orderAmount,o=t.productInfos,i=t.shipping_method,a=this.generateReportData(e,{currency:n,orderAmount:r,productInfos:o,shipping_method:i});lc(a)},reportAddPaymentInfo:function(e){var t=e.currency,n=e.orderAmount,r=e.productInfos,o=e.payment_method,i=e.coupon_code,a=e.shipping_method,c=e.basicInfo,s=sc(sc({},this.generateReportData(ec.AddPaymentInfo,{currency:t,orderAmount:n,productInfos:r,basicInfo:c,shipping_method:a})),{},{payment_method:o,coupon_code:i});lc(s)},generateReportData:function(e,t){if(e){var n=this.generateProductParams(e,{productInfos:t.productInfos||[]}),r=t.orderAmount||0,o=sc(sc({page:-999,component:ac.Other,module:ic.FastCheckout,action_type:-999,billing_address_status:1,event_name:e,value:oc.exports.formatNumber(r).toString(),currency:t.currency,referral_code:""},n),{},{payment_method:t.payment_method,coupon_code:"",shipping_method:t.shipping_method});if(e===ec.AddPaymentInfo){var i=sessionStorage.getItem("tradeAttributeInfo");if(i){var a=(JSON.parse(i)||{}).referralCode;o.referral_code=a?a.value:void 0}}else delete o.referral_code,delete o.payment_method,delete o.coupon_code;return e!==ec.AddPaymentInfo&&delete o.billing_address_status,e!==ec.AddShippingInfo&&delete o.shipping_method,o}},generateProductParams:function(e,t){var n=t.productInfos,r=new Set,o=[],i=0;return n.forEach((function(e){i+=e.productNum||0,o.push(e.productSku||""),r.add(e.productSeq||"")})),{content_ids:v(r.values()).join(","),variantion_id:o.join(","),quantity:i.toString()}},reportPayButtonView:function(e,t){var n={event_name:ec.PayButtonView,page:"",module:ic[t],component:ac[e],action_type:101};lc(n)},reportPayButtonClick:function(e,t){lc({event_name:"",page:"",module:ic[t],component:ac[e],action_type:102})},reportFastCheckout:function(e){var t={event_name:ec.FastCheckout,component:ac[e],fastcheckout_type:e};lc(t)}},fc=new Uint8Array(16);function pc(){if(!uc&&!(uc="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return uc(fc)}for(var hc=[],yc=0;yc<256;++yc)hc.push((yc+256).toString(16).slice(1));var vc={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function mc(e,t,n){if(vc.randomUUID&&!t&&!e)return vc.randomUUID();var r=(e=e||{}).random||(e.rng||pc)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(hc[e[t+0]]+hc[e[t+1]]+hc[e[t+2]]+hc[e[t+3]]+"-"+hc[e[t+4]]+hc[e[t+5]]+"-"+hc[e[t+6]]+hc[e[t+7]]+"-"+hc[e[t+8]]+hc[e[t+9]]+"-"+hc[e[t+10]]+hc[e[t+11]]+hc[e[t+12]]+hc[e[t+13]]+hc[e[t+14]]+hc[e[t+15]]).toLowerCase()}(r)}var gc=function(){return Number(Math.random().toString().slice(2)+Date.now()).toString(36)},bc=function(e){var t=document.cookie.split("; "),n={};return t.forEach((function(e){var t=m(e.split("="),2),r=t[0],o=t[1];r&&(n[r]=o||"")})),n[e]||""},wc=function(){return"".concat(Date.now(),"_").concat(mc().replace(/-/g,""))},_c=function(e){return null===e.offsetParent},Oc=function(e){var t=document.createElement("style");return t.innerHTML=e.replace(/\/\*(.*?)\*\//g,"").replace(/\s+/g," ").replace(/\s*([{}:;,])\s*/g,"$1"),{style:t,cssInsertBefore:function(e){var n;return null===(n=e.parentNode)||void 0===n?void 0:n.insertBefore(t,e)}}},Cc=function(e,t){return!t||!!Array.isArray(t)&&t.includes(e)};function kc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kc(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ec,Pc,Ic,xc=Or(),Tc=function(e){return'<button type="button" class="btn btn-primary '.concat(Ha.COMMON_ITEM," ").concat(Ha.BUY_NOW," ").concat(null!=e?e:"",'" type="button">\n    <span class="').concat(Ha.BUY_NOW,'-text">').concat(xc("cart.cart.buy_now"),'</span><span class="loading-icon" /></button>')},jc=function(e){La(n,Va);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Na(e);if(t){var o=Na(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Da(this,n)}}(n);function n(e){var r;w(this,n),S(ja(r=t.call(this,e)),"customHandleClick",null),S(ja(r),"render",function(){var e=b(D.mark((function e(t){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.logger.info("render"),r.needRender){e.next=3;break}return e.abrupt("return",[]);case 3:return n=r.insertDom(t),r.addListener(),r.renderedList=n,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(ja(r),"setSubscription",(function(e){var t;if(r.logger.info("setSubscription",{data:{value:e}}),r.needRender){var n=null===(t=r.container)||void 0===t?void 0:t.querySelectorAll(".".concat(Ha.COMMON_ITEM_EXPRESS)),o=nc(r.config.paymentConfig);n&&o&&(Boolean(v(n).find((function(e){return!_c(e)})))?r.render(Fa.MORE_OPTIONS):r.render(Fa.BUY_NOW),r.setVisible(!0))}})),S(ja(r),"customButton",(function(e,t){var n,o;if(r.logger.log("customBuyNow",{data:Sc({buttonName:e},t)}),r.needRender){var i,a,c,s,u,l,d=t.className,f=t.handle;if((e!==Fa.BUY_NOW||null!==(n=r.buttonElement)&&void 0!==n&&n.className.includes(Ha.BUY_NOW))&&(e!==Fa.MORE_OPTIONS||null!==(o=r.buttonElement)&&void 0!==o&&o.className.includes(Ha.MORE_OPTIONS)))d&&(null===(i=r.buttonElement)||void 0===i||(a=i.classList).add.apply(a,v(d.split(" ")))),f&&(null===(c=r.buttonElement)||void 0===c||c.classList.add(Ha.BUTTON_CUSTOM),null===(s=r.buttonElement)||void 0===s||s.removeEventListener("click",r.handleClick),r.customHandleClick&&(null===(u=r.buttonElement)||void 0===u||u.removeEventListener("click",r.customHandleClick)),r.customHandleClick=function(){return f(r.handleClick)},null===(l=r.buttonElement)||void 0===l||l.addEventListener("click",r.customHandleClick))}})),S(ja(r),"insertDom",(function(e){var t,n=r.config,o=n.paymentConfig,i=n.props,a=i.layout,c=i.extraBuyNowDomId,s=tc(o),u=nc(o),l=s.includes(Fa.BUY_NOW);r.logger.info("insertDom data",{data:{isDynamic:u,hasBuyNow:l}});var d,f,p=Tc(Ha.BUTTON_HIDE),h='\n      <div class="'.concat(Ha.MORE_OPTIONS," ").concat(Ha.BUTTON_HIDE,'">\n        ').concat(xc("products.product_details.more_payment_options"),"\n      </div>\n    ");if(null===(t=r.container)||void 0===t||t.querySelectorAll(".".concat(Ha.BUY_NOW,", .").concat(Ha.MORE_OPTIONS)).forEach((function(e){return e.remove()})),e===Fa.BUY_NOW||!e&&l){if(a===Ka.BuyNowRow&&c){r.logger.info("BuyNowRow layout render buy now");var y=document.getElementById(c);y&&(y.innerHTML=p,r.buttonElement=(null==y?void 0:y.querySelector(".".concat(Ha.BUY_NOW)))||null)}else{var v,m;r.logger.info("normal render buy now"),null===(v=r.container)||void 0===v||v.insertAdjacentHTML("afterbegin",p),r.buttonElement=(null===(m=r.container)||void 0===m?void 0:m.querySelector(".".concat(Ha.BUY_NOW)))||null}return[Fa.BUY_NOW]}return e===Fa.MORE_OPTIONS||u?(r.logger.info("render more payment options"),null===(d=r.container)||void 0===d||d.insertAdjacentHTML("beforeend",h),r.buttonElement=(null===(f=r.container)||void 0===f?void 0:f.querySelector(".".concat(Ha.MORE_OPTIONS)))||null,[Fa.MORE_OPTIONS]):[]})),S(ja(r),"addListener",(function(){var e=ja(r).buttonElement;e&&(e.removeEventListener("click",r.handleClick),e.addEventListener("click",r.handleClick))})),S(ja(r),"handleClick",b(D.mark((function e(){var t,n,o,i,a,c,s,u,l;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.config,n=t.paymentConfig.buttonLocation,o=t.saveAbandonedOrder,i=t.props,a=i.isPreview,c=i.toast,dc.reportPayButtonClick(Fa.BUY_NOW,n),!a){e.next=6;break}return r.logger.info("toast"),c(xc("products.product_details.link_preview_does_not_support")),e.abrupt("return");case 6:if(!r.isDisabled){e.next=10;break}return r.logger.info("",{data:{isDisabled:r.isDisabled}}),c(r.disabledMessage),e.abrupt("return");case 10:if(!r.isLoading){e.next=13;break}return r.logger.info("",{data:{isLoading:r.isLoading}}),e.abrupt("return");case 13:return r.setLoading(!0),e.next=16,o(r.renderedList[0]||Fa.BUY_NOW);case 16:if(s=e.sent,u=s.canContinue,l=s.url,u){e.next=22;break}return r.setLoading(!1),e.abrupt("return");case 22:l&&(r.logger.info("jump to checkout",{data:l}),window.location.href=l);case 23:case"end":return e.stop()}}),e)})))),S(ja(r),"destroy",(function(){var e;null===(e=r.buttonElement)||void 0===e||e.removeEventListener("click",r.handleClick)}));var o=e.buttonTypes;return r.logger=r.config.props.logger.pipeOwner("NormalButton"),r.needRender=Cc(Ma.Normal,o),r}return k(n)}();function Ac(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ac(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.checkout="checkout",e.orders="orders",e.payButton="payButton"}(Ec||(Ec={})),function(e){e.count="count",e.success="success",e.failed="failed"}(Pc||(Pc={})),function(e){e.third="third",e.jsErr="js",e.network="network"}(Ic||(Ic={}));var Dc,Nc,Bc,Rc,Mc,Fc,Hc,Uc,qc,Yc=(Hc=(null===(Dc=window)||void 0===Dc||null===(Nc=Dc.__ENV__)||void 0===Nc||null===(Bc=Nc.TRADE__METRIC_REPORT_CONFIG)||void 0===Bc?void 0:Bc.rate)||0,Uc=(null===(Rc=window)||void 0===Rc||null===(Mc=Rc.__ENV__)||void 0===Mc||null===(Fc=Mc.TRADE__METRIC_REPORT_CONFIG)||void 0===Fc?void 0:Fc.version)||"",qc={enable:!1,rate:Hc,init:!1},function(){try{if(qc.init)return qc;if("number"==typeof Hc&&"string"==typeof Uc){var e=1e4-Hc;qc.enable="v1"===Uc&&1e4*Math.random()>e}return qc.init=!0,qc}catch(e){return window[window.__sl_console__?"__sl_console__":"console"].warn("createMetricReportConfig error: ",e),qc}});function Gc(e,t){return Vc.apply(this,arguments)}function Vc(){return Vc=b(D.mark((function e(t,n){var r,o,i,a,c;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=Yc()).enable){e.next=11;break}if(o=[],i=ns(t,Ma.Express),a=ns(t,Ma.Fast),c=rs(t),[].concat(v(i),v(a),v(c)).forEach((function(e){o.push({owner:Ec.payButton,subOwner:ts(e),eventType:Pc.count,rate:r.rate})})),!o.length){e.next=11;break}return e.next=11,s={logs:o},gt.post("/api/bff-web/trade/metric/report/batch",Lc({},s));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),n.warn("Metric Report Error: buttonRender",{data:{config:t,error:e.t0}});case 16:case"end":return e.stop()}var s}),e,null,[[0,13]])}))),Vc.apply(this,arguments)}function zc(e,t){return Wc.apply(this,arguments)}function Wc(){return Wc=b(D.mark((function e(t,n){var r,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=rs(t),o=Yc(),r.length||!o.enable){e.next=6;break}return e.next=6,es({owner:Ec.payButton,subOwner:ts(Fa.BUY_NOW),eventType:Pc.count,rate:o.rate});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.warn("Metric Report Error: patchBuyNowRender",{data:{config:t,error:e.t0}});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),Wc.apply(this,arguments)}function Kc(e,t,n){return Xc.apply(this,arguments)}function Xc(){return(Xc=b(D.mark((function e(t,n,r){var o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==(o=Yc()).rate){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,es({owner:Ec.payButton,eventType:Pc.failed,rate:o.rate,subOwner:ts(t),errorType:Ic.jsErr,errorSource:null==r?void 0:r.stack,errorReason:null==r?void 0:r.message});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.warn("Metric Report Error: buttonRenderJsError",{data:{buttonName:t,error:e.t0}});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Jc(e,t,n){return $c.apply(this,arguments)}function $c(){return $c=b(D.mark((function e(t,n,r){var o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==(o=Yc()).rate){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,es({owner:Ec.payButton,eventType:Pc.failed,rate:o.rate,subOwner:t.methodCode,errorType:Ic.third,errorSource:t.channelCode,errorReason:null==r?void 0:r.message});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.warn("Metric Report Error: buttonRenderThirdError",{data:{config:t,error:e.t0}});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),$c.apply(this,arguments)}function Zc(e,t,n){return Qc.apply(this,arguments)}function Qc(){return Qc=b(D.mark((function e(t,n,r){var o,i;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=rs(t),!(i=o[0])){e.next=6;break}return e.next=6,Kc(i,n,r);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),n.warn("Metric Report Error: normalButtonRenderError",{data:{config:t,error:e.t0}});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),Qc.apply(this,arguments)}function es(e){return gt.post("/api/bff-web/trade/metric/report",Lc({},e))}function ts(e){switch(e){case Fa.PAY_PAL:return Me.Paypal;case Fa.GOOGLE_PAY:return Me.GooglePay;case Fa.APPLE_PAY:return Me.ApplePay;case Fa.BUY_NOW:return"BuyNow";case Fa.MORE_OPTIONS:return"MoreOptions";case Fa.CHECKOUT:return"Checkout";case Fa.SHOP_BY_FAST_CHECKOUT:return"ShopByFastCheckout";default:return e}}function ns(e,t){var n,r;return Cc(t,null==e?void 0:e.buttonTypes)&&(null===(n=e.paymentConfig.buttonTypeDataList.find((function(e){return e.buttonType===t})))||void 0===n||null===(r=n.buttonNameDataList)||void 0===r?void 0:r.map((function(e){return e.buttonName})))||[]}function rs(e){var t=nc(e.paymentConfig);return ns(e,Ma.Normal).includes(Fa.BUY_NOW)?[Fa.BUY_NOW]:t?[Fa.MORE_OPTIONS]:[]}function os(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return is(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?is(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function is(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function as(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?as(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):as(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ss=function(){function e(t){var n,r,o=this;w(this,e),S(this,"renderList",[]),S(this,"checkAllButtonsInitFail",(function(){var e=0===o.renderList.filter((function(e){return e.instance.isVisible})).length;o.logger.info("checkAllButtonsInitFail",{data:{isAllButtonInitFail:e}}),e&&Ct(o.configData.onAllButtonsInitFail)&&o.configData.onAllButtonsInitFail()})),this.configData=t,ve.set(null===(n=(r=this.configData).loggerFn)||void 0===n?void 0:n.call(r)),this.logger=ve.get().pipeOwner("SmartPayment")}var t,n,r;return k(e,[{key:"handleElement",value:function(){!function(e){var t=e.styleOptions,n=e.domId;(function(e){var t;e.styleOptions;var n=e.domId,r=document.getElementById(n),o=document.getElementById(Rt);if(r&&!o){var i=document.createElement("style");i.setAttribute("id",Rt);var a="\n    .".concat(Dt," {\n      display: none !important;\n    }\n    .").concat(Nt,"::before {\n      width: 0 !important;\n    }\n    .").concat(Nt,"::after {\n      content: '';\n      display: block;\n      z-index: 100;\n      width: 100% !important;\n      height: 100% !important;\n      border-radius: 4px;\n      cursor: not-allowed;\n      position: absolute;\n      top: 0;\n      left: 0 !important;\n      background: transparent !important;\n    }\n    .").concat(Nt," {\n      opacity: 0.3;\n    }\n\n    @keyframes rotate {\n      from {\n        transform: rotate(0deg);\n      }\n      to {\n        transform: rotate(359deg);\n      }\n    }\n\n    .").concat(Bt,"::before {\n      content: '';\n      display: inline-block;\n      background-color: black;\n      width: 100%;\n      height: 100%;\n      border-radius: 0px;\n    }\n\n    .").concat(Bt,"::after {\n      content: '';\n      display: inline-block;\n      position: absolute;\n      border: 2px solid white;\n      top: calc(50% - 8px);\n      left: calc(50% - 8px);\n      width: 16px;\n      height: 16px;\n      border-radius: 16px;\n      clip-path: polygon(0% 0%, 100% 0%, 100% 70%, 0% 70%);\n      animation: rotate 1s linear infinite;\n    }\n  ");i.innerHTML="".concat(a),null===(t=r.parentElement)||void 0===t||t.insertBefore(i,r)}})({styleOptions:t,domId:n}),function(e){var t,n=e.styleOptions,r=e.domId,o=document.getElementById(r);if(o){var i=document.createElement("style"),a="\n    #".concat(r," .express-payment-button-common-item {\n      min-height: ").concat((null==n?void 0:n.height)||48,"px;\n      width: 100%;\n    }\n  ");void 0===(null==n?void 0:n["border-radius"])&&(a+="\n      #".concat(r," .").concat(Bt,"::before {\n        border-radius: 4px;\n      }\n\n      [data-button_style=square] #").concat(r," .").concat(Bt,"::before {\n        border-radius: 0;\n      }\n\n      [data-button_style=rounded] #").concat(r," .").concat(Bt,"::before {\n        border-radius: 9999px;\n      }\n    ")),i.innerHTML="".concat(a),null===(t=o.parentElement)||void 0===t||t.insertBefore(i,o)}}({styleOptions:t,domId:n})}({styleOptions:this.configData.props.styleOptions,domId:this.configData.props.domId})}},{key:"renderPaymentItem",value:(r=b(D.mark((function e(t){var n,r,o,i,a,c,s,u,l=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=ya(cs(cs({channelCode:t.channelCode,paymentInfo:t},this.configData),{},{onError:function(e,n,r){Ct(l.configData.onError)&&l.configData.onError(e,n,cs(cs({},r),{},{channelCode:t.channelCode,methodCode:t.methodCode})),n===Ne.Init&&Jc(t,l.logger,e)}}))){e.next=6;break}return null==(r=document.getElementById(t.currentDomId))||r.classList.add(Dt),e.abrupt("return");case 6:return o=n.validate(),i=o.result,a=o.errorTip,i||this.logger.error("render error ".concat(a)),c=n.getConfig(),s=n.component,u=new s(cs({},c)),e.next=13,u.render();case 13:this.renderList.push({channelCode:c.channelCode,params:c,instance:u}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),this.logger.error("render error",{error:e.t0});case 19:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e){return r.apply(this,arguments)})},{key:"render",value:(n=b(D.mark((function e(){var t,n,r,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.logger.log("render",{data:{config:this.configData}}),this.configData.payments&&Array.isArray(this.configData.payments)||this.logger.error("render error [payments]"),e.next=5,Cr(this.configData.language||"en");case 5:this.handleElement(),t=this.configData.payments,n=os(t),e.prev=8,n.s();case 10:if((r=n.n()).done){e.next=16;break}return o=r.value,e.next=14,this.renderPaymentItem(o);case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),n.e(e.t0);case 21:return e.prev=21,n.f(),e.finish(21);case 24:this.checkAllButtonsInitFail(),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(0),this.logger.error("render error",{error:e.t1});case 30:case"end":return e.stop()}}),e,this,[[0,27],[8,18,21,24]])}))),function(){return n.apply(this,arguments)})},{key:"rerender",value:(t=b(D.mark((function e(t){var n,r,o,i,a,c,s,u,l,d,f,p=this;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=this.renderList,this.logger.info("rerender start",{action:Ne.ReRender,data:{renderList:n.map((function(e){return e.channelCode}))}}),r=os(n),e.prev=4,r.s();case 6:if((o=r.n()).done){e.next=14;break}if(i=o.value,!(a=i.instance).loadResourceFail){e.next=12;break}return e.next=12,a.render();case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:c=os(t),e.prev=23,u=D.mark((function e(){var t,r,o,i,a,c;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.value,r=n.find((function(e){var n,r=(null===(n=e.instance.config)||void 0===n?void 0:n.paymentInfo)||{},o=r.channelCode,i=r.methodCode;return o===t.channelCode&&i===t.methodCode}))){e.next=6;break}return e.next=5,p.renderPaymentItem(t);case 5:return e.abrupt("return","continue");case 6:r.instance.initSuccess&&!r.instance.isVisible&&(null===(o=(i=r.instance).showButton)||void 0===o||o.call(i),null===(a=(c=p.configData).afterInit)||void 0===a||a.call(c));case 7:case"end":return e.stop()}}),e)})),c.s();case 26:if((s=c.n()).done){e.next=33;break}return e.delegateYield(u(),"t1",28);case 28:if("continue"!==e.t1){e.next=31;break}return e.abrupt("continue",31);case 31:e.next=26;break;case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(23),c.e(e.t2);case 38:return e.prev=38,c.f(),e.finish(38);case 41:l=os(n),e.prev=42,f=D.mark((function e(){var n,r,o,i;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.value,r=t.find((function(e){var t,r=(null===(t=n.instance.config)||void 0===t?void 0:t.paymentInfo)||{},o=r.channelCode,i=r.methodCode;return o===e.channelCode&&i===e.methodCode})),r||null===(o=(i=n.instance).hideButton)||void 0===o||o.call(i);case 3:case"end":return e.stop()}}),e)})),l.s();case 45:if((d=l.n()).done){e.next=49;break}return e.delegateYield(f(),"t3",47);case 47:e.next=45;break;case 49:e.next=54;break;case 51:e.prev=51,e.t4=e.catch(42),l.e(e.t4);case 54:return e.prev=54,l.f(),e.finish(54);case 57:this.checkAllButtonsInitFail(),e.next=63;break;case 60:e.prev=60,e.t5=e.catch(0),this.logger.error("rerender error",{action:Ne.ReRender,error:e.t5});case 63:case"end":return e.stop()}}),e,this,[[0,60],[4,16,19,22],[23,35,38,41],[42,51,54,57]])}))),function(e){return t.apply(this,arguments)})},{key:"getPaymentMethods",value:function(){return this.renderList.map((function(e){return{channelCode:e.channelCode,params:e.params}}))}},{key:"setDisabled",value:function(e){try{this.logger.info("setDisabled start",{data:{disabled:e}}),this.renderList.forEach((function(t){t.instance.setDisabled(e)}))}catch(e){this.logger.error("setDisabled error",{error:e})}}},{key:"destroy",value:function(){this.renderList.forEach((function(e){var t;null===(t=e.instance)||void 0===t||t.destroy()}))}}]),e}();ss=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}([At],ss);var us=ss;oc.exports.setCurrencyConfig(window.Shopline.currencyConfig.currencyDetailList);var ls=function(e){return String(Number(e)/100)};function ds(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ds(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ds(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ps=function(e,t){return t.isSubscription?"".concat(e.channelCode,"_").concat(e.methodCode,"_").concat(t.uniqueId,"_subscription"):"".concat(e.channelCode,"_").concat(e.methodCode,"_").concat(t.uniqueId)},hs=function(e){var t;return(null===(t=e.buttonTypeDataList.find((function(e){return e.buttonType===Ma.Express})))||void 0===t?void 0:t.buttonNameDataList.map((function(e){return e.buttonConfigData})))||[]},ys=function(e,t){return e.map((function(e){return"".concat(e.channelCode,"_").concat(e.methodCode)})).sort().join(",")===t.map((function(e){return"".concat(e.channelCode,"_").concat(e.methodCode)})).sort().join(",")},vs=function(e){if(e.redirect&&e.fullUri){var t="".concat(window.location.protocol,"//").concat(window.location.host).concat(e.fullUri);return window.location.href=t,!0}return!1},ms=function(e,t){var n=t.expressCheckoutChannelInfo,r=fs({},e);if(xr(n)||jr(n)||Tr(n)){if(n.methodCode===Me.GooglePay){var o=r.transactionInfo,i=r.newTransactionInfo,a=(o||i).currencyCode,c=function(e){var t=fs({},e);return t.totalPrice=ls(t.totalPrice||""),Array.isArray(t.displayItems)&&t.displayItems.length&&(t.displayItems=t.displayItems.map((function(e){return fs(fs({},e),{},{price:ls(e.price||"")})}))),t},s=function(e){var t=fs({},e);return Array.isArray(t.shippingOptions)&&t.shippingOptions.length&&(t.shippingOptions=t.shippingOptions.map((function(e){return fs(fs({},e),{},{description:"".concat(a,": ").concat(oc.exports.formatWithoutCurrency(Number(e.description),{code:a}))})}))),t};return r.newTransactionInfo&&(r.newTransactionInfo=c(r.newTransactionInfo)),r.transactionInfo&&(r.transactionInfo=c(r.transactionInfo)),r.newShippingOptionParameters&&(r.newShippingOptionParameters=s(r.newShippingOptionParameters)),r.shippingOptionParameters&&(r.shippingOptionParameters=s(r.shippingOptionParameters)),r}if(n.methodCode===Me.ApplePay){var u=r.paymentRequest,l=r.newTotal;return Array.isArray(r.newShippingMethods)&&(r.newShippingMethods=r.newShippingMethods.map((function(e){return fs(fs({},e),{},{amount:ls(e.amount)})}))),Array.isArray(null==u?void 0:u.shippingMethods)&&(u.shippingMethods=u.shippingMethods.map((function(e){return fs(fs({},e),{},{amount:ls(e.amount)})}))),l&&(l.amount=ls(l.amount)),u.total&&(u.total.amount=ls(u.total.amount)),Array.isArray(r.newLineItems)&&(r.newLineItems=r.newLineItems.map((function(e){return fs(fs({},e),{},{amount:ls(e.amount)})}))),Array.isArray(u.lineItems)&&(u.lineItems=u.lineItems.map((function(e){return fs(fs({},e),{},{amount:ls(e.amount)})}))),r}}return r},gs=function(e,t){var n=t.expressCheckoutChannelInfo;if(xr(n)||jr(n)||Tr(n))return function(e){if(e){var t=e.defaultSelectedOptionId,n=e.shippingOptions;if(t&&Array.isArray(n)){var r=n.find((function(e){return e.id===t}));if(r)return r.label}}}(e.newShippingOptionParameters||e.shippingOptionParameters);if(n.channelCode===Re.StripeOther&&Array.isArray(e.shippingOptions)){var r=e.shippingOptions.find((function(e){return e.selected}));if(r)return r.label}},bs=function(e,t){var n,r=Wa[t.methodCode];if(r){var o={type:e,data:{buttonName:r,buttonLocation:t.buttonLocation}},i=new CustomEvent("PayButton::Update",{bubbles:!0,detail:o});document.dispatchEvent(i),null===(n=window.Shopline.event)||void 0===n||n.emit("PayButton::Update",o)}},ws=function(e){var t=Fa.PAY_PAL;switch(e){case Me.GooglePay:t=Fa.GOOGLE_PAY;break;case Me.ApplePay:t=Fa.APPLE_PAY;break;default:t=Fa.PAY_PAL}return t},_s=function(){var e={sid:"",createAt:Date.now()};try{var t=window.localStorage.getItem("tracker_sid");if(!t)return e;var n=JSON.parse(t).value;return{sid:n.sid,createAt:n.createAt}}catch(t){return window[window.__sl_console__?"__sl_console__":"console"].error("get session info error: ",t),e}},Os={},Cs=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))},ks="%[a-f0-9]{2}",Ss=new RegExp("("+ks+")|([^%]+?)","gi"),Es=new RegExp("("+ks+")+","gi");function Ps(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],Ps(n),Ps(r))}function Is(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(Ss)||[],n=1;n<t.length;n++)t=(e=Ps(t,n).join("")).match(Ss)||[];return e}}var xs,Ts=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+_(e)+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=Es.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=Is(n[0]);r!==n[0]&&(t[n[0]]=r)}n=Es.exec(e)}t["%C2"]="";for(var o=Object.keys(t),i=0;i<o.length;i++){var a=o[i];e=e.replace(new RegExp(a,"g"),t[a])}return e}(e)}},js=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},As=function(e,t){for(var n={},r=Object.keys(e),o=Array.isArray(t),i=0;i<r.length;i++){var a=r[i],c=e[a];(o?-1!==t.indexOf(a):t(a,c,e))&&(n[a]=c)}return n};function Ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){var t=Cs,n=Ts,r=js,o=As,i=Symbol("encodeFragmentIdentifier");function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,n){return n.encode?n.strict?t(e):encodeURIComponent(e):e}function s(e,t){return t.decode?n(e):e}function u(e){return Array.isArray(e)?e.sort():"object"===_(e)?u(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function l(e){var t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){var t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function p(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"colon-list-separator":return function(e,n,r){t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return function(t,n,r){var o="string"==typeof n&&n.includes(e.arrayFormatSeparator),i="string"==typeof n&&!o&&s(n,e).includes(e.arrayFormatSeparator);n=i?s(n,e):n;var a=o||i?n.split(e.arrayFormatSeparator).map((function(t){return s(t,e)})):null===n?n:s(n,e);r[t]=a};case"bracket-separator":return function(t,n,r){var o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),o){var i=null===n?[]:n.split(e.arrayFormatSeparator).map((function(t){return s(t,e)}));void 0!==r[t]?r[t]=[].concat(r[t],i):r[t]=i}else r[t]=n?s(n,e):n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),o=Object.create(null);if("string"!=typeof e)return o;if(!(e=e.trim().replace(/^[?#&]/,"")))return o;var i,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ls(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ls(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(e.split("&"));try{for(c.s();!(i=c.n()).done;){var l=i.value;if(""!==l){var d=m(r(t.decode?l.replace(/\+/g," "):l,"="),2),p=d[0],h=d[1];h=void 0===h?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?h:s(h,t),n(s(p,t),h,o)}}}catch(e){c.e(e)}finally{c.f()}for(var y=0,v=Object.keys(o);y<v.length;y++){var g=v[y],b=o[g];if("object"===_(b)&&null!==b)for(var w=0,O=Object.keys(b);w<O.length;w++){var C=O[w];b[C]=f(b[C],t)}else o[g]=f(b,t)}return!1===t.sort?o:(!0===t.sort?Object.keys(o).sort():Object.keys(o).sort(t.sort)).reduce((function(e,t){var n=o[t];return Boolean(n)&&"object"===_(n)&&!Array.isArray(n)?e[t]=u(n):e[t]=n,e}),Object.create(null))}e.extract=d,e.parse=p,e.stringify=function(e,t){if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);for(var n=function(n){return t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n]},r=function(e){switch(e.arrayFormat){case"index":return function(t){return function(n,r){var o=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(v(n),null===r?[[c(t,e),"[",o,"]"].join("")]:[[c(t,e),"[",c(o,e),"]=",c(r,e)].join("")])}};case"bracket":return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(v(n),null===r?[[c(t,e),"[]"].join("")]:[[c(t,e),"[]=",c(r,e)].join("")])}};case"colon-list-separator":return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(v(n),null===r?[[c(t,e),":list="].join("")]:[[c(t,e),":list=",c(r,e)].join("")])}};case"comma":case"separator":case"bracket-separator":var t="bracket-separator"===e.arrayFormat?"[]=":"=";return function(n){return function(r,o){return void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:(o=null===o?"":o,0===r.length?[[c(n,e),t,c(o,e)].join("")]:[[r,c(o,e)].join(e.arrayFormatSeparator)])}};default:return function(t){return function(n,r){return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:[].concat(v(n),null===r?[c(t,e)]:[[c(t,e),"=",c(r,e)].join("")])}}}}(t),o={},i=0,s=Object.keys(e);i<s.length;i++){var u=s[i];n(u)||(o[u]=e[u])}var l=Object.keys(o);return!1!==t.sort&&l.sort(t.sort),l.map((function(n){var o=e[n];return void 0===o?"":null===o?c(n,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?c(n,t)+"[]":o.reduce(r(n),[]).join("&"):c(n,t)+"="+c(o,t)})).filter((function(e){return e.length>0})).join("&")},e.parseUrl=function(e,t){t=Object.assign({decode:!0},t);var n=m(r(e,"#"),2),o=n[0],i=n[1];return Object.assign({url:o.split("?")[0]||"",query:p(d(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:s(i,t)}:{})},e.stringifyUrl=function(t,n){n=Object.assign(S({encode:!0,strict:!0},i,!0),n);var r=l(t.url).split("?")[0]||"",o=e.extract(t.url),a=e.parse(o,{sort:!1}),s=Object.assign(a,t.query),u=e.stringify(s,n);u&&(u="?".concat(u));var d=function(e){var t="",n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(t.url);return t.fragmentIdentifier&&(d="#".concat(n[i]?c(t.fragmentIdentifier,n):t.fragmentIdentifier)),"".concat(r).concat(u).concat(d)},e.pick=function(t,n,r){r=Object.assign(S({parseFragmentIdentifier:!0},i,!1),r);var a=e.parseUrl(t,r),c=a.url,s=a.query,u=a.fragmentIdentifier;return e.stringifyUrl({url:c,query:o(s,n),fragmentIdentifier:u},r)},e.exclude=function(t,n,r){var o=Array.isArray(n)?function(e){return!n.includes(e)}:function(e,t){return!n(e,t)};return e.pick(t,o,r)}}(Os);var Ds,Ns=(S(xs={},Ra.ProductDetail,"detail"),S(xs,Ra.Cart,"cart"),S(xs,Ra.Checkout,void 0),xs);!function(e){e.InitFail="initFail",e.UpdateFail="updateFail",e.NoShippingOption="noShippingOption",e.InvalidDiscountCode="invalidDiscountCode",e.DiscountCodeExists="discountCodeExists",e.CreateFail="createFail",e.CreateTimeout="createTimeout"}(Ds||(Ds={}));var Bs={maxCount:3,interval:1e3},Rs=function(){var e=b(D.mark((function e(t){var n,r,o,i,a,c,s,u,l,d,f,p;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.products,o=t.associateCart,i=void 0!==o&&o,a=t.discountCodes,c=void 0===a?[]:a,s=t.useMemberPoint,u=t.notSupportSubscriptionCheck,l=window.Shopline.locale,d=bc("lang"),f={useRetry:!0,action:$e.SaveAbandonOrder,retryOptions:Bs},e.next=6,gt.post(Ms,{products:r,associateCart:i,discountCodes:c,orderFrom:"web",languageInfo:{marketLanguage:l,displayLanguage:d},useMemberPoint:s,notSupportSubscriptionCheck:u},f);case 6:if(p=e.sent,null!==(n=p.data)&&void 0!==n&&n.success){e.next=9;break}throw p;case 9:return e.abrupt("return",p.data.data);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ms="/leproxy/api/trade/center/order/abandoned/save",Fs=function(){var e=b(D.mark((function e(t){var n,r,o,i;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.notSupportSubscriptionCheck,o={useRetry:!0,action:$e.SaveAbandonOrder,retryOptions:Bs},e.next=4,gt.post(Hs,{notSupportSubscriptionCheck:r},o);case 4:if(i=e.sent,null!==(n=i.data)&&void 0!==n&&n.success){e.next=7;break}throw i.data;case 7:return e.abrupt("return",i.data.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Hs="/leproxy/api/trade/center/checkout/save/base-on-cart-cookie/return-data",Us=function(){var e=b(D.mark((function e(t){var n,r,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={useRetry:!0,action:$e.ExpressFirstLoad,retryOptions:Bs},t.expressCheckoutChannelInfo.methodCode===Me.GooglePay&&(r.useRetry=!1),e.next=4,gt.post("/leproxy/api/trade/center/express/checkout/first-load",t,r);case 4:if(o=e.sent,null!==(n=o.data)&&void 0!==n&&n.success){e.next=7;break}throw o.data;case 7:return e.abrupt("return",o.data.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qs=function(){var e=b(D.mark((function e(t){var n,r,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={useRetry:!0,action:$e.ExpressUpdateDetail,retryOptions:Bs},e.next=3,gt.post("/leproxy/api/trade/center/express/checkout/detail",t,r);case 3:if(o=e.sent,null!==(n=o.data)&&void 0!==n&&n.success){e.next=6;break}throw o.data;case 6:return e.abrupt("return",o.data.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ys=function(){var e=b(D.mark((function e(t){var n,r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gt.post("/leproxy/api/trade/center/express/checkout/create",t);case 2:if(r=e.sent,null!==(n=r.data)&&void 0!==n&&n.success){e.next=5;break}throw r.data;case 5:return e.abrupt("return",r.data.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Gs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vs(e){return gt.post("/api/bff-web/trade/metric/report/apiError",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gs(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}function zs(e){return"object"===_(e)&&null!==e&&"statusCode"in e&&("number"==typeof e.statusCode||void 0===e.statusCode)}var Ws,Ks=function(e,t){var n=t.isNetworkError,r=t.isRateLimited,o="";n?o="Network error":r&&(o="Rate limited"),null==e||e.info("[PayButton non-bizerror: ".concat(o,"]"))};function Xs(e,t){var n,r,o,i="",a="",c=0,s=new Error("non-error"),u=Ve.Other,l="",d=function(e){if(!zs(e))return!1;if("object"!==_(e.data)||null===e.data)return!1;var t=e.data,n="code"in t&&("string"==typeof t.code||void 0===t.code),r="msg"in t&&("string"==typeof t.msg||void 0===t.msg),o="message"in t&&("string"==typeof t.message||void 0===t.message);return n||r||o}(e),f=zs(e);d?(i=(null===(n=e.data)||void 0===n?void 0:n.code)||"",c=e.statusCode,a=(null===(r=e.data)||void 0===r?void 0:r.msg)||(null===(o=e.data)||void 0===o?void 0:o.message)||"",s=new Error(a),l=(null==e?void 0:e.url)||""):f?(c=e.statusCode,l=(null==e?void 0:e.url)||""):e instanceof Error?(a=e.message,s=e):(a=String(e),s=new Error(a));var p=!1,h=!1;(d||f)&&(p=void 0===c||c<=0,h=429===c||"0429"===i);var y=p||h;return y&&(u=p?Ve.NetworkUnstable:Ve.RateLimited,Ks(null==t?void 0:t.logger,{isNetworkError:p,isRateLimited:h}),l&&Vs({url:l,statusCode:c||999,errorCode:i||"",errorMessage:a})),{isServiceUnavailable:y,isRateLimited:h,isNetworkError:p,errorForLog:s,errorType:u,endpoint:l,message:a,httpStatusCode:c,bizErrorCode:i}}!function(e){e.DiscountCode="TCTD0122",e.NoShippingOption="TC_000000_B0019",e.IllegalAmount="TC_000000_B0046"}(Ws||(Ws={}));var Js=["DISCOUNT_CODE_OR_GIFT_CARD_INVALID","DISCOUNT_CODE_INVALID","DISCOUNT_CODE_EXPIRED","DISCOUNT_CODE_USER_INVALID","DISCOUNT_CODE_USE_TIMES_LIMIT","DISCOUNT_CODE_NO_REACH","UN_MATCH_PAYMENT","UN_MATCH_LOGISTICS"],$s=["DISCOUNT_CODE_REPEAT"],Zs=function(e){return(e||[]).map((function(e){return{spuId:e.productSeq,skuId:e.productSku,skuItemNo:e.itemNo,title:e.productName,variant:(e.productSkuAttrList||[]).join(","),price:e.finalPrice,quantity:e.productNum,category:e.customCategoryName}}))},Qs=function(e){var t,n=e.eventId,r=e.amount,o=e.price,i=e.productInfos,a=e.channelCode;null===(t=window.Shopline.Analytics)||void 0===t||t.track({name:"orderAddPaymentInfo",payload:{eventId:n,value:r,paymentType:a,productPrice:o,list:Zs(i)}})},eu=function(e){var t,n=e.shipping_method,r=e.amount,o=e.productInfos;null===(t=window.Shopline.Analytics)||void 0===t||t.track({name:"orderCompleteStep",payload:{checkout_option:n,checkout_step:3,value:r,list:Zs(o)},whitelistTransports:["GoogleAnalytics4"]})};function tu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tu(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ru=Or(),ou=k((function e(t,n){var r=this;w(this,e),S(this,"checkoutUrl",""),S(this,"abandonedInfo",null),S(this,"createOrderParams",{basicInfo:null,otherInfo:null,buyerInfo:null,marketInfo:null,priceInfo:null,productInfos:null,passThrough:""}),S(this,"expressCheckoutChannelInfo",null),S(this,"shippingMethodName",""),S(this,"firstLoadRes",{status:Ue.Await,promise:null}),S(this,"getConfig",(function(){var e=r.config,t=e.domId,n=e.paymentConfig,o=e.props,i=o.style,a=o.expressOptimizationSwitch,c=o.buttonTimeoutConfig,s=r.extra,u=s.uniqueId,l=s.isSubscription,d=hs(n).map((function(e){var t=ps({channelCode:e.channelCode,methodCode:e.methodCode},{uniqueId:u,isSubscription:l});return nu(nu({},e),{},{currentDomId:t})}));return l&&(d=d.filter((function(e){return e.methodCode===Me.Paypal}))),r.logger.info(" payments",{data:{payments:d}}),{language:window.Shopline.locale,payments:d,props:{dynamic:n.isSystem,domId:t,styleOptions:{height:i.height,"border-radius":i["border-radius"]},buttonTimeoutConfig:{enable:"boolean"!=typeof(null==c?void 0:c.enable)||c.enable,timeoutMillis:null==c?void 0:c.timeoutMillis},isSubscription:l,scriptParams:l?{"data-namespace":"subscriptionDynamicPaypal"}:void 0,expressOptimizationSwitch:a},loggerFn:function(){return r.logger.withOwner("")},beforeCreateOrder:r.beforeCreateOrder,onChannelModalSuccess:r.onChannelModalSuccess,onFormDataChange:r.onFormDataChange,createOrder:r.createOrder,onError:r.onError,onAllButtonsInitFail:r.onAllButtonsInitFail}})),S(this,"updateCreateOrderParams",(function(e){var t,n,o,i,a=(null===(t=r.createOrderParams.otherInfo)||void 0===t?void 0:t.clientLang)||(null===(n=e.otherInfo)||void 0===n||null===(o=n.checkoutLanguageInfo)||void 0===o?void 0:o.displayLanguage)||(null===(i=e.otherInfo)||void 0===i?void 0:i.clientLang);r.createOrderParams.basicInfo=e.basicInfo||null,r.createOrderParams.otherInfo=nu(nu({},e.otherInfo),{},{clientLang:a}),r.createOrderParams.buyerInfo=e.buyerInfo||null,r.createOrderParams.marketInfo=e.marketInfo||null,r.createOrderParams.passThrough=e.passThrough||"",e.priceInfo&&(r.createOrderParams.priceInfo=e.priceInfo),e.productInfos&&(r.createOrderParams.productInfos=e.productInfos)})),S(this,"beforeCreateOrder",function(){var e=b(D.mark((function e(t){var n,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=b(D.mark((function e(t){var n,o,i,a,c,s,u,l,d,f,p,h,y,v,m,g,b,w,_,O,C,k,S;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(n=t||{}).channelCode,i=n.methodCode,a=n.paymentId,c=n.accessMode,s=r.config,u=s.saveAbandonedOrder,l=s.paymentConfig,d=s.props.toast,f={valid:!1},r.logger.info("beforeCreateOrder",{data:{channelCode:o,methodCode:i,paymentId:a}}),r.reportButtonClick(i),bs(za.ButtonClick,{methodCode:i,buttonLocation:l.buttonLocation}),e.prev=6,r.firstLoadRes.status=Ue.Pending,e.next=10,u(ws(i));case 10:if(p=e.sent,h=p.canContinue,y=p.abandonedInfo,v=p.url,h&&y){e.next=17;break}return r.logger.info("save abandon order process terminated",{data:{abandonedInfo:y,url:v}}),e.abrupt("return",f);case 17:if(r.checkoutUrl=v||"",m={abandonedOrderInfo:y,returnUrl:v||""},![Me.ApplePay,Me.GooglePay].includes(i)){e.next=40;break}return r.abandonedInfo=y,r.expressCheckoutChannelInfo={channelCode:o,methodCode:i,accessMode:c,paymentId:a||"",storeWebsiteUrl:window.location.origin},g=y.seq,b=y.checkoutToken,w={abandonedOrderInfo:{seq:g,checkoutToken:b,abandonedOrderType:"SETTLE",orderFrom:"MAIN_SITE"},expressCheckoutChannelInfo:r.expressCheckoutChannelInfo,otherInfo:{buyScence:Ns[l.buttonLocation]},buttonTraceId:l.buttonTraceId},r.logger.info("firstLoad",{data:nu({},w)}),e.next=27,Us(w);case 27:if(_=e.sent,r.logger.info("firstLoad",{data:nu({},_)}),!_){e.next=38;break}if(!vs(_)){e.next=33;break}return r.logger.log(""),e.abrupt("return",f);case 33:r.updateCreateOrderParams(_),(O=nu({},_)).payChannelData=ms(O.payChannelData,{expressCheckoutChannelInfo:r.expressCheckoutChannelInfo}),r.shippingMethodName=gs(O.payChannelData,{expressCheckoutChannelInfo:r.expressCheckoutChannelInfo})||"",m.paymentConfig=O;case 38:r.logger.info("firstLoad",{data:nu({},_)}),r.firstLoadRes.status=Ue.Done;case 40:return r.logger.info("beforeCreateOrder",{data:nu({},m)}),e.abrupt("return",m);case 44:return e.prev=44,e.t0=e.catch(6),r.firstLoadRes.status=Ue.Fail,window[window.__sl_console__?"__sl_console__":"console"].error("beforeCreateOrder error: ",e.t0),C=Xs(e.t0,{logger:r.logger}),k=C.isServiceUnavailable,S=C.errorType,k?Ct(r.config.onError)&&r.config.onError(Ne.PullUpChannel,{errorType:S}):(r.logger.error("beforeCreateOrder",{error:e.t0}),e.t0.code===Ws.NoShippingOption?d(ru("cart.error.noshipping")):d(ru("cart.error.default"))),e.abrupt("return",f);case 51:case"end":return e.stop()}}),e,null,[[6,44]])})));return function(t){return e.apply(this,arguments)}}(),o=n(t),r.firstLoadRes.promise=o,e.next=5,o;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(this,"onChannelModalSuccess",(function(e){var t=r.config.paymentConfig.buttonLocation;if(bs(za.ModalOpen,{methodCode:e.methodCode,buttonLocation:t}),e.methodCode!==Me.Paypal)try{var n,o=r.createOrderParams,i=o.priceInfo,a=o.productInfos,c=(null==i?void 0:i.originalSettleSumAmount)||(null==i?void 0:i.orderAmount),s=e.settleCurrency;(function(e){var t,n=e.seq,r=void 0===n?"":n,o=e.amount,i=e.productInfos,a=function(e){var t=JSON.parse(decodeURIComponent(bc("".concat(e,"_fb_data")))||"{}");return t&&t.ed?t.ed:wc()}(r),c="initiateCheckout".concat(a);null===(t=window.Shopline.Analytics)||void 0===t||t.track({name:"orderStart",payload:{eventId:c,value:o,list:Zs(i)}})})({seq:null===(n=r.abandonedInfo)||void 0===n?void 0:n.seq,amount:c,productInfos:a}),dc.reportConversionEvent(ec.InitiateCheckout,{currency:s,orderAmount:c,productInfos:a})}catch(e){r.logger.error("",{error:e})}})),S(this,"onFormDataChange",function(){var e=b(D.mark((function e(t,n){var o,i,a,c,s,u;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={code:Ds.UpdateFail,message:ru("cart.error.renew")},r.logger.log("onFormDataChange",{data:{firstLoadRes:r.firstLoadRes}}),S(o={},Ue.Await,(function(){})),S(o,Ue.Done,b(D.mark((function e(){return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),S(o,Ue.Fail,(function(){})),S(o,Ue.Pending,b(D.mark((function e(){return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.firstLoadRes.promise;case 2:case"end":return e.stop()}}),e)})))),a=o[r.firstLoadRes.status],e.next=6,a();case 6:return c={abandonedOrderInfo:r.abandonedInfo,expressCheckoutChannelInfo:r.expressCheckoutChannelInfo,basicInfo:nu(nu({},r.createOrderParams.basicInfo),{},{action:n}),otherInfo:r.createOrderParams.otherInfo,buyerInfo:r.createOrderParams.buyerInfo,payChannelData:t,passThrough:r.createOrderParams.passThrough},r.logger.info("",{data:nu({},c)}),e.next=10,qs(c).catch((function(e){return r.logger.error("",{error:e}),e.code===Ws.NoShippingOption&&(i.message=ru("cart.error.noshipping")),e.code===Ws.DiscountCode&&Js.includes(e.msg)&&(i.message=ru("transaction.discount.code_error")),e.code===Ws.DiscountCode&&$s.includes(e.msg)&&(i.message=ru("cart.couponCode.existCode")),{error:i}}));case 10:if(s=e.sent,r.logger.info("",{data:nu({},s)}),r.isValidReturn(s)){e.next=14;break}return e.abrupt("return",s);case 14:if(!vs(s)){e.next=17;break}return r.logger.log(""),e.abrupt("return",{error:{code:Ds.UpdateFail,message:ru("cart.error.renew")}});case 17:if(r.updateCreateOrderParams(s),!r.expressCheckoutChannelInfo){e.next=22;break}return u=ms(s.payChannelData,{expressCheckoutChannelInfo:r.expressCheckoutChannelInfo}),r.shippingMethodName=gs(u,{expressCheckoutChannelInfo:r.expressCheckoutChannelInfo})||"",e.abrupt("return",u);case 22:return e.abrupt("return",s.payChannelData);case 23:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),S(this,"createOrder",function(){var e=b(D.mark((function e(t,n){var o,i,a,c,s,u,l,d,f,p,h,y,v,m,g,b,w,_,O,C,k,S,E,P,I,x,T,j,A,L,N;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.payChannelData,a=n.token,c="",window.__DF__&&"function"==typeof window.__DF__.getToken&&(c=window.__DF__.getToken()),s=_s(),u=s.sid,l=s.createAt,d="",window.HdSdk&&window.HdSdk.shopTracker&&"function"==typeof window.HdSdk.shopTracker.getDataId&&(d=window.HdSdk.shopTracker.getDataId()),f="addPaymentInfo".concat(wc()),p={abandonedOrderInfo:r.abandonedInfo,expressCheckoutChannelInfo:r.expressCheckoutChannelInfo,basicInfo:r.createOrderParams.basicInfo,otherInfo:nu(nu({},r.createOrderParams.otherInfo),{},{dfpToken:c}),buyerInfo:r.createOrderParams.buyerInfo,marketInfo:r.createOrderParams.marketInfo,passThrough:r.createOrderParams.passThrough,payChannelData:i,instrumentOption:a,sessionInfo:{sessionId:u,sessionCreateTime:l},dataReportReq:{eventName:"AddPaymentInfo",dataId:d,eventTime:Date.now(),eventId:f,currency:t.settleCurrency,payAmount:null===(o=r.createOrderParams.priceInfo)||void 0===o?void 0:o.originalSettleSumAmount},clientInfo:ln()},h={error:{code:Ds.CreateFail,message:ru("cart.error.order")}},r.logger.info("",{data:nu({},p)}),e.next=12,Ys(p).catch((function(e){if(r.logger.error("",{error:e}),e.code===Ws.IllegalAmount){var t=window.Shopline.storeId,n="".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(t,"/checkouts/").concat(p.abandonedOrderInfo.checkoutToken);r.logger.info("",{data:{url:n}}),window.location.href=n}return h}));case 12:if(y=e.sent,r.logger.info("",{data:nu({},y)}),r.isValidReturn(y)){e.next=16;break}return e.abrupt("return",y);case 16:if(!vs(y)){e.next=19;break}return r.logger.info(""),e.abrupt("return",h);case 19:try{g=r.createOrderParams,b=g.basicInfo,w=g.otherInfo,_=g.priceInfo,O=g.productInfos,eu({amount:null==_?void 0:_.originalSettleSumAmount,productInfos:O,shipping_method:r.shippingMethodName}),Qs({eventId:f,amount:null==_?void 0:_.originalSettleSumAmount,price:null==_?void 0:_.productSumAmount,productInfos:O,channelCode:null===(v=r.expressCheckoutChannelInfo)||void 0===v?void 0:v.channelCode}),C=(null==_?void 0:_.originalSettleSumAmount)||(null==_?void 0:_.orderAmount),k=t.settleCurrency||"",S={payment_method:null===(m=r.expressCheckoutChannelInfo)||void 0===m?void 0:m.channelCode,shipping_method:r.shippingMethodName,coupon_code:null==b?void 0:b.discountCode,currency:k,orderAmount:C,productInfos:y.productInfos||[],basicInfo:b,otherInfo:w},dc.reportConversionEvent(ec.AddCustomerInfo,S),dc.reportConversionEvent(ec.AddShippingInfo,S),dc.reportAddPaymentInfo(S)}catch(e){r.logger.error("",{error:e})}return e.prev=20,I=y.orderMark,x=y.orderSeq,T=y.transactionId,j=y.paySeq,A=y.nextAction,L={orderMark:I,orderSeq:x,transactionId:T,paySeq:j,abOrderSeq:null===(E=r.abandonedInfo)||void 0===E?void 0:E.seq,abOrderMark:null===(P=r.abandonedInfo)||void 0===P?void 0:P.mark},sessionStorage.setItem("processing_data",JSON.stringify(L)),N=JSON.parse(A),e.abrupt("return",{nextAction:N});case 28:return e.prev=28,e.t0=e.catch(20),r.logger.error("",{error:e.t0,data:y}),e.abrupt("return",h);case 32:case"end":return e.stop()}}),e,null,[[20,28]])})));return function(t,n){return e.apply(this,arguments)}}()),S(this,"onError",(function(e,t,n){var o=r.config.props.toast;if(t&&(null==n?void 0:n.methodCode)===Me.Paypal&&[Ne.PullUpChannel,Ne.Pay].includes(t)){var i=Xs(e,{logger:r.logger}),a=i.isServiceUnavailable,c=i.errorType;if(a)return void(Ct(r.config.onError)&&r.config.onError(Ne.PullUpChannel,{errorType:c}))}if(t===Ne.CreateExpected){var s=Os.exclude(r.checkoutUrl,["spb"]);return r.logger.warn("",{data:{url:s}}),void(window.location.href=s)}r.logger.error("",{error:e,data:{type:t,extData:n}}),t===Ne.PullUpChannel&&o(ru("cart.error.default"))})),S(this,"onAllButtonsInitFail",(function(){var e=r.config.paymentConfig;nc(e)&&(r.logger.info("buy now"),r.extra.onAllButtonsInitFail())})),S(this,"isValidReturn",(function(e){return!(!e||e.error)})),S(this,"reportButtonClick",(function(e){var t=r.config.paymentConfig.buttonLocation,n=Wa[e]||"";n?dc.reportPayButtonClick(n,t):window[window.__sl_console__?"__sl_console__":"console"].warn(": ".concat(e))})),this.config=t,this.extra=n,this.logger=this.config.props.logger.pipeOwner("ExpressConfig")}));function iu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function au(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?au(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):au(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var su=Or(),uu=function(e){La(n,Va);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Na(e);if(t){var o=Na(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Da(this,n)}}(n);function n(e){var r;w(this,n),S(ja(r=t.call(this,e)),"expressInstance",null),S(ja(r),"subscriptionExpressInstance",null),S(ja(r),"isVisible",!1),S(ja(r),"isSubscription",!1),S(ja(r),"isAllButtonsInitFail",!1),S(ja(r),"render",b(D.mark((function e(){var t,n,o,i;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.logger.info("render"),r.needRender){e.next=3;break}return e.abrupt("return",[]);case 3:if(t=r.config.props,n=t.isPreview,o=t.isSubscription,i=t.isVisible,r.isVisible=i,r.isSubscription=Boolean(o),r.insertButtonContainer(r.configList),n&&(r.logger.info(""),r.addMaskListener()),!o){e.next=14;break}return r.logger.info(""),e.next=12,Promise.all([r.renderSceneButton(!0),r.renderSceneButton(!1)]);case 12:e.next=17;break;case 14:return r.logger.info(""),e.next=17,r.renderSceneButton(!1);case 17:if(!r.isAllButtonsInitFail){e.next=19;break}return e.abrupt("return",Promise.reject(new Error("all button init failed.")));case 19:return e.abrupt("return",r.getRenderedList());case 20:case"end":return e.stop()}}),e)})))),S(ja(r),"rerender",function(){var e=b(D.mark((function e(t){var n,o,i,a,c,s,u;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.logger.info("rerender"),n=r.configList,o=hs(t),!ys(n,o)||r.renderedList.length!==o.length){e.next=6;break}return r.logger.info("same paymentConfig, no need to rerender"),e.abrupt("return");case 6:if(i=function(e){return ps({channelCode:e.channelCode,methodCode:e.methodCode},{uniqueId:r.uniqueId,isSubscription:r.isSubscription})},(a=o.filter((function(e){var t;if(n.find((function(t){return t.channelCode===e.channelCode&&t.methodCode===e.methodCode})))return!1;var o=i(e);return null===(t=r.container)||void 0===t||!t.querySelector("#".concat(o))}))).length&&r.insertButtonContainer(a),c=o.map((function(e){var t=i(e);return cu(cu({},e),{},{currentDomId:t})})),!r.isSubscription){e.next=15;break}return e.next=13,null===(s=r.subscriptionExpressInstance)||void 0===s?void 0:s.rerender(c.filter((function(e){return e.methodCode===Me.Paypal})));case 13:e.next=17;break;case 15:return e.next=17,null===(u=r.expressInstance)||void 0===u?void 0:u.rerender(c);case 17:r.setVisible(!0),r.configList=o;case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(ja(r),"setDisabled",(function(e){var t,n;r.logger.info("setDisabled",{data:e}),r.needRender&&(r.isDisabled=e,null===(t=r.expressInstance)||void 0===t||t.setDisabled(e),null===(n=r.subscriptionExpressInstance)||void 0===n||n.setDisabled(e))})),S(ja(r),"setVisible",(function(e){var t,n;if(r.logger.info("setVisible",{data:e}),r.needRender){r.isVisible=e,r.setPaypalBgVisible(!1);var o,i=r.config.paymentConfig,a=nc(i),c=null===(t=r.container)||void 0===t?void 0:t.querySelectorAll(".".concat(Ha.COMMON_ITEM_EXPRESS,":not(.").concat(Ha.BUTTON_SUBSCRIPTION,")"));a&&(c=r.getDynamicButtonElements()),r.isSubscription&&(r.logger.info("paypal"),c=null===(o=r.container)||void 0===o?void 0:o.querySelectorAll(".".concat(Ha.COMMON_ITEM_EXPRESS,".").concat(Ha.BUTTON_SUBSCRIPTION))),null===(n=c)||void 0===n||n.forEach((function(t){e?null==t||t.classList.remove(Ha.BUTTON_HIDE):null==t||t.classList.add(Ha.BUTTON_HIDE)})),r.setPaypalBgVisible(!0)}})),S(ja(r),"setSubscription",(function(e){var t,n,o;if(r.logger.info("setSubscription",{data:e}),r.needRender&&(r.isSubscription=e,r.setPaypalBgVisible(!1),r.isVisible)){var i,a=r.config.paymentConfig,c=nc(a),s=null===(t=r.container)||void 0===t?void 0:t.querySelectorAll(".".concat(Ha.COMMON_ITEM_EXPRESS,".").concat(Ha.BUTTON_SUBSCRIPTION)),u=null===(n=r.container)||void 0===n?void 0:n.querySelectorAll(".".concat(Ha.COMMON_ITEM_EXPRESS,":not(.").concat(Ha.BUTTON_SUBSCRIPTION,")"));if(c&&(u=r.getDynamicButtonElements()),e)return null==s||s.forEach((function(e){null==e||e.classList.remove(Ha.BUTTON_HIDE)})),null===(i=u)||void 0===i||i.forEach((function(e){null==e||e.classList.add(Ha.BUTTON_HIDE)})),void(r.subscriptionExpressInstance||r.renderSceneButton(!0));null===(o=u)||void 0===o||o.forEach((function(e){null==e||e.classList.remove(Ha.BUTTON_HIDE)})),null==s||s.forEach((function(e){null==e||e.classList.add(Ha.BUTTON_HIDE)})),r.expressInstance||r.renderSceneButton(!1),r.setPaypalBgVisible(!0)}})),S(ja(r),"insertButtonContainer",(function(e){var t,n=r.config,o=n.paymentConfig,i=n.props,a=i.isPreview,c=i.style,s=i.isSubscription,u=function(e,t){return'\n      <div\n        class="'.concat(Ha.COMMON_ITEM," ").concat(Ha.COMMON_ITEM_EXPRESS," pay-button-").concat(e.methodCode," ").concat(t?Ha.BUTTON_SUBSCRIPTION:""," ").concat(s!==t?Ha.BUTTON_HIDE:""," ").concat(Ha.BUTTON_HIDE,'"\n        id="').concat(ps(e,{uniqueId:r.uniqueId,isSubscription:t}),'"\n      >').concat(a?'<div class="'.concat(Ha.BUTTON_MASK,'"></div>'):"").concat(e.methodCode===Me.Paypal&&0===c["border-radius"]?'<div class="'.concat(Ha.PAY_PAL_BG_BEFORE,'"></div><div class="').concat(Ha.PAY_PAL_BG_AFTER,'"></div>'):"","</div>\n    ")},l=tc(o).includes(Fa.PAY_PAL),d=e.map((function(e){return u(e)})).join("\n");l&&(d+=u({channelCode:Re.Paypal,methodCode:Me.Paypal},!0)),null===(t=r.container)||void 0===t||t.insertAdjacentHTML("beforeend",d)})),S(ja(r),"getExpressPaymentConfig",(function(e){return new ou(r.config,{uniqueId:r.uniqueId,onAllButtonsInitFail:function(){return r.isAllButtonsInitFail=!0},isSubscription:e}).getConfig()})),S(ja(r),"addMaskListener",(function(){var e,t=r.config.props.toast,n=null===(e=r.container)||void 0===e?void 0:e.querySelectorAll(".".concat(Ha.COMMON_ITEM_EXPRESS));null==n||n.forEach((function(e){e.addEventListener("click",(function(){t(su("products.product_details.link_preview_does_not_support"))}))}))})),S(ja(r),"renderSceneButton",function(){var e=b(D.mark((function e(t){var n,o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.logger.info("renderSceneButton",{data:t}),n=r.getExpressPaymentConfig(t),r.logger.info("expressPaymentConfig",{data:cu({},n)}),o=new us(n),e.next=6,o.render();case 6:r.isDisabled&&o.setDisabled(!0),t?r.subscriptionExpressInstance=o:r.expressInstance=o;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(ja(r),"getDynamicButtonElements",(function(){r.logger.info(" paypal/gp/ap");var e,t=void 0,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return iu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(Xa);try{for(n.s();!(e=n.n()).done;){var o,i=e.value,a=Ha[i],c=null===(o=r.container)||void 0===o?void 0:o.querySelector(".".concat(a,":not(.").concat(Ha.BUTTON_SUBSCRIPTION,")"));if(c&&!c.className.includes(Ua)){var s;r.logger.info(": ".concat(i)),t=null===(s=r.container)||void 0===s?void 0:s.querySelectorAll(".".concat(a,":not(.").concat(Ha.BUTTON_SUBSCRIPTION,")"));break}}}catch(e){n.e(e)}finally{n.f()}return t})),S(ja(r),"setPaypalBgVisible",(function(e){var t,n=null===(t=r.container)||void 0===t?void 0:t.querySelectorAll(".".concat(Ha.PAY_PAL_BG_BEFORE,", .").concat(Ha.PAY_PAL_BG_AFTER));e?setTimeout((function(){null==n||n.forEach((function(e){e.style.opacity="1"}))}),200):null==n||n.forEach((function(e){e.style.opacity="0"}))})),S(ja(r),"destroy",(function(){var e,t;null===(e=r.expressInstance)||void 0===e||e.destroy(),null===(t=r.subscriptionExpressInstance)||void 0===t||t.destroy()}));var o=e.buttonTypes;return r.logger=r.config.props.logger.pipeOwner("ExpressButton"),r.needRender=Cc(Ma.Express,o),r.configList=hs(e.paymentConfig),r.uniqueId=gc(),r}return k(n,[{key:"getRenderedList",value:function(){if(!this.isVisible||!this.needRender)return[];var e=this.expressInstance;return this.isSubscription&&(e=this.subscriptionExpressInstance),e&&e.renderList.filter((function(e){return e.instance.initSuccess&&e.instance.isVisible})).map((function(e){return e.instance.name}))||[]}}]),n}(),lu=function(e){var t,n=e.buttonTypeDataList.find((function(e){return e.buttonType===Ma.Fast}));if(!n)return"";var r=n.buttonNameDataList.find((function(e){return e.buttonName===Fa.SHOP_BY_FAST_CHECKOUT}));return r&&(null===(t=r.buttonConfigData.configData)||void 0===t?void 0:t.checkoutUrl)||""};var du=Or(),fu='<svg width="68" height="18" viewBox="0 0 68 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.3554 0.772522L14.3313 0.488281H11.2835L11.2668 0.781076C11.2627 0.852932 11.2607 0.926892 11.2607 1.0029V14.5641H14.3657V8.86666C14.4287 8.35695 14.6465 7.95264 15.0213 7.63644L15.0234 7.63464L15.0255 7.6328C15.4044 7.30127 15.8744 7.13003 16.4563 7.13003C16.8955 7.13003 17.2325 7.22397 17.4873 7.39011L17.4938 7.39433L17.5005 7.39823C17.7749 7.55832 17.9804 7.78526 18.1202 8.08814C18.2633 8.39812 18.34 8.77287 18.34 9.22071V14.5641H21.4243V9.24141C21.4243 8.23355 21.2225 7.33936 20.8076 6.56883C20.3967 5.80576 19.8351 5.20518 19.1236 4.7748C18.4085 4.3284 17.5992 4.10787 16.7047 4.10787C16.0374 4.10787 15.4469 4.25649 14.9475 4.56832C14.7377 4.69697 14.5435 4.83297 14.3657 4.97654V1.0236C14.3657 0.937544 14.3623 0.853814 14.3554 0.772522Z" fill="#052855"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M25.4418 4.03229C26.1167 3.73912 26.8347 3.5932 27.5927 3.5932C28.6108 3.5932 29.542 3.84101 30.3789 4.33978C31.2108 4.82179 31.8762 5.48035 32.3719 6.31141C32.8722 7.15015 33.1195 8.09606 33.1195 9.14074C33.1195 9.96627 32.9673 10.7276 32.6578 11.4202L32.6573 11.4213L32.6568 11.4225C32.3507 12.0929 31.9342 12.678 31.4076 13.1752L31.406 13.1768L31.4043 13.1784C30.8803 13.6587 30.2898 14.0306 29.6342 14.293C28.9905 14.5562 28.3231 14.6883 27.6341 14.6883C26.9319 14.6883 26.245 14.5564 25.5752 14.2943L25.5713 14.2928L25.5675 14.2912C24.9128 14.0148 24.3169 13.6293 23.7809 13.1367L23.7793 13.1353L23.7777 13.1338C23.2524 12.6376 22.8298 12.0543 22.5102 11.3861L22.509 11.3836L22.5079 11.3811C22.198 10.7023 22.0452 9.96097 22.0452 9.16144C22.0452 8.3899 22.191 7.66441 22.4849 6.98836C22.7762 6.31833 23.1777 5.72684 23.6886 5.21593C24.1991 4.70539 24.784 4.31025 25.4418 4.03229ZM27.572 6.65676C27.1143 6.65676 26.7078 6.76736 26.3449 6.98511L26.3416 6.9871L26.3382 6.989C25.9745 7.19508 25.6826 7.48553 25.4609 7.86695C25.2559 8.22928 25.1501 8.64431 25.1501 9.12004C25.1501 9.6505 25.2694 10.0955 25.4965 10.4669C25.7309 10.8364 26.0298 11.1228 26.395 11.3309C26.7783 11.5277 27.1763 11.6247 27.5927 11.6247C27.995 11.6247 28.3791 11.5279 28.7491 11.3309C29.1274 11.1231 29.4326 10.8307 29.667 10.4482L29.6689 10.4451L29.6709 10.4421C29.9102 10.0712 30.0353 9.62772 30.0353 9.09934C30.0353 8.61079 29.9231 8.19116 29.7069 7.83081L29.7049 7.82749L29.703 7.82414C29.4961 7.45903 29.2123 7.17519 28.8472 6.9683C28.4857 6.76348 28.0637 6.65676 27.572 6.65676Z" fill="#052855"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M33.7459 8.26328H33.7403V17.2702H36.7832V13.5593C36.8987 13.618 37.0167 13.6728 37.137 13.7236C37.8118 14.0168 38.5298 14.1627 39.2878 14.1627C40.3059 14.1627 41.2371 13.9149 42.074 13.4161C42.9059 12.9341 43.5713 12.2756 44.0671 11.4445C44.5674 10.6058 44.8147 9.65985 44.8147 8.61517C44.8147 7.78964 44.6624 7.02827 44.353 6.33573L44.3525 6.33459L44.352 6.33345C44.0459 5.66302 43.6293 5.07796 43.1028 4.58068L43.1011 4.57909L43.0994 4.57753C42.5755 4.09726 41.985 3.7253 41.3294 3.46289C40.6856 3.19971 40.0182 3.06764 39.3292 3.06764C38.627 3.06764 37.9401 3.19949 37.2703 3.46158L37.2665 3.46308L37.2627 3.46468C36.6079 3.74115 36.0121 4.12657 35.476 4.61919L35.4744 4.62062L35.4729 4.62208C34.9475 5.11827 34.525 5.70164 34.2054 6.36983L34.2042 6.37233L34.203 6.37485C33.9412 6.94852 33.7912 7.56669 33.7512 8.22799C33.7504 8.23174 33.7498 8.2349 33.7494 8.23729L33.7488 8.24116L33.7487 8.24134C33.7475 8.249 33.7467 8.25541 33.7463 8.25929L33.7459 8.26328ZM37.1916 7.28898C37.426 6.91948 37.725 6.63309 38.0902 6.42503C38.4735 6.22821 38.8715 6.1312 39.2878 6.1312C39.6901 6.1312 40.0743 6.22802 40.4442 6.42501C40.8225 6.63281 41.1277 6.9252 41.3622 7.30774L41.3641 7.3108L41.366 7.31382C41.6053 7.68474 41.7304 8.12819 41.7304 8.65657C41.7304 9.14512 41.6183 9.56475 41.4021 9.92511L41.4001 9.92842L41.3982 9.93178C41.1913 10.2969 40.9075 10.5807 40.5424 10.7876C40.1809 10.9924 39.7588 11.0991 39.2672 11.0991C38.8095 11.0991 38.4029 10.9886 38.04 10.7708L38.0367 10.7688L38.0333 10.7669C37.6697 10.5608 37.3778 10.2704 37.156 9.88896C36.951 9.52663 36.8453 9.1116 36.8453 8.63587C36.8453 8.10542 36.9645 7.66038 37.1916 7.28898Z" fill="#052855"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M48.4788 0.731349H45.436V8.98816C45.436 9.63584 45.6305 10.289 45.8987 10.8766L45.8999 10.8791L45.9011 10.8816C46.2206 11.5498 46.6432 12.1332 47.1686 12.6294L47.1701 12.6308L47.1717 12.6322C47.7078 13.1249 48.3036 13.5103 48.9584 13.7868L48.9622 13.7884L48.966 13.7899C49.6358 14.0519 50.3227 14.1838 51.0249 14.1838C51.7139 14.1838 52.3813 14.0517 53.0251 13.7885C53.6807 13.5261 54.2712 13.1542 54.7951 12.6739L54.7968 12.6723L54.7985 12.6708C55.325 12.1735 55.7416 11.5884 56.0476 10.918L56.0481 10.9168L56.0487 10.9157C56.3581 10.2232 56.5104 9.46179 56.5104 8.63626C56.5104 7.59159 56.263 6.64568 55.7627 5.80694C55.267 4.97588 54.6016 4.31733 53.7697 3.83532C52.9328 3.33654 52.0016 3.08873 50.9835 3.08873C50.2255 3.08873 49.5075 3.23465 48.8327 3.52781C48.7123 3.57866 48.5944 3.63345 48.4788 3.69218V0.731349ZM49.7357 6.48064C50.0986 6.26289 50.5051 6.15229 50.9628 6.15229C51.4545 6.15229 51.8766 6.259 52.238 6.46383C52.6031 6.67072 52.887 6.95456 53.0939 7.31966L53.0958 7.32302L53.0977 7.32633C53.314 7.68669 53.4261 8.10632 53.4261 8.59487C53.4261 9.12325 53.301 9.56669 53.0617 9.93762L53.0597 9.94064L53.0579 9.9437C52.8234 10.3262 52.5182 10.6186 52.1399 10.8264C51.7699 11.0234 51.3858 11.1202 50.9835 11.1202C50.5672 11.1202 50.1691 11.0232 49.7858 10.8264C49.4207 10.6184 49.1217 10.332 48.8873 9.96246C48.6602 9.59106 48.541 9.14602 48.541 8.61557C48.541 8.13984 48.6467 7.72481 48.8517 7.36248C49.0735 6.98105 49.3653 6.69061 49.729 6.48453L49.7324 6.48263L49.7357 6.48064Z" fill="#052855"/>\n<path d="M56.2303 15.1868L56.3274 15.0898L54.6696 13.432L54.5726 13.529C54.1048 13.9968 53.5494 14.3679 52.9382 14.621C52.327 14.8742 51.6719 15.0045 51.0104 15.0045C50.3488 15.0045 49.6937 14.8742 49.0825 14.621C48.4713 14.3679 47.916 13.9968 47.4482 13.529L47.3511 13.432L45.6934 15.0898L45.7904 15.1868C46.4759 15.8723 47.2897 16.4161 48.1853 16.7871C49.081 17.158 50.0409 17.349 51.0104 17.349C51.9798 17.349 52.9398 17.158 53.8354 16.7871C54.731 16.4161 55.5448 15.8723 56.2303 15.1868Z" fill="#052855"/>\n<path d="M56.2101 3.96665H59.2163L61.9071 9.98946L64.6136 3.96665H67.6248L61.5697 17.2792H58.5541L60.3986 13.3416L56.2101 3.96665Z" fill="#052855"/>\n<path d="M3.03671 1.04181C3.69296 0.702008 4.43508 0.53557 5.2564 0.53557C5.774 0.53557 6.24259 0.585665 6.65971 0.689121C7.07665 0.777637 7.4409 0.899338 7.74776 1.05804C8.04854 1.19592 8.30366 1.34427 8.50743 1.5054C8.69941 1.63749 8.85568 1.76297 8.96249 1.88132C9.10051 2.0124 9.23762 2.16318 9.37706 2.34031C9.81301 2.89408 10.0908 3.60793 10.1819 4.40262L10.217 4.7084H7.39709L7.34038 4.50901C7.33619 4.49427 7.33183 4.47997 7.32732 4.4661L7.32448 4.45736L7.32223 4.44846C7.20991 4.00354 6.92075 3.65909 6.49182 3.45493L6.48403 3.45123L6.47649 3.44704C6.3431 3.37294 6.19646 3.31545 6.03549 3.27533L6.03385 3.27492L6.03221 3.27449C5.82951 3.22131 5.56668 3.19185 5.23802 3.19185C5.0208 3.19185 4.80967 3.22427 4.60364 3.28913L4.59908 3.29057L4.59447 3.29184C4.40825 3.34342 4.25463 3.42385 4.12843 3.53031L4.12355 3.53443L4.11848 3.53832C3.99314 3.63444 3.89079 3.75449 3.81102 3.90155C3.74657 4.04195 3.71129 4.20689 3.71129 4.40165C3.71129 4.66354 3.7798 4.859 3.90033 5.00816C4.0521 5.16745 4.26069 5.31014 4.53538 5.43116C4.83087 5.5488 5.16385 5.66147 5.5349 5.76887C5.91659 5.87935 6.30434 5.99594 6.69815 6.11863L6.70062 6.1194L6.70307 6.12022C7.11768 6.25801 7.5258 6.42078 7.9274 6.60846C8.34285 6.80262 8.71492 7.04943 9.04217 7.34916C9.3803 7.64647 9.64687 8.02121 9.84443 8.46721C10.0484 8.91539 10.1442 9.45101 10.1442 10.0639C10.1442 10.7711 10.0086 11.402 9.72789 11.9485C9.45148 12.4865 9.07411 12.9296 8.59649 13.2736C8.1287 13.6104 7.60941 13.8562 7.04052 14.0112C6.47758 14.1768 5.90713 14.2598 5.32992 14.2598C4.75639 14.2598 4.22726 14.19 3.74478 14.047L3.74378 14.0467L3.74279 14.0464C3.56682 13.9927 3.39763 13.9333 3.23535 13.868L3.22469 13.8911L2.97547 13.7761C2.40551 13.513 1.74507 13.1129 1.22848 12.4567C0.691295 11.7743 0.386719 10.9129 0.386719 9.87693V9.60244H3.20241V9.87693C3.20241 9.92922 3.20403 9.97851 3.20705 10.025L3.20844 10.0463L3.2065 10.0677C3.20371 10.0982 3.2023 10.1291 3.2023 10.1603C3.2023 10.7928 3.82094 11.4104 4.78746 11.5557L4.79397 11.5567L4.80041 11.558C4.95298 11.5884 5.10489 11.6036 5.2564 11.6036C5.70989 11.6036 6.09378 11.5457 6.41303 11.4366C6.727 11.3172 6.9561 11.15 7.11522 10.9417L7.11767 10.9385L7.12022 10.9354C7.28063 10.7378 7.37128 10.4733 7.37128 10.1189C7.37128 9.85231 7.28969 9.65672 7.13951 9.50699L7.1338 9.5013L7.12843 9.49528C6.96362 9.31042 6.73485 9.14812 6.43178 9.01383L6.42796 9.01214L6.4242 9.01033C6.10892 8.85898 5.74944 8.72353 5.34458 8.60481L5.33989 8.60343L5.33525 8.60189C4.92876 8.4668 4.51638 8.31957 4.09813 8.16021C3.7962 8.05964 3.49484 7.94056 3.19407 7.80312L3.18985 7.80119L3.18569 7.79912C2.87931 7.64639 2.59127 7.47416 2.32184 7.28228L2.31924 7.28044L2.31669 7.27853C2.05266 7.0811 1.81549 6.85107 1.60531 6.58913L1.60062 6.58329L1.59626 6.5772C1.39496 6.29623 1.23605 5.97801 1.11796 5.6248C0.996191 5.26061 0.938373 4.84524 0.938373 4.38333C0.938373 3.64028 1.12203 2.97647 1.49689 2.40199C1.86828 1.82062 2.38431 1.36742 3.03671 1.04181Z" fill="#052855"/>\n</svg>\n',pu=function(e){return'<button class="btn '.concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item ").concat(Ha.SHOP_BY_FAST_CHECKOUT,'-securey">\n  <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M10.4851 3.19066C8.89661 3.19066 7.60892 4.47835 7.60892 6.06679V6.98466H13.3612V6.06679C13.3612 4.47835 12.0735 3.19066 10.4851 3.19066ZM6.01787 6.06679V6.98466H5.5895C4.23763 6.98466 3.14172 8.08056 3.14172 9.43243V15.5519C3.14172 16.9037 4.23763 17.9996 5.5895 17.9996H15.3806C16.7324 17.9996 17.8284 16.9037 17.8284 15.5519V9.43243C17.8284 8.08056 16.7324 6.98466 15.3806 6.98466H14.9522V6.06679C14.9522 3.59964 12.9522 1.59961 10.4851 1.59961C8.0179 1.59961 6.01787 3.59964 6.01787 6.06679ZM5.5895 8.57571H15.3806C15.8537 8.57571 16.2373 8.95927 16.2373 9.43243V15.5519C16.2373 16.025 15.8537 16.4086 15.3806 16.4086H5.5895C5.11634 16.4086 4.73278 16.025 4.73278 15.5519V9.43243C4.73278 8.95927 5.11634 8.57571 5.5895 8.57571ZM11.2194 12.7853C11.6584 12.5313 11.9538 12.0567 11.9538 11.513C11.9538 10.7019 11.2962 10.0444 10.4851 10.0444C9.67399 10.0444 9.01645 10.7019 9.01645 11.513C9.01645 12.0566 9.31176 12.5312 9.75071 12.7852V14.4504C9.75071 14.8559 10.0795 15.1847 10.485 15.1847C10.8906 15.1847 11.2194 14.8559 11.2194 14.4504V12.7853Z" fill="#052855"/>\n  </svg>\n  <span>').concat(e,"</span>\n</button>")},hu=function(e){La(n,Va);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Na(e);if(t){var o=Na(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Da(this,n)}}(n);function n(e){var r;w(this,n),S(ja(r=t.call(this,e)),"isCheckout",!1),S(ja(r),"render",b(D.mark((function e(){var t;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.logger.info("render"),r.needRender){e.next=3;break}return e.abrupt("return",[]);case 3:return t=r.insertDom(),r.addListener(),r.isCheckout||r.createAnimateInterval(),r.renderedList=t,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))),S(ja(r),"insertDom",(function(){var e,t,n=r.config.paymentConfig,o=tc(n).includes(Fa.SHOP_BY_FAST_CHECKOUT);if(r.logger.info("insertDom hasShopby",{data:o}),!o)return[];var i='<div class="'.concat(Ha.COMMON_ITEM," ").concat(Ha.BUTTON_HIDE," ").concat(Ha.SHOP_BY_FAST_CHECKOUT,'">\n      <div class="').concat(Ha.SHOP_BY_FAST_CHECKOUT,'-group">\n        ').concat(pu(du("unvisiable.shopby.button.show")),'\n        <button class="btn ').concat(Ha.SHOP_BY_FAST_CHECKOUT,'-item shopby-text-btn">\n          ').concat(fu,'\n          <span>Checkout</span>\n        </button>\n      </div>\n      <span class="loading-icon" />\n    </div>');return r.isCheckout&&(i='<div class="'.concat(Ha.COMMON_ITEM," ").concat(Ha.BUTTON_HIDE," ").concat(Ha.SHOP_BY_FAST_CHECKOUT,' checkout">\n        <div class="').concat(Ha.SHOP_BY_FAST_CHECKOUT,'-group">\n          <button class="btn ').concat(Ha.SHOP_BY_FAST_CHECKOUT,'-item shopby-text-btn">\n            ').concat(fu,'\n          </button>\n        </div>\n        <span class="loading-icon" />\n      </div>')),null===(e=r.container)||void 0===e||e.insertAdjacentHTML("beforeend",i),r.buttonElement=(null===(t=r.container)||void 0===t?void 0:t.querySelector(".".concat(Ha.SHOP_BY_FAST_CHECKOUT)))||null,[Fa.SHOP_BY_FAST_CHECKOUT]})),S(ja(r),"addListener",(function(){var e=ja(r).buttonElement;e&&(e.removeEventListener("click",r.handleClick),e.addEventListener("click",r.handleClick))})),S(ja(r),"handleClick",function(){var e=b(D.mark((function e(t){var n,o,i,a,c,s,u,l,d,f,p,h,y,v,m,g,b,w;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=r.config,c=a.paymentConfig.buttonLocation,s=a.saveAbandonedOrder,u=a.props,l=u.isPreview,d=u.toast,dc.reportPayButtonClick(Fa.SHOP_BY_FAST_CHECKOUT,c),!l){e.next=7;break}return r.logger.info("toast"),d(du("products.product_details.link_preview_does_not_support")),e.abrupt("return");case 7:if(!r.isDisabled&&!r.isLoading){e.next=10;break}return r.logger.info("",{data:{isDisabled:r.isDisabled,isLoading:r.isLoading}}),e.abrupt("return");case 10:return r.setLoading(!0),e.next=13,s(Fa.SHOP_BY_FAST_CHECKOUT);case 13:if(f=e.sent,p=f.canContinue,h=f.abandonedInfo,p){e.next=19;break}return r.setLoading(!1),e.abrupt("return");case 19:if(y=lu(r.config.paymentConfig),v=r.marketCountry||bc("localization")||(null===(n=window.__PRELOAD_STATE__)||void 0===n||null===(o=n.request)||void 0===o||null===(i=o.cookie)||void 0===i?void 0:i.localization),h&&y&&v){e.next=24;break}return r.logger.error("fc",{data:{abandonedInfo:h,domain:y,country:v},error:new Error}),e.abrupt("return");case 24:m=window.Shopline.storeId,g="".concat(y,"/checkouts/").concat(m,"/").concat(h.checkoutToken),b="?mark=".concat(h.mark,"&clientLang=").concat(window.Shopline.locale,"&country=").concat(v,"&domain=").concat(window.origin),w="".concat(g).concat(b),r.logger.info("fc",{data:w}),window.location.href=w;case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(ja(r),"destroy",(function(){var e;r.timer&&window.clearInterval(r.timer),null===(e=r.buttonElement)||void 0===e||e.removeEventListener("click",r.handleClick)}));var o=e.buttonTypes,i=e.props.marketInfo;return r.logger=r.config.props.logger.pipeOwner("FastButton"),r.needRender=Cc(Ma.Fast,o),r.isCheckout=r.config.paymentConfig.buttonLocation===Ra.Checkout,r.marketCountry=null==i?void 0:i.marketRegionCountryCode,r}return k(n,[{key:"isButtonInViewPort",value:function(){if(!this.buttonElement)return!1;var e=window.innerWidth||document.documentElement.clientWidth,t=window.innerHeight||document.documentElement.clientHeight,n=this.buttonElement.getBoundingClientRect(),r=n.top,o=n.right,i=n.bottom,a=n.left;return r>=0&&a>=0&&o<=e&&i<=t}},{key:"createAnimateInterval",value:function(){this.timer=setInterval(this.addAnimateClass.bind(this),100)}},{key:"addAnimateClass",value:function(){var e,t=null===(e=this.buttonElement)||void 0===e?void 0:e.querySelector(".".concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group"));this.isButtonInViewPort()&&t&&(t.classList.add("shopby-button-slide"),this.timer&&window.clearInterval(this.timer))}}]),n}(),yu=k((function e(t){var n=this;w(this,e),S(this,"needRender",!0),S(this,"show",(function(){var e;if(n.needRender){var t=n.config.props,r=t.layout,o=t.extraBuyNowDomId,i=tc(n.config.paymentConfig),a=nc(n.config.paymentConfig),c=i.includes(Fa.SHOP_BY_FAST_CHECKOUT),s=i.includes(Fa.BUY_NOW),u=1;a?u=c?2:1:c&&s?u=2:(c||s)&&(u=1),n.logger.info("",{data:u});var l='<div class="'.concat(Ha.COMMON_ITEM," ").concat(Ha.BUTTON_SKELETON,'"></div>');if(r===Ka.BuyNowRow&&s&&o){var d=document.getElementById(o);null==d||d.insertAdjacentHTML("beforeend",l),u--}null===(e=n.container)||void 0===e||e.insertAdjacentHTML("beforeend",new Array(u).fill('<div class="'.concat(Ha.COMMON_ITEM," ").concat(Ha.BUTTON_SKELETON,'"></div>')).join(""))}})),S(this,"hide",(function(){var e;if(n.needRender){var t=n.config.props,r=t.layout,o=t.extraBuyNowDomId,i=null===(e=n.container)||void 0===e?void 0:e.querySelectorAll(".".concat(Ha.BUTTON_SKELETON));if(null==i||i.forEach((function(e){e.remove()})),r===Ka.BuyNowRow&&o){var a,c=document.getElementById(o);null==c||null===(a=c.querySelector(".".concat(Ha.BUTTON_SKELETON)))||void 0===a||a.remove()}}})),this.config=t,this.logger=this.config.props.logger;var r=this.config,o=r.domId,i=r.paymentConfig.buttonLocation;this.container=document.getElementById(o),this.needRender=i!==Ra.Cart})),vu="pay-button-common-style-sheet-id",mu=function(){},gu=function(e){var t=e.domId,n=e.props.layout,r=document.getElementById(t);r&&(r.dataset.payButtonLayout=n),function(){if(!document.getElementById(vu)){var e=document.createElement("style");e.setAttribute("id",vu),e.innerHTML="\n  /* -----  ----- */\n  @keyframes skeleton {\n    0% {\n      background-position: 100% 50%;\n    }\n    100% {\n      background-position: 0 50%;\n    }\n  }\n  .".concat(Ha.BUTTON_SKELETON," {\n    background: linear-gradient(\n      90deg,\n      hsla(0, 0%, 74.5%, 0.2) 25%,\n      hsla(0, 0%, 50.6%, 0.24) 37%,\n      hsla(0, 0%, 74.5%, 0.2) 63%\n    );\n    background-size: 400% 100%;\n    animation: skeleton 2s linear infinite;\n  }\n\n  /* ----- loading ----- */\n  @keyframes rotate {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(359deg);\n    }\n  }\n  .").concat(Ha.BUTTON_LOADING," .loading-icon {\n    display: inline-block;\n    position: absolute;\n    border: 2px solid white;\n    top: calc(50% - 8px);\n    left: calc(50% - 8px);\n    width: 16px;\n    height: 16px;\n    border-radius: 16px;\n    clip-path: polygon(0% 0%, 100% 0%, 100% 70%, 0% 70%);\n    animation: rotate 1s linear infinite;\n  }\n  \n  /* -----  ----- */\n  .").concat(Ha.BUTTON_MASK," {\n    cursor: pointer;\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: 100%;\n    z-index: 101;\n  }\n\n  /* -----  ----- */\n  .").concat(Ha.BUTTON_HIDE," {\n    display: none !important;\n  }\n  .").concat(Ha.COMMON_ITEM," {\n    position: relative;\n    overflow: hidden;\n  }\n\n  /* ----- buy now ----- */\n  .").concat(Ha.BUY_NOW," {\n    line-height: 1;\n  }\n  .").concat(Ha.BUY_NOW,".").concat(Ha.BUTTON_LOADING," .").concat(Ha.BUY_NOW,"-text{\n      opacity: 0;\n  }\n\n  /* ----- more options ----- */\n  .").concat(Ha.MORE_OPTIONS," {\n    color: #000000;\n    cursor: pointer;\n    font-family: Helvetica Neue;\n    font-size: 14px;\n    font-weight: 500;\n    margin-top: 15px;\n    text-align: center;\n    text-decoration: underline;\n  }\n\n  .").concat(Ha.MORE_OPTIONS,".").concat(qa,"{\n    color: var(--color-text);\n  }\n\n  /* ----- paypal ----- */\n  .").concat(Ha.PAY_PAL," {\n    line-height: 0;\n  }\n  .").concat(Ha.PAY_PAL," .").concat(Ha.PAY_PAL_BG_BEFORE,",\n  .").concat(Ha.PAY_PAL," .").concat(Ha.PAY_PAL_BG_AFTER," {\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: calc(50% - 6px);\n    opacity: 0;\n  }\n  .").concat(Ha.PAY_PAL," .").concat(Ha.PAY_PAL_BG_BEFORE," {\n    top: 0;\n  }\n  .").concat(Ha.PAY_PAL," .").concat(Ha.PAY_PAL_BG_AFTER,' {\n    bottom: 0;\n  }\n\n  /* ----- shop by ----- */\n  @keyframes shopby-button-slide-rtl {\n    0% {\n      transform: translateX(-50%);\n    }\n    25% {\n      transform: translateX(0%);\n    }\n    80% {\n      transform: translateX(0%);\n    }\n    100% {\n      transform: translateX(50%);\n    }\n  }\n\n  @keyframes shopby-button-slide {\n    0% {\n      transform: translateX(50%);\n    }\n    25% {\n      transform: translateX(0%);\n    }\n    80% {\n      transform: translateX(0%);\n    }\n    100% {\n      transform: translateX(-50%);\n    }\n  }\n  .shopby-button-slide {\n    animation: shopby-button-slide 1.5s;\n    animation-fill-mode: forwards;\n  }\n\n  html[dir="rtl"] .shopby-button-slide {\n    animation: shopby-button-slide-rtl 1.5s;\n    animation-fill-mode: forwards;\n  }\n\n  .').concat(Ha.SHOP_BY_FAST_CHECKOUT," {\n    background-color: #60F5B2;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT,".").concat(Ha.BUTTON_DISABLED," {\n    cursor: not-allowed;\n    opacity: .3;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT,".").concat(Ha.BUTTON_DISABLED," button {\n    cursor: not-allowed;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group {\n    height: 100%;\n    width: 200%;\n    display: flex;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT,".checkout .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group {\n    width: 100%;\n    height: 100%;\n    transform: none;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex: 1;\n    font-family: PingFang SC;\n    background-color: #60f5b2;\n    border: none;\n    cursor: pointer;\n    color: #052855;\n    margin: 0;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item:hover {\n    background-color: #60e1b2;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item:active, .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item:focus {\n    background-color: #60ffb2;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,'-item svg {\n    margin-right: 6px;\n  }\n\n  html[dir="rtl"] .').concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item svg {\n    margin-left: 6px;\n  }\n\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-item span {\n    font-style: normal;\n    font-weight: 600;\n    line-height: normal;\n    letter-spacing: -0.02em;\n    font-size: 16px;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-securey {\n    background: #3dee9f;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," .").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-group ").concat(Ha.SHOP_BY_FAST_CHECKOUT,"-securey span {\n    font-weight: 600;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT,".").concat(Ha.BUTTON_LOADING," {\n    opacity: 0.3;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT,".").concat(Ha.BUTTON_LOADING," .loading-icon {\n    border-color: #052855;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT,".").concat(Ha.BUTTON_LOADING," > div {\n    visibility: hidden;\n  }\n\n  /* -----  ----- */\n  .").concat(Ha.BUY_NOW," {\n    order: 1;\n  }\n  .").concat(Ha.PAY_PAL," {\n    order: 2;\n  }\n  .").concat(Ha.GOOGLE_PAY," {\n    order: 3;\n  }\n  .").concat(Ha.APPLE_PAY," {\n    order: 4;\n  }\n  .").concat(Ha.SHOP_BY_FAST_CHECKOUT," {\n    order: 5;\n  }\n  .").concat(Ha.MORE_OPTIONS,' {\n    order: 6;\n  }\n  [data-pay-button-layout="').concat(Ka.Column,'"],\n  [data-pay-button-layout="').concat(Ka.BuyNowRow,'"] {\n    display: flex;\n    flex-direction: column;\n    margin: -5px 0;\n  }\n  [data-pay-button-layout="').concat(Ka.Column,'"] .').concat(Ha.COMMON_ITEM,',\n  [data-pay-button-layout="').concat(Ka.BuyNowRow,'"] .').concat(Ha.COMMON_ITEM,',\n  [data-pay-button-layout="').concat(Ka.Column,'"] .').concat(Ha.COMMON_ITEM_LAYOUT,',\n  [data-pay-button-layout="').concat(Ka.BuyNowRow,'"] .').concat(Ha.COMMON_ITEM_LAYOUT,' {\n    margin: 5px 0;\n    flex-shrink: 0;\n    flex-grow: 0;\n  }\n  [data-pay-button-layout="').concat(Ka.Row,'"] {\n    display: flex;\n  }\n  [data-pay-button-layout="').concat(Ka.Row,'"] > .').concat(Ha.COMMON_ITEM,' {\n    margin-top: 0;\n    margin-right: 12px;\n  }\n  [data-pay-button-layout="').concat(Ka.Checkout,'"] {\n    display: flex;\n    flex-wrap: wrap;\n    margin: -7px -6px;\n  }\n  [data-pay-button-layout="').concat(Ka.Checkout,'"] .').concat(Ha.COMMON_ITEM,' {\n    margin: 7px 6px;\n  }\n  [data-pay-button-layout="').concat(Ka.Checkout,'"] .').concat(Ha.COMMON_ITEM,":not(.").concat(Ha.PAY_PAL,") {\n    flex-basis: 1px;\n    flex-grow: 1;\n    padding: 0;\n  }\n  "),document.body.appendChild(e)}}(),mu=function(e){var t=e.domId,n=e.props.extraBuyNowDomId,r=document.getElementById(t),o=document.createElement("style");return o.innerHTML="\n  /* -----  ----- */\n  #".concat(t," .").concat(Ha.COMMON_ITEM," ").concat(n?",#".concat(n," .").concat(Ha.COMMON_ITEM):""," {\n    height: ").concat(e.props.style.height,"px;\n    width: ").concat(e.props.style.width?"".concat(e.props.style.width,"px"):"100%",";\n    border-radius: ").concat(e.props.style["border-radius"],"px;\n  }\n\n  /* ----- paypal ----- */\n  #").concat(t," .").concat(Ha.PAY_PAL," {\n    min-height: ").concat(e.props.style.height,"px;\n    height: auto;\n    border-radius: 0px;\n    z-index: 1;\n  }\n  "),null==r||r.appendChild(o),function(){null==r||r.removeChild(o)}}(e)},bu=function(){function e(t){w(this,e),S(this,"renderedButtonCount",0),this.config=t,this.container=this.getContainer(),this.logger=t.props.logger.pipeOwner("Collapse")}return k(e,[{key:"getContainer",value:function(){if(!this.container){var e=document.getElementById(this.config.domId);if(!e)throw new Error("Please check if the DOM node in the configuration is valid.");this.container=e}return this.container}},{key:"init",value:function(e){var t=this.config,n=t.displayButtonCount,r=t.props,o=r.layout,i=r.extraBuyNowDomId,a=t.paymentConfig;if(!nc(a)){this.renderedButtonCount=e;var c=o===Ka.BuyNowRow&&i,s=c?1:2;if(c&&(this.renderedButtonCount=e-1),n)return this.renderedButtonCount>s&&this.renderedButtonCount>n?(this.addContainerAnimation(n),void this.createCollapseButton(n)):void 0}}},{key:"update",value:function(e){e!==this.renderedButtonCount&&(this.logger.info("update",{data:{renderedButtonCount:e}}),this.remove(),this.computedStyleCache=null,this.init(e))}},{key:"remove",value:function(){this.config.displayButtonCount&&(this.container.classList.add("remove"),this.removeCollapseButton())}},{key:"addContainerAnimation",value:function(e){var t=this.config.domId,n=this.computeStyle(e).collapseHeight;this.container.classList.remove("remove");var r=Oc("\n      #".concat(t," {\n        height: ").concat(n,"px;\n        overflow: hidden;\n        transition: height 0.3s ease;\n      }\n\n      #").concat(t,".remove {\n        height: auto;\n      }\n    ")),o=r.style,i=r.cssInsertBefore;this.container.contains(o)||i(this.container)}},{key:"createCollapseButton",value:function(e){if(!this.collapseButton){var t=Or(),n=this.container,r=n.parentNode;r||this.logger.log("Cannot find the parent node, affecting the mounting of the collapse button",{data:{container:n}});var o=this.computeStyle(e),i=o.buttonHeight,a=o.containerHeight,c=o.collapseHeight;o.buttonMargin;var s=document.createElement("button");s.id="more-payment-".concat(gc(),"-button"),s.className=Ha.BUTTON_COLLAPSE,s.innerHTML="".concat(t("sdk.button.show")).concat('<svg id="arrowIcon" class="flip-vertical" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.899486 3.44971L4.94974 7.49996L9 3.44971" stroke="#29252C" stroke-width="1.5" stroke-linecap="round"/></svg>');var u=Oc("\n      #".concat(s.id," {\n        height: ").concat(i,"px;\n        min-height: ").concat(i,"px;\n        width: 100%;\n        text-align: center;\n        background: transparent;\n        line-height: ").concat(i,"px;\n        margin-bottom: 0;\n        border: none;\n        font-weight: 500;\n        font-size: 14px;\n        color: #29252C;\n      }\n\n      #").concat(s.id,":active {\n        -webkit-tap-highlight-color: transparent;\n        -webkit-tap-highlight-color: rgba(0,0,0,0);\n      }\n\n      #").concat(s.id," svg {\n        margin-left: 10px;\n      }\n\n      #").concat(s.id," svg.flip-vertical {\n        transform: scaleY(-1);\n      }\n    ")),l=u.style,d=u.cssInsertBefore;null==r||r.insertBefore(s,n.nextSibling),d(s);var f=null==r?void 0:r.querySelector("#arrowIcon");s.addEventListener("click",(function(){if(Math.abs(Number.parseInt(n.style.height)-a)<=1)return n.style.height="".concat(c,"px"),void(null==f||f.classList.add("flip-vertical"));n.style.height="".concat(a,"px"),null==f||f.classList.remove("flip-vertical")})),l.id="collapse-button-style",this.collapseButton=s}}},{key:"removeCollapseButton",value:function(){var e,t;null===(e=this.collapseButton)||void 0===e||e.remove(),this.collapseButton=null,null===(t=this.container.querySelector("#collapse-button-style"))||void 0===t||t.remove()}},{key:"computeStyle",value:function(e){if(this.computedStyleCache)return this.logger.info("computeStyle cache",{data:{style:this.computedStyleCache}}),this.computedStyleCache;var t=this.config.props.style,n=this.container.querySelectorAll(".".concat(Ha.COMMON_ITEM)),r=n[n.length-1];r||this.logger.warn("Unable to calculate container height accurately, will return offsetHeight.",{data:{container:this.container}});var o=(null==r?void 0:r.offsetHeight)||t.height,i=r?2*parseInt(window.getComputedStyle(r).marginTop):this.container.offsetHeight,a=(o+i)*this.renderedButtonCount,c={buttonHeight:o,containerHeight:a,buttonMargin:i,collapseHeight:a-(o+i)*(this.renderedButtonCount-e)};return this.computedStyleCache=c,this.logger.info("computeStyle",{data:{style:c}}),c}}]),e}(),wu=function(){function e(){w(this,e),S(this,"queue",[]),S(this,"running",!1)}var t;return k(e,[{key:"enqueue",value:function(e,t){this.queue.push(e),this.running||this.run(t)}},{key:"run",value:(t=b(D.mark((function e(t){var n;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!0;case 1:if(!(this.queue.length>0)){e.next=9;break}if(n=this.queue.shift(),e.t0=n,!e.t0){e.next=7;break}return e.next=7,n();case 7:e.next=1;break;case 9:null==t||t(),this.running=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clear",value:function(){this.queue=[]}}]),e}();function _u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_u(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cu=function(){function e(t){var n=this;w(this,e),S(this,"renderPromise",null),S(this,"rerenderAsyncQueue",new wu),S(this,"isVisible",!0),S(this,"render",b(D.mark((function e(){var t,r;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.logger.info(""),t=n.config.domId,n.container){e.next=5;break}return n.logger.error("pay button can not find container",{data:n.container}),e.abrupt("return");case 5:if("true"!==n.container.dataset.rendered){e.next=8;break}return n.logger.warn("",{data:t}),e.abrupt("return");case 8:return n.container.dataset.rendered="true",Gc(n.config,n.logger),r=function(){var e=b(D.mark((function e(){var t;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cr(window.Shopline.locale||"en");case 2:return gu(n.config),n.isVisible&&n.skeleton.show(),t=!0,e.next=7,n.expressButton.render().catch((function(e){n.logger.error("",{error:e}),t=!1}));case 7:return e.next=9,n.fastButton.render().catch((function(e){n.logger.error("",{error:e}),Kc(Fa.SHOP_BY_FAST_CHECKOUT,n.logger,e)}));case 9:if(t){e.next=15;break}return zc(n.config,n.logger),e.next=13,n.normalButton.render(Fa.BUY_NOW).catch((function(e){n.logger.error("",{error:e}),Kc(Fa.BUY_NOW,n.logger,e)}));case 13:e.next=17;break;case 15:return e.next=17,n.normalButton.render().catch((function(e){n.logger.error("",{error:e}),Zc(n.config,n.logger,e)}));case 17:n.collapse.init(n.getRenderedButtons().length),n.injectRenderedButtonsToContainer(),n.skeleton.hide(),n.isVisible&&n.setVisible(!0),n.logger.info("");case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.renderPromise=r(),e.next=14,n.renderPromise;case 14:case"end":return e.stop()}}),e)})))),S(this,"rerender",function(){var e=b(D.mark((function e(t,r){var o;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.info("rerender",{data:{paymentConfig:t}}),e.next=3,n.renderPromise;case 3:o=function(){var e=b(D.mark((function e(){return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.expressButton.rerender(t);case 2:n.injectRenderedButtonsToContainer();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.rerenderAsyncQueue.enqueue(o,null==r?void 0:r.afterRerender);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),S(this,"setDisabled",function(){var e=b(D.mark((function e(t,r){return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.info("setDisabled",{data:{value:t,options:r}}),e.next=3,n.renderPromise;case 3:n.normalButton.setDisabled(t,r),n.expressButton.setDisabled(t),n.fastButton.setDisabled(t,r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),S(this,"setVisible",function(){var e=b(D.mark((function e(t,r){return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.info("setVisible",{data:{value:t,options:r}}),n.isVisible=t,e.next=4,n.renderPromise;case 4:[{type:Ma.Express,instance:n.expressButton},{type:Ma.Normal,instance:n.normalButton},{type:Ma.Fast,instance:n.fastButton}].forEach((function(e){var n=e.type,o=e.instance;Cc(n,null==r?void 0:r.buttonTypes)&&o.setVisible(t)})),t&&n.reportButtonView(),n.collapse.update(n.getRenderedButtons().length),n.injectRenderedButtonsToContainer();case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),S(this,"setSubscription",function(){var e=b(D.mark((function e(t){return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.info("setSubscription",{data:{value:t}}),e.next=3,n.renderPromise;case 3:n.expressButton.setSubscription(t),n.normalButton.setSubscription(t),n.collapse.update(n.getRenderedButtons().length),n.injectRenderedButtonsToContainer();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(this,"customButtons",function(){var e=b(D.mark((function e(t){var r,o,i,a,c,s,u,l,d;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.logger.log(" customButtons",{data:Ou({},t)}),e.next=3,n.renderPromise;case 3:r=0,o=Object.entries(t);case 4:if(!(r<o.length)){e.next=15;break}if(a=m(o[r],2),c=a[0],s=a[1],u=s.className,l=null===(i=n.container)||void 0===i?void 0:i.querySelector(".".concat(Ha[c])),![Fa.BUY_NOW,Fa.MORE_OPTIONS].includes(c)){e.next=11;break}return n.normalButton.customButton(c,s),e.abrupt("continue",12);case 11:u&&l&&(d=l.classList).add.apply(d,v(u.split(" ")));case 12:r++,e.next=4;break;case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S(this,"getButtonElement",(function(e){var t,r=Ha[e];return null===(t=n.container)||void 0===t?void 0:t.querySelectorAll(".".concat(r))})),S(this,"preProcessConfig",(function(e){var t,n=e.props.style,r=Ya.height;"number"==typeof(null==n?void 0:n.height)&&(r=n.height<40?40:n.height>55?55:n.height);var o="number"==typeof(null==n?void 0:n.width)?n.width:Ya.width,i="number"==typeof(null==n?void 0:n["border-radius"])?n["border-radius"]:Ya["border-radius"];return Ou(Ou({},e),{},{props:Ou(Ou({},e.props),{},{isVisible:!1!==e.props.isVisible,layout:null!==(t=e.props.layout)&&void 0!==t?t:Ka.Column,logger:e.props.logger.pipeOwner("@sl/pay-button"),style:{width:o,height:r,"border-radius":i}})})})),S(this,"reportedButtonViewList",[]),S(this,"reportButtonView",(function(){var e,t=n.config.paymentConfig.buttonLocation,r=null===(e=n.container)||void 0===e?void 0:e.querySelectorAll(".".concat(Ha.COMMON_ITEM,", .").concat(Ha.MORE_OPTIONS));null==r||r.forEach((function(e){var r=rc(e);_c(e)||!r||n.reportedButtonViewList.includes(r)||(n.reportedButtonViewList.push(r),dc.reportPayButtonView(r,t))}))}));var r=this.preProcessConfig(t),o=r.domId,i=r.props.isVisible;this.config=r,this.container=document.getElementById(o),this.logger=r.props.logger.pipeOwner("PayButton"),this.logger.info("",{data:Ou({},t)}),this.isVisible=i,this.skeleton=new yu(r),this.normalButton=new jc(r),this.expressButton=new uu(r),this.fastButton=new hu(r),this.collapse=new bu(r)}return k(e,[{key:"getRenderedButtons",value:function(){var e=[].concat(v(this.expressButton.getRenderedList()),v(this.normalButton.getRenderedList()),v(this.fastButton.getRenderedList()));return this.config.paymentConfig.buttonLocation===Ra.Cart&&e.push(Fa.CHECKOUT),e}},{key:"injectRenderedButtonsToContainer",value:function(){var e;null===(e=this.container)||void 0===e||e.setAttribute("data-inject-rendered-buttons",this.getRenderedButtons().join(","))}},{key:"destroy",value:function(){try{if(this.expressButton.destroy(),this.normalButton.destroy(),this.fastButton.destroy(),function(e){var t=e.domId,n=document.getElementById(vu),r=document.getElementById(t);r&&delete r.dataset.payButtonLayout,n&&document.body.removeChild(n),mu()}(this.config),this.rerenderAsyncQueue.clear(),this.container){delete this.container.dataset.rendered,this.container.removeAttribute("data-inject-rendered-buttons"),this.container.innerHTML="";var e=this.container.parentNode;null==e||e.querySelectorAll(":scope > style").forEach((function(t){return e.removeChild(t)}))}}catch(e){this.logger.error("destroy error",{error:e})}}},{key:"getI18nTranslator",value:function(){return Or()}}]),e}();function ku(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Su(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ku(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Eu,Pu,Iu={options:{skipNull:!0,skipEmptyString:!0}},xu={SignIn:(Eu="/user/signIn",window.Shopline&&window.Shopline.redirectTo&&window.Shopline.redirectTo(Eu)||Eu),Checkout:"/trade/checkout",Checkouts:"/checkouts"},Tu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.query,r=t.fragmentIdentifier,o=t.fullQuery,i=void 0===o||o,a=Os.parseUrl(window.location.href,Su(Su({},Iu.options),{},{parseFragmentIdentifier:!0})),c=i?Su(Su({},a.query||{}),n||{}):Su({},n),s=Os.stringifyUrl({url:e,query:c,fragmentIdentifier:r||a.fragmentIdentifier},Iu.options),u="".concat(window.location.protocol,"//").concat(window.location.host).concat(s);return Su(Su({originUrl:e},a),{},{query:c,url:s,wholeUrl:u})};!function(e){e.AMOUNT_EXCEEDS_LIMIT="TCTDEXCEEDED_MAX_AMOUNT_LIMIT",e.ABANDONED_RISK_CONTROL="TRD_123768_B1409"}(Pu||(Pu={}));var ju={PRODUCT_VERIFY:"product_verify",SAVE_ORDER:"save_order",NetworkUnstable:Ve.NetworkUnstable,RateLimited:Ve.RateLimited},Au=[Ve.NetworkUnstable,Ve.RateLimited];function Lu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Du(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lu(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nu=Or(),Bu=function(e,t){var n=t.logger,r=t.query,o=t.associateCart,i=Boolean(bc("osudb_uid")),a=function(){var e,t;return window.Shopline.themeTypeVersion>=2.1?window.__customer_accounts_enabled__:"ONLY_LOGIN"===(null===(e=window.__PRELOAD_STATE__)||void 0===e||null===(t=e.tradeSettleConfig)||void 0===t?void 0:t.loginType)}(),c=!i&&a;null==n||n.info("checkout/save ",{data:{isLogin:i,needLogin:a,redirectToSignIn:c}});var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.query,r=void 0===n?{}:n,o=t.associateCart,i=t.abandonedOrderMark,a=void 0===i?"":i,c="".concat(window.location.protocol,"//").concat(window.location.host),s=e.storeId,u=e.checkoutToken,l=e.seq;return Tu(u?"".concat(c,"/").concat(s).concat(xu.Checkouts,"/").concat(u):"".concat(c).concat(xu.Checkout,"/").concat(l),{query:Su(Su({buyScence:o?"cart":"detail"},r),{},{mark:a}),fullQuery:!1}).url}({storeId:window.Shopline.storeId,checkoutToken:e.checkoutToken,seq:e.seq},{query:Du(Du({},r),{},{spb:c?null:null==r?void 0:r.spb}),associateCart:o});if(c){var u="".concat(window.location.protocol,"//").concat(window.location.host),l=Tu("".concat(u).concat(xu.SignIn),{query:{redirectUrl:s},fullQuery:!1}).url;return null==n||n.info("checkout/save ",{data:{url:l,abandonedInfo:e,needLogin:!0}}),{url:l,abandonedInfo:e,needLogin:!0}}return null==n||n.info("checkout/save ",{data:{url:s,abandonedInfo:e,needLogin:!1}}),{url:s,abandonedInfo:e,needLogin:!1}},Ru=function(e,t){var n=t.logger,r=t.toast,o=Xs(e,{logger:n}),i=o.isNetworkError,a=o.isRateLimited,c=o.isServiceUnavailable,s=o.errorForLog,u=o.message;o.endpoint;var l=o.httpStatusCode,d=o.bizErrorCode,f=ju.SAVE_ORDER;return c?f=i?ju.NetworkUnstable:ju.RateLimited:(function(e,t,n){switch(null==e||e.info("[PayButton bizerror: ".concat(t,"]")),t){case Pu.AMOUNT_EXCEEDS_LIMIT:n("cart.checkout.max_amount_limit");break;case Pu.ABANDONED_RISK_CONTROL:n("general.abandon.Order.risk");break;default:n("cart.error.order")}}(n,d,(function(e){r(Nu(e))})),f=ju.SAVE_ORDER),null==n||n.error("[PayButton Checkout Save Error]".concat(u?": ".concat(u):""),{error:s,data:{bizErrorCode:d,httpStatusCode:l,message:u,extra:t,from:"STANDARD_BUTTON",isNetworkError:i,isRateLimited:a,originalError:e}}),Promise.resolve({errorType:f})},Mu=function(){var e=b(D.mark((function e(t){var n,r,o,i,a,c,s,u,l,d;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.products,r=t.associateCart,o=void 0!==r&&r,i=t.discountCodes,a=t.useMemberPoint,c=t.logger,s=t.notSupportSubscriptionCheck,u=void 0!==s&&s,e.prev=1,l=[],"function"!=typeof n){e.next=9;break}return e.next=6,n();case 6:l=e.sent,e.next=10;break;case 9:l=n;case 10:if(l){e.next=13;break}return null==c||c.log("",{data:{products:l,getProducts:n}}),e.abrupt("return",Promise.resolve({errorType:ju.PRODUCT_VERIFY}));case 13:return null==c||c.info("checkout/save ",{data:{products:l,associateCart:o,discountCodes:i}}),e.next=16,Rs({products:l,associateCart:o,discountCodes:i,useMemberPoint:a,notSupportSubscriptionCheck:u});case 16:return d=e.sent,null==c||c.info("checkout/save ",{data:d}),e.abrupt("return",Bu(d,t));case 21:return e.prev=21,e.t0=e.catch(1),e.abrupt("return",Ru(e.t0,t));case 24:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}();!function(){var e=b(D.mark((function e(t){var n,r,o,i;return D.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.logger,r=t.notSupportSubscriptionCheck,o=void 0!==r&&r,e.next=4,Fs({notSupportSubscriptionCheck:o});case 4:return i=e.sent,null==n||n.info("cart save abandoned order response",{data:Du({},i)}),e.abrupt("return",Bu(i,t));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Ru(e.t0,t));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))}();var Fu=function(e){var t=e.abandonedSeq,n=e.logger;try{sessionStorage.setItem(function(e){if("undefined"==typeof window)return"";var t=window&&window.encodeURI("checkout_track");return window&&window.btoa(t)}(),"[]"),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent));n&&(r+="; path=".concat(n)),document.cookie=r}("".concat(t,"_fb_data"),JSON.stringify({tp:1,et:Date.now(),ed:wc(),currency:window.Shopline.currency}))}catch(e){null==n||n.error("",{error:e})}};function Hu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Uu(e,t){if(e){if("string"==typeof e)return Hu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hu(e,t):void 0}}function qu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||Uu(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Yu=function(e){return function(e,t){return Object.prototype.toString.call(e)===t}(e,"[object Object]")},Gu=function(){return Number(Math.random().toString().slice(2)+Date.now()).toString(36)};function Vu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vu(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wu,Ku,Xu;function Ju(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $u(e,t){if(e){if("string"==typeof e)return Ju(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ju(e,t):void 0}}function Zu(e){return function(e){if(Array.isArray(e))return Ju(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function el(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tl(e,t,n){return t&&el(e.prototype,t),n&&el(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nl(e){return nl="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(e){return r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},nl(e)}function rl(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":nl(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function ol(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.P0="P0",e.P1="P1",e.P2="P2"}(Wu||(Wu={})),function(e){e.Start="Start",e.Success="Success",e.Failure="Failure"}(Ku||(Ku={})),function(e){e.Info="info",e.Log="log",e.Warn="warn",e.Error="error"}(Xu||(Xu={}));function il(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||$u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var al,cl=function(e){return function(t,n,r){var o=r.value;r.value=function(){try{for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return o.apply(this,r)}catch(t){return window[window.__sl_console__?"__sl_console__":"console"].error("logger: ".concat(n,""),t),e}}}},sl=function(e){return e.reduce((function(e,t){var n={};try{n=t()}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("",e)}return Object.assign(Object.assign({},e),n)}),{})},ul=function(e){var t=window.__SL_LOGGER__;if(t)return t[e]},ll=function(e,t){window.__SL_LOGGER__||(window.__SL_LOGGER__={}),window.__SL_LOGGER__[e]=t},dl=function(e){return"string"==typeof e?e:"Request"in window&&e instanceof Request?e.url:String(e)},fl=function(e){return e instanceof Request},pl=function(){var e,t=null,n={},r=arguments.length<=0?void 0:arguments[0];return e=dl(r),fl(r)&&(t=r),(arguments.length<=1?void 0:arguments[1])&&(n=arguments.length<=1?void 0:arguments[1]),[e,t,n]},hl=new Uint8Array(16);function yl(){if(!al&&!(al="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return al(hl)}for(var vl=[],ml=0;ml<256;++ml)vl.push((ml+256).toString(16).slice(1));var gl={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function bl(e,t,n){if(gl.randomUUID&&!t&&!e)return gl.randomUUID();var r=(e=e||{}).random||(e.rng||yl)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(vl[e[t+0]]+vl[e[t+1]]+vl[e[t+2]]+vl[e[t+3]]+"-"+vl[e[t+4]]+vl[e[t+5]]+"-"+vl[e[t+6]]+vl[e[t+7]]+"-"+vl[e[t+8]]+vl[e[t+9]]+"-"+vl[e[t+10]]+vl[e[t+11]]+vl[e[t+12]]+vl[e[t+13]]+vl[e[t+14]]+vl[e[t+15]]).toLowerCase()}(r)}var wl,_l=["localhost",/^\/(?!\/).*$/];!function(e){e.InstrumentFetch="instrumentFetch",e.InstrumentXHR="instrumentXHR"}(wl||(wl={}));var Ol=function(){function e(){Qu(this,e),this.fnList=[],this.get(),this.instrumentFetch(),this.instrumentXHR()}return tl(e,[{key:"get",value:function(){var e,t,n=sessionStorage.getItem("SL_LOGGER_SESSION_ID"),r=("log_session_id",e=document.cookie.split("; "),t={},e.forEach((function(e){var n=il(e.split("="),2),r=n[0],o=n[1];r&&(t[r]=o||"")})),t.log_session_id||"");if(n)return n!==r&&this.updateId(n),n;var o=bl();return this.updateId(o),o}},{key:"set",value:function(e){return!!e&&(this.updateId(e),this.fnList.forEach((function(t){return t(e)})),!0)}},{key:"refresh",value:function(){var e=bl();return this.updateId(e),this.fnList.forEach((function(t){return t(e)})),!0}},{key:"onChange",value:function(e){this.fnList.push(e)}},{key:"updateId",value:function(e){sessionStorage.setItem("SL_LOGGER_SESSION_ID",e),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r="".concat(e,"=").concat(t);n&&(r+="; path=".concat(n)),document.cookie=r}("log_session_id",e)}},{key:"instrumentFetch",value:function(){if(window.fetch&&"function"==typeof window.fetch&&!0!==ul(wl.InstrumentFetch)){ll(wl.InstrumentFetch,!0);var e=this,t=window.fetch;window.fetch=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];try{var i=il(pl.apply(void 0,r),3),a=i[0],c=i[1],s=i[2],u=e.get();if(e.needAddHeader(a)){var l=s.headers;c&&(l=c.headers),l?"function"==typeof l.append?l.append("Log-Session-Id",u):l=Array.isArray(l)?[].concat(Zu(l),[["Log-Session-Id",u]]):Object.assign(Object.assign({},l),ol({},"Log-Session-Id",u)):l=ol({},"Log-Session-Id",u),s.headers=l}}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("instrumentFetch error",e)}return t.apply(window,r)}}}},{key:"instrumentXHR",value:function(){if(window.XMLHttpRequest&&"function"==typeof window.XMLHttpRequest&&!0!==ul(wl.InstrumentXHR)){ll(wl.InstrumentXHR,!0);var e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];try{var o=n[1],i="string"==typeof o?o:o.toString();this.__logger_xhr_info__={url:i}}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("instrumentXHR open error",e)}return e.apply(this,n)};var t=this,n=window.XMLHttpRequest.prototype.send;window.XMLHttpRequest.prototype.send=function(){var e;try{var r=t.get();t.needAddHeader((null===(e=this.__logger_xhr_info__)||void 0===e?void 0:e.url)||"")&&this.setRequestHeader("Log-Session-Id",r)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("instrumentXHR send error",e)}for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.apply(this,i)}}}},{key:"needAddHeader",value:function(e){return _l.some((function(t){return t instanceof RegExp?t.test(e):"string"==typeof t&&-1!==e.indexOf(t)}))}}]),e}();rl([cl("")],Ol.prototype,"get",null),rl([cl(!1)],Ol.prototype,"set",null),rl([cl(!1)],Ol.prototype,"refresh",null),rl([cl()],Ol.prototype,"onChange",null),rl([cl()],Ol.prototype,"updateId",null);var Cl=new Ol,kl=function(){function e(){Qu(this,e),this.fnList=[],this.get()}return tl(e,[{key:"get",value:function(){var e=localStorage.getItem("SL_LOGGER_CLIENT_ID");if(e)return e;var t=bl();return this.set(t),t}},{key:"set",value:function(e){return!!e&&(localStorage.setItem("SL_LOGGER_CLIENT_ID",e),this.fnList.forEach((function(t){return t(e)})),!0)}},{key:"refresh",value:function(){var e=bl();return this.set(e),!0}},{key:"onChange",value:function(e){this.fnList.push(e)}}]),e}();rl([cl("")],kl.prototype,"get",null),rl([cl(!1)],kl.prototype,"set",null),rl([cl(!1)],kl.prototype,"refresh",null),rl([cl()],kl.prototype,"onChange",null);var Sl=new kl,El=function(){function e(t){Qu(this,e),this.options={owner:"",action:"",tags:{},getTagsFn:[],data:{},getDataFn:[],transports:[]},this.options=Object.assign(Object.assign({},this.options),t)}return tl(e,[{key:"withOwner",value:function(e){return new this.constructor(Object.assign(Object.assign({},this.options),{owner:e}))}},{key:"pipeOwner",value:function(e){if(!e)return this;var t;return t=this.options.owner?"".concat(this.options.owner,".").concat(e):e,new this.constructor(Object.assign(Object.assign({},this.options),{owner:t}))}},{key:"withAction",value:function(e){return new this.constructor(Object.assign(Object.assign({},this.options),{action:e}))}},{key:"pipeTags",value:function(e){return e?"function"==typeof e?new this.constructor(Object.assign(Object.assign({},this.options),{getTagsFn:[].concat(Zu(this.options.getTagsFn),[e])})):new this.constructor(Object.assign(Object.assign({},this.options),{tags:Object.assign(Object.assign({},this.options.tags),e)})):this}},{key:"pipeData",value:function(e){return e?"function"==typeof e?new this.constructor(Object.assign(Object.assign({},this.options),{getDataFn:[].concat(Zu(this.options.getDataFn),[e])})):new this.constructor(Object.assign(Object.assign({},this.options),{data:Object.assign(Object.assign({},this.options.data),e)})):this}},{key:"pipeTransport",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this.options.transports.concat(t);return new this.constructor(Object.assign(Object.assign({},this.options),{transports:r}))}},{key:"report",value:function(e,t,n){var r=function(e){var t,n=e.level,r=e.message,o=e.context,i=e.options,a=sl(i.getTagsFn),c=sl(i.getDataFn),s=Object.assign(Object.assign({level:n,owner:i.owner,action:i.action},o),{tags:Object.assign(Object.assign({},i.tags),a),data:Object.assign(Object.assign({},i.data),c),message:r});return(null==o?void 0:o.data)&&(t=o.data,"[object Object]"===Object.prototype.toString.call(t))?s.data=Object.assign(Object.assign({},s.data),o.data):void 0!==(null==o?void 0:o.data)&&(s.data=Object.assign(Object.assign({},s.data),{custom_data:o.data})),o&&"tags"in o&&o.tags&&(s.tags=Object.assign(Object.assign({},s.tags),o.tags)),o&&"errorLevel"in o&&o.errorLevel&&(s.tags=Object.assign(Object.assign({},s.tags),{errorLevel:o.errorLevel})),s}({level:e,message:t,context:n,options:this.options});!function(e,t){var n=e;t.forEach((function(e){var t=e(n);t&&(n=t)}))}(r,this.options.transports)}},{key:"info",value:function(e,t){this.report(Xu.Info,e,t)}},{key:"log",value:function(e,t){this.report(Xu.Log,e,t)}},{key:"warn",value:function(e,t){this.report(Xu.Warn,e,t)}},{key:"error",value:function(e,t){this.report(Xu.Error,e,t)}}]),e}();rl([cl(new El)],El.prototype,"withOwner",null),rl([cl(new El)],El.prototype,"pipeOwner",null),rl([cl(new El)],El.prototype,"withAction",null),rl([cl(new El)],El.prototype,"pipeTags",null),rl([cl(new El)],El.prototype,"pipeData",null),rl([cl(new El)],El.prototype,"pipeTransport",null),rl([cl(new El)],El.prototype,"info",null),rl([cl(new El)],El.prototype,"log",null),rl([cl(new El)],El.prototype,"warn",null),rl([cl(new El)],El.prototype,"error",null);var Pl=new El;function Il(e){return" ","",(e||"@sl/logger").replace(new RegExp(" ","g"),"")}Object.defineProperty(Pl,"options",{writable:!1,configurable:!1});var xl,Tl,jl=Pl.pipeTransport((function(e){var t,n,r,o,i=e.level,a=e.message,c=e.tags,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["level","message","tags"]),u=Object.assign(Object.assign({},s),{message:a,tags:Object.assign(Object.assign({},c),{sessionId:Cl.get(),clientId:Sl.get()})});switch(i){case Xu.Info:case Xu.Log:case Xu.Warn:null===(n=null===(t=window.__SL_Track__)||void 0===t?void 0:t.info)||void 0===n||n.call(t,Il(s.owner),u);break;case Xu.Error:null===(o=null===(r=window.__SL_Track__)||void 0===r?void 0:r.error)||void 0===o||o.call(r,Il(s.owner),u);break;default:window[window.__sl_console__?"__sl_console__":"console"].error("",i,a,s)}})).pipeOwner("button-kits"),Al=jl;!function(e){e.GET="GET",e.POST="POST"}(xl||(xl={})),function(e){e.FORM="form"}(Tl||(Tl={}));var Ll=function(){function e(){n(this,e),c(this,"handlers",[])}return a(e,[{key:"use",value:function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){this.handlers.forEach((function(t){null!==t&&e(t)}))}}]),e}(),Dl=Ll,Nl=function(e){return e&&Yu(e)?Object.entries(e).map((function(e){var t=qu(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(encodeURIComponent(r))})).join("&"):""};var Bl=function(e,t){return Yu(t)?function(e,t){if(!t)return e;var n=e.indexOf("#"),r=-1===n?"":e.substr(n);return e=-1===n?e:e.substr(0,n),Object.entries(t).forEach((function(t){var n=qu(t,2),r=n[0],o=n[1],i=new RegExp("([?&])".concat(r,"=.*?(&|$)"),"i"),a=-1!==e.indexOf("?")?"&":"?";null===o?("?"===(e=e.replace(new RegExp("([?&]?)".concat(r,"=[^&]*"),"i"),"")).slice(-1)&&(e=e.slice(0,-1)),-1===e.indexOf("?")&&(e=e.replace(/&/,"?"))):e=e.match(i)?e.replace(i,"$1".concat(r,"=").concat(o,"$2")):"".concat(e+a+r,"=").concat(o)})),e+r}(e,t):e};function Rl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ml(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rl(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fl={Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},Hl=function(){function e(t){n(this,e),c(this,"options",{}),c(this,"interceptors",{request:new Dl,response:new Dl}),this.options=t||{}}return a(e,[{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.requestType,o=Fl["Content-Type"],i=t||n.data||null;r===Tl.FORM?(o="application/x-www-form-urlencoded;charset=UTF-8",i=i?Nl(i):null):i=i?JSON.stringify(i):null;var a=Ml(Ml(Ml({},Fl),n.headers),{},{"Content-Type":o});return this.send(e,Ml(Ml({method:xl.POST,body:i},n),{},{headers:a}))}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Bl(e,t.params);var n=Ml(Ml({},Fl),t.headers);return this.send(e,Ml(Ml({},t),{},{method:xl.GET,headers:n}))}},{key:"send",value:function(e){var t,n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=[];null===(t=this.interceptors)||void 0===t||null===(n=t.request)||void 0===n||n.forEach((function(e){a.unshift(e.fulfilled,e.rejected)}));var c,s=[];null===(r=this.interceptors)||void 0===r||null===(o=r.response)||void 0===o||o.forEach((function(e){s.push(e.fulfilled,e.rejected)}));for(var u=i;a.length;){var l=a.shift(),d=a.shift();try{l&&(u=l(u))}catch(e){d&&d(e);break}}for(c=this.request(e,u);s.length;){var f=s.shift(),p=s.shift();c=c.then(f,p)}return c}},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this.options,t),r=n.method,o=n.baseUrl,i=n.headers,a=n.body,c=n.timeout;return new Promise((function(n,s){var u=new window.XMLHttpRequest,l=o&&!/^(https?:)?(\/\/)/.test(e)?[o,e].join(e.startsWith("/")?"":"/"):e;u.open(r||xl.GET,l),i&&Object.entries(i).forEach((function(e){var t=qu(e,2),n=t[0],r=t[1];return r&&u.setRequestHeader(n,r)}));var d={options:t,url:l};u.addEventListener("load",(function(){d.statusCode=u.status;var e=u.getResponseHeader("Content-Type"),t=u.responseText,r="";if(null!=e&&e.includes("application/json"))try{r=JSON.parse(t)}catch(e){r=t}else r=t;200==u.status?n(Ml({data:r},d)):s(Ml({data:r},d))})),u.addEventListener("abort",(function(e){d.statusCode=u.status,s(Ml({error:e},d))})),u.addEventListener("error",(function(e){d.statusCode=u.status,s(Ml({error:e},d))})),u.send(a),c&&setTimeout((function(){u.abort();var e=new Error("XMLHttpRequest timeout");d.statusCode=u.status,s(Ml({error:e},d))}),c)}))}}]),e}();function Ul(e){return function(e){if(Array.isArray(e))return Hu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Uu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ql=new Map([["for","htmlFor"],["class","className"],["readonly","readOnly"],["maxlength","maxLength"],["cellspacing","cellSpacing"],["rowspan","rowSpan"],["colspan","colSpan"],["tabindex","tabIndex"],["usemap","useMap"],["frameborder","frameBorder"]]);function Yl(e){return e.nodeType===Node.ELEMENT_NODE}function Gl(e){return e.nodeType===Node.TEXT_NODE}function Vl(e){return e.nodeType===Node.COMMENT_NODE}function zl(e){return"INPUT"===e.nodeName}var Wl,Kl=function(){function e(t){n(this,e),this.elems=t}return a(e,[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.elems[e]}},{key:"size",value:function(){var e;return(null===(e=this.elems)||void 0===e?void 0:e.length)||0}},{key:"isEmpty",value:function(){return 0===this.elems.length}},{key:"each",value:function(e){return this.elems.forEach(e),this}},{key:"html",value:function(e){var t=this.elems;return void 0===e?t[0]&&Yl(t[0])?t[0].innerHTML:null:(t.filter(Yl).forEach((function(t){return t.innerHTML=e})),this)}},{key:"attr",value:function(e,t){var n=this.elems,r=ql.has(e)?ql.get(e):e;if(void 0===t){var o=n[0];return!o||Gl(o)||Vl(o)?void 0:o[r]||o.getAttribute(r)}return n.filter((function(e){return!Gl(e)&&!Vl(e)})).forEach((function(e){return e.setAttribute(r,t)})),this}},{key:"val",value:function(e){var t=this.elems;return void 0===e?t[0]&&zl(t[0])?t[0].value:null:(t.filter(zl).forEach((function(t){return t.value=e})),this)}},{key:"append",value:function(e){var t=this.elems;if(1===t.length){var n=t[0];e.each((function(e){return n.appendChild(e)}))}else t.length>1&&t.forEach((function(t){e.each((function(e){var n=document.createElement("div");n.appendChild(e),n.innerHTML=n.innerHTML,n.firstChild&&t.appendChild(n.firstChild)}))}));return this}},{key:"remove",value:function(){return this.elems.forEach((function(e){var t;null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),this}},{key:"parents",value:function(t){var n=this.get(),r=[];if(n){for(var o=n;o&&o!==document.body;){var i;if(o.parentElement&&(o=o.parentElement),t){if(null!==(i=o)&&void 0!==i&&i.matches(t)){r=[o];break}}else o&&r.push(o)}return new e(r)}return new e([])}}]),e}();function Xl(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=document.createElement(e);return n.length&&(t=o.classList).add.apply(t,Ul(n)),r&&(o.innerHTML=r),o}var Jl="shopline-payment-button--service-unavailable-countdown",$l="unavailable_ts_",Zl=(c(Wl={},Ve.NetworkUnstable,{text:"sdk.button.unavailable.network_unstable",seconds:!1}),c(Wl,Ve.RateLimited,{text:"sdk.button.unavailable.wait_and_retry",seconds:!0}),Wl),Ql="pay-button-common-unavailable-style-id",ed=function(){var e,t;if(!document.getElementById(Ql)){var n=document.createElement("style");n.setAttribute("id",Ql);var r=null!==(e=null===(t=window.Shopline.theme)||void 0===t?void 0:t.btn_border_radius)&&void 0!==e?e:4;n.innerHTML="\n    .".concat(Jl," {\n      border: 1px solid #EEB96B;\n      padding: 8px 12px;\n      display: flex;\n      align-items: flex-start; \n      background: #FFF8E5;\n      border-radius: ").concat(r,"px;\n      margin-bottom: 5px;\n    }\n    .").concat(Jl," .icon {\n      flex: 0 0 auto; \n      width: 18px;\n      color: #F79E1B;\n      height: 18px;\n      display: flex;\n      align-items: flex-start;\n      justify-content: flex-start;\n    }\n    .").concat(Jl," .content {\n      margin-left: 8px;\n      word-break: break-word;\n      text-align: left;\n    }\n  "),document.body.appendChild(n)}};function td(e){return Au.includes(e)}var nd,rd=function(){function e(t){n(this,e),c(this,"intervalId",null),c(this,"message",{element:null}),this.instance=t}return a(e,[{key:"calculateRandomDelay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=Math.max(1,e-t),r=e+t;return Math.floor(Math.random()*(r-n+1))+n}},{key:"recordTimestamp",value:function(e,t){if(e)try{var n={startTs:Date.now(),duration:t};localStorage.setItem("".concat($l).concat(e),JSON.stringify(n))}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("Failed to record countdown data to localStorage:",e)}}},{key:"readStoredData",value:function(e){if(!e)return null;try{var t=localStorage.getItem("".concat($l).concat(e));if(t){var n=JSON.parse(t);if("number"==typeof n.startTs&&"number"==typeof n.duration)return n}}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("Failed to read or parse countdown data from localStorage:",e)}return null}},{key:"clearStoredData",value:function(e){if(e)try{localStorage.removeItem("".concat($l).concat(e))}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error("Failed to clear countdown data from localStorage:",e)}}},{key:"clearCurrentCountdownState",value:function(){if(this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.message.element){this.message.element.remove();var e=this.instance.getContainer();this.containerRemoveCountdownMessage(e),this.message={element:null,type:void 0}}}},{key:"updateCountdownMessage",value:function(e){var t=this.instance.getPayButton(),n=null==t?void 0:t.getI18nTranslator();if(this.message.element&&this.message.type&&td(this.message.type)&&n){var r=Math.max(1,Math.ceil(e)),o=Zl[this.message.type],i=o.seconds?n(o.text,{seconds:r}):n(o.text);this.message.element.textContent=i}}},{key:"containerRemoveCountdownMessage",value:function(e){Array.from(e.getElementsByClassName(Jl)).forEach((function(e){return e.remove()}))}},{key:"renderCountdownMessage",value:function(e,t){this.containerRemoveCountdownMessage(e);var n=Xl("div",[Jl,Ha.COMMON_ITEM_LAYOUT,"body5","text-center","notranslate"]),r=Xl("span",["icon"],'\n<svg viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n<path d="M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8 2.40039C4.90721 2.40039 2.40039 4.90721 2.40039 8C2.40039 11.0928 4.90721 13.5996 8 13.5996C11.0928 13.5996 13.5996 11.0928 13.5996 8C13.5996 4.90721 11.0928 2.40039 8 2.40039ZM8 10.6504C8.47971 10.6506 8.89546 11.0529 8.89941 11.5459C8.89566 12.0466 8.47983 12.45 8 12.4502C7.50518 12.45 7.09586 12.0466 7.09961 11.5459C7.09606 11.0529 7.5053 10.6506 8 10.6504ZM8 4C8.44176 4 8.7997 4.35807 8.7998 4.7998V9C8.7998 9.44183 8.44183 9.7998 8 9.7998C7.55835 9.79959 7.2002 9.4417 7.2002 9V4.7998C7.2003 4.3582 7.55842 4.00021 8 4Z" />\n</svg>\n'),o=Xl("div",["content"]);return n.append(r,o),e.insertBefore(n,e.firstChild),this.message.element=o,this.updateCountdownMessage(t),n}},{key:"setPayButtonDisabled",value:function(e){var t=this.instance.getPayButton();[Fa.BUY_NOW,Fa.MORE_OPTIONS].forEach((function(n){var r=null==t?void 0:t.getButtonElement(n);r&&r.forEach((function(t){t.classList.toggle("unavailable--disabled",e),e?t.setAttribute("disabled",String(e)):t.removeAttribute("disabled")}))})),null==t||t.setDisabled(e)}},{key:"startCountdownInterval",value:function(e,t){var n=this;this.setPayButtonDisabled(!0),this.updateCountdownMessage(e),this.intervalId=setInterval((function(){e--,n.updateCountdownMessage(e),e<=0&&(n.clearCurrentCountdownState(),n.clearStoredData(t),n.setPayButtonDisabled(!1))}),1e3),this.message.element&&this.message.type===Ve.RateLimited&&(this.message.element.dataset.intervalId=String(this.intervalId))}},{key:"restore",value:function(e){this.clearCurrentCountdownState();var t=this.readStoredData(e||"");if(t){var n=(Date.now()-t.startTs)/1e3,r=t.duration-n;if(r>0){var o=this.instance.getContainer();return this.renderCountdownMessage(o,r),this.startCountdownInterval(r,e),!0}this.clearStoredData(e)}return!1}},{key:"start",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o=this.instance.getContainer();if(ed(),t===Ve.NetworkUnstable)return this.message.type=t,void this.renderCountdownMessage(o,0);this.clearCurrentCountdownState();var i=this.calculateRandomDelay(n,r);this.message.type=t,this.recordTimestamp(e,i),this.renderCountdownMessage(o,i),this.startCountdownInterval(i,e)}}]),e}(),od=Al.pipeOwner("button-common.toast"),id={open:(nd=t(p.mark((function e(t){var n,r,o,i,a,c;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null===(n=window.Shopline)||void 0===n||null===(r=n.utils)||void 0===r||null===(o=r.toast)||void 0===o?void 0:o.open,Boolean(s)&&"function"==typeof s){e.next=3;break}return e.next=3,new Promise((function(e,t){window.Shopline.loadFeatures([{name:"component-toast",version:"0.1"}],(function(n){n&&t(n),e("")}))})).catch((function(e){od.error("toast",{error:e})}));case 3:null===(i=window.Shopline)||void 0===i||null===(a=i.utils)||void 0===a||null===(c=a.toast)||void 0===c||c.open({content:t});case 4:case"end":return e.stop()}var s}),e)}))),function(e){return nd.apply(this,arguments)})},ad=function(){function e(t){var r=t.formElement;n(this,e),this.formElement=r}return a(e,[{key:"observerFormChange",value:function(e){var t,n=this;null===(t=this.formElement)||void 0===t||t.addEventListener("change",(function(){e(n.formElement)}))}},{key:"getFormValue",value:function(e){var t=new FormData(this.formElement);return null!=e&&e.length?e.reduce((function(e,n){return e[n]=t.get(n),e}),{}):Object.fromEntries(t.entries())}}]),e}(),cd={getPayButtonStyle:function(e){var t=document.createElement("div");t.style.opacity="0",t.innerHTML='\n    <button type="button" class="button button--secondary">\n      <span>fake button</span>\n    </button>\n  ',e.append(t);var n=t.offsetHeight,r=0,o=t.children[0];return o&&(r=parseInt(window.getComputedStyle(o).getPropertyValue("border-radius"))),t.remove(),{height:n,borderRadius:r}},getContainerId:function(e,t){var n;if(e.id)return e.id;var r=(c(n={},Ra.ProductDetail,"payment_button_".concat(Gu())),c(n,Ra.Cart,"additional_button_".concat(Gu())),c(n,Ra.Checkout,"alternative_button_".concat(Gu())),n)[t];return e.id=r,r},getPaymentConfig:function(e){var t,n=function(e){var t,n,r;return e?$a($a({},e),{},{buttonLocationDataList:null!==(t=null===(n=e.buttonLocationDataList)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(function(e){var t,n,r;return $a($a({},e),{},{buttonTypeDataList:null!==(t=null===(n=e.buttonTypeDataList)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(function(e){var t,n,r;return $a($a({},e),{},{buttonNameDataList:null!==(t=null===(n=e.buttonNameDataList)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(function(e){return $a({},e)})))&&void 0!==t?t:[]})})))&&void 0!==t?t:[]})})))&&void 0!==t?t:[]}):null}(window.__paymentButtonConfig__);if(!n||!n.buttonLocationDataList)return null;var r=null===(t=n.buttonLocationDataList)||void 0===t?void 0:t.find((function(t){return t.buttonLocation===e}));if(!r)return null;var o=zu(zu({},r),{},{buttonTraceId:n.buttonTraceId});return e===Ra.Cart&&(o.buttonTypeDataList=o.buttonTypeDataList.filter((function(e){return e.buttonType!==Ma.Normal}))),o},getPaymentProps:function(){var e=window.__paymentButtonConfig__;return{expressOptimizationSwitch:(null==e?void 0:e.expressOptimizationSwitch)||!1,buttonTimeoutConfig:(null==e?void 0:e.buttonTimeoutConfig)||{enable:!0}}}},sd={logger:Al,Request:Hl,$:function(e){if("string"==typeof e){var t=document.querySelectorAll(e);return new Kl(Ul(t))}return new Kl([e])},toast:id,utils:{isValidateJson:function(e){try{JSON.parse(e)}catch(e){return!1}return!0}}},ud=function(){window.magpieBridge||(window.magpieBridge={})},ld=function(){function e(){n(this,e),this._events={},this._caches={}}return a(e,[{key:"addEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._events[e]||(this._events[e]=[]),t.once=n,this._events[e].push(t)}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this._events[e];this._caches[e]||(this._caches[e]=[]),this._caches[e].push(n),Array.isArray(o)&&(this._events[e]=o.filter((function(e){try{e.apply(void 0,n)}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error(e)}return!e.once})))}},{key:"on",value:function(e,t){this._caches[e]&&this._caches[e].forEach((function(e){try{t.apply(void 0,Ul(e))}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error(e)}})),this.addEventListener(e,t)}},{key:"once",value:function(e,t){if(this._caches[e]){var n=this._caches[e][0];try{t.apply(void 0,Ul(n))}catch(e){window[window.__sl_console__?"__sl_console__":"console"].error(e)}}else this.addEventListener(e,t,!0)}},{key:"off",value:function(e,t){this._events[e]=this._events[e].filter((function(e){return t!==e}))}}]),e}(),dd=function(){var e,t;ud(),null!==(e=window)&&void 0!==e&&null!==(t=e.magpieBridge)&&void 0!==t&&t.event||(window.magpieBridge.event=new ld)};ud();var fd,pd=window.magpieBridge,hd=sd.$,yd=function(){var e;return"PreviewProductsDetail"===(null===(e=window.Shopline.uri)||void 0===e?void 0:e.alias)},vd=function(e,t){var n,r,o,i=hd(t).attr("data-purchase-sdk-id");if(i)return null===(n=window.productPurchaseSDK)||void 0===n||null===(r=n.channel)||void 0===r||null===(o=r[e])||void 0===o?void 0:o[i]},md=".shopline-payment-button-wrapper",gd=42;function bd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bd(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.GetCheckoutDataMap="getCheckoutDataMap",e.OnCheckoutSuccessMap="onCheckoutSuccessMap"}(fd||(fd={}));var _d,Od,Cd=sd.$,kd=sd.logger,Sd=sd.toast,Ed=sd.utils.isValidateJson,Pd=kd.pipeOwner("payment-button"),Id=function(){function e(r){var o=this;n(this,e),c(this,"product",null),c(this,"formEvent",null),c(this,"payButton",null),c(this,"countdownManager",null),c(this,"render",t(p.mark((function e(){return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderButton();case 2:o.observerAddToCart(),o.observerProducts(),o.observerSubscription(),o.initializeAndRestoreCountdown();case 6:case"end":return e.stop()}}),e)})))),c(this,"initializeAndRestoreCountdown",(function(){o.countdownManager||(o.countdownManager=new rd(o));var e=o.getProductSeq();e&&o.countdownManager.restore(e)})),c(this,"renderButton",t(p.mark((function e(){var t,n,r,i,a,s,u,l,d,f;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.getAddToCartElem(),r=null==n?void 0:n.disabled,!o.payButton&&!r){e.next=4;break}return e.abrupt("return");case 4:if(Pd.info("render button"),i=o.container,a=cd.getContainerId(i,Ra.ProductDetail),s=cd.getPayButtonStyle(i),u=s.height,l=s.borderRadius,d=cd.getPaymentConfig(Ra.ProductDetail)){e.next=12;break}return Pd.error("first load paymentButtonConfig data is null"),e.abrupt("return");case 12:return f={domId:a,props:wd(wd({},cd.getPaymentProps()),{},{style:{height:u||gd,"border-radius":l},logger:kd,toast:function(e){return Sd.open(e)},isSubscription:!1,isPreview:yd()}),paymentConfig:d,saveAbandonedOrder:o.saveAbandonedOrder.bind(o),onError:function(e,t){null!=t&&t.errorType&&o.countdownManagerStart(null==t?void 0:t.errorType)}},o.payButton=new Cu(f),e.next=16,o.payButton.render();case 16:o.payButton.customButtons((c(t={},Fa.BUY_NOW,{className:"button"}),c(t,Fa.MORE_OPTIONS,{className:"body3 fw-bold ".concat(qa)}),t));case 17:case"end":return e.stop()}}),e)})))),c(this,"observerAddToCart",(function(){Pd.info("observer add to cart button");var e=o.getAddToCartElem();if(e){var t=function(){var t,n,r=null==e?void 0:e.disabled;(Pd.info("check add to cart button disabled",{data:{disabled:r}}),r)?null===(n=o.payButton)||void 0===n||n.setVisible(!1):o.payButton?null===(t=o.payButton)||void 0===t||t.setVisible(!0):o.renderButton()};new MutationObserver((function(){t()})).observe(e,{childList:!1,attributes:!0,subtree:!1}),t()}else Pd.warn(" add to cart ")})),c(this,"observerProducts",(function(){Pd.info("observer products form");var e=Cd(o.container).parents("form").get();if(e){var t=new ad({formElement:e});o.formEvent=t;var n=t.getFormValue(),r=n.id,i=n.productSeq,a=n.quantity;o.updateProduct({productSku:r,productSeq:i,productNum:a}),t.observerFormChange((function(e){var t,n,r,i={productSku:null===(t=e.id)||void 0===t?void 0:t.value,productSeq:null===(n=e.productSeq)||void 0===n?void 0:n.value,productNum:null===(r=e.quantity)||void 0===r?void 0:r.value};Pd.info("product form change",{data:{product:i}}),o.updateProduct(i)}))}})),c(this,"observerSubscription",(function(){var e;Pd.info("observer subscription"),dd(),null===(e=pd.event)||void 0===e||e.on("Payment::Update",function(){var e=t(p.mark((function e(t){var n,r;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.isSubscription,Pd.info("subscription state change",{data:{isSubscription:r}}),null===(n=o.payButton)||void 0===n||n.setSubscription(r);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),c(this,"getAddToCartElem",(function(){return Cd(o.container).parents("form").get().querySelector('button[type="submit"]')})),c(this,"getProducts",t(p.mark((function e(){var t,n,r,i,a,c,s,u;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=vd(fd.GetCheckoutDataMap,o.container))){e.next=16;break}return e.next=4,i();case 4:if(e.t1=a=e.sent,e.t0=null===e.t1,e.t0){e.next=8;break}e.t0=void 0===a;case 8:if(!e.t0){e.next=12;break}e.t2=void 0,e.next=13;break;case 12:e.t2=a.products;case 13:return c=e.t2,Pd.info("get products from PurchaseSDK",{data:{products:c}}),e.abrupt("return",c);case 16:return s=null===(t=o.formEvent)||void 0===t?void 0:t.getFormValue(),u=s.quantity,e.abrupt("return",[{productSeq:(null===(n=o.product)||void 0===n?void 0:n.productSeq)||"",productSku:(null===(r=o.product)||void 0===r?void 0:r.productSku)||"",productNum:u||1}]);case 18:case"end":return e.stop()}}),e)})))),c(this,"updateProduct",(function(e){var t,n,r;(Pd.info("Product information update",{data:{product:e}}),o.product={productNum:e.productNum||1,productSeq:e.productSeq||"",productSku:e.productSku||""},e.productSku)?(null===(t=o.payButton)||void 0===t||t.setDisabled(!1),null===(n=o.countdownManager)||void 0===n||n.restore(e.productSeq||"")):null===(r=o.payButton)||void 0===r||r.setDisabled(!0)})),this.container=r}var r;return a(e,[{key:"getContainer",value:function(){return this.container}},{key:"getPayButton",value:function(){return this.payButton}},{key:"getProductSeq",value:function(){var e,t;return(null===(e=this.product)||void 0===e?void 0:e.productSeq)||(null===(t=this.product)||void 0===t?void 0:t.productSku)||""}},{key:"countdownManagerStart",value:function(e){td(e)&&(this.countdownManager||(this.countdownManager=new rd(this)),this.countdownManager.start(this.getProductSeq(),e))}},{key:"saveAbandonedOrder",value:(r=t(p.mark((function e(t){var n,r,o,i,a,c,s,u,l,d,f,h;return p.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProducts();case 2:return n=e.sent,r={},o={},t===Fa.PAY_PAL&&(o.spb=!0),t===Fa.SHOP_BY_FAST_CHECKOUT&&(r.notSupportSubscriptionCheck=!0),i=[],(a=sessionStorage.getItem("tradeExtraInfo"))&&(c=Ed(a)?JSON.parse(a):{},(s=c&&c.discountCode&&c.discountCode.value)&&i.push(s)),Pd.info("save abandon order",{data:{products:n,query:o,discountCodes:i,restParams:r,buttonName:t}}),e.next=13,Mu(wd({products:n,query:o,discountCodes:i,toast:function(e){return Sd.open(e)},logger:Pd},r));case 13:if(u=e.sent,l=u.errorType,d=u.needLogin,f=u.abandonedInfo,h=u.url,!l){e.next=23;break}return Pd.info("save abandonOrder error",{data:{errorType:l}}),this.countdownManagerStart(l),l===ju.SAVE_ORDER&&this.handleAfterSaveAbandonedOrder({status:!1,buttonName:t}),e.abrupt("return",{canContinue:!1});case 23:if(this.handleAfterSaveAbandonedOrder({status:!0,buttonName:t}),[Fa.BUY_NOW,Fa.MORE_OPTIONS,Fa.PAY_PAL].includes(t)&&Fu({abandonedSeq:(null==f?void 0:f.seq)||""}),!d){e.next=29;break}return Pd.info("save abandonOrder need login"),setTimeout((function(){h&&(window.location.href=h)}),0),e.abrupt("return",{canContinue:!1});case 29:return e.abrupt("return",{canContinue:!0,abandonedInfo:f,url:h});case 30:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"handleAfterSaveAbandonedOrder",value:function(e){try{var t=vd(fd.OnCheckoutSuccessMap,this.container);t&&t(e),e.status&&dc.reportFastCheckout(e.buttonName)}catch(e){Pd.error("report after save abandoned order error",{error:e})}}}]),e}(),xd=sd.$,Td=sd.logger.pipeOwner("payment-button");Td.info("payment-button js entry");var jd=function(){Td.info("payment-button render");var e=xd(md);e.size()?e.each((function(e){new Id(e).render()})):Td.warn("can not find pay button container")};if(jd(),window.Shopline.PaymentButton={init:jd},null===(_d=window)||void 0===_d||null===(Od=_d.Shopline)||void 0===Od?void 0:Od.designMode){Td.info("It is design mode");var Ad=document.body;new MutationObserver((function(){Td.info("dom change");var e=xd(md);e.size()?e.each((function(e){"true"!==e.dataset.rendered&&(Td.info("rendering pay button"),new Id(e).render())})):Td.warn("can not find pay button container")})).observe(Ad,{childList:!0,attributes:!1,subtree:!0})}}));
